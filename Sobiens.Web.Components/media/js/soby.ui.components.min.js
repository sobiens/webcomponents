var __extends=this&&this.__extends||function(){var s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)};return function(e,t){function i(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.setPrototypeOf||(Object.prototype.setPrototypeOf=function(t,e){if(t.__proto__)return t.__proto__=e,t;function i(){for(var e in t)Object.defineProperty(this,e,{value:t[e]})}return i.prototype=e,new i});var sobyLastReturnData=null,SobyPaginationViewTypes,SobyPaginationVerticalAlign;function ajaxHelper(e,t,i,s,a,o){return $.ajax({type:t,url:e,dataType:"json",contentType:"application/json",data:i?JSON.stringify(i):null}).fail(function(e,t,i){o(e,t,i,s)}).done(function(e){a(e,s)})}!function(e){e[e.PageNumbers=0]="PageNumbers",e[e.BasicButtons=1]="BasicButtons",e[e.BasicButtons_PageNumbers=2]="BasicButtons_PageNumbers",e[e.AdvancedButtons=3]="AdvancedButtons",e[e.AdvancedButtons_PageNumbers=4]="AdvancedButtons_PageNumbers",e[e.QuickButtons_PageNumbers=5]="QuickButtons_PageNumbers"}(SobyPaginationViewTypes=SobyPaginationViewTypes||{}),function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right"}(SobyPaginationVerticalAlign=SobyPaginationVerticalAlign||{});var soby_Transport=function(){},soby_TransportRequest=function(e,t,i,s,a){this.Url=e,this.DataType=t,this.ContentType=i,this.Type=s,this.IncludeCredentials=null!==a&&a},soby_FilterValueSeperator="_SDX_",SobyFieldTypesObject=function(){this.Text=0,this.Number=1,this.MultiChoice=2,this.Lookup=3,this.Boolean=4,this.Choice=5,this.ModStat=6,this.User=7,this.TaxonomyFieldType=8,this.DateTime=9,this.Integer=10,this.CurrentUserGroups=11,this.DateTimeNowDifferenceAsMinute=12,this.DateTimeRange=13,this.Object=14},SobyFilterTypesObject=function(){this.Equal=0,this.NotEqual=1,this.Contains=2,this.In=3,this.Greater=4,this.Lower=5,this.GreaterEqual=6,this.LowerEqual=7,this.BeginsWith=8,this.Membership=9,this.IsNull=10,this.IsNotNull=11},SobyAggregateTypesObject=function(){function e(){this.Average=0,this.Count=1,this.Max=2,this.Min=3,this.Sum=4}return e.prototype.GetAggregateTypeName=function(e){return 0===e?"Average":1===e?"Count":2===e?"Max":3===e?"Min":4===e?"Sum":void 0},e}(),SobyWebServiceDataTypesObject=function(){this.QueryString=0,this.Json=1,this.Soap=2},SobyWebServiceDataTypes=new SobyWebServiceDataTypesObject,SobyFieldTypes=new SobyFieldTypesObject,SobyFilterTypes=new SobyFilterTypesObject,SobyAggregateTypes=new SobyAggregateTypesObject,SobyFilters=function(){function s(e){this.ShouldBeClearedOnUIFilterAction=!1,this.Filters=new Array,this.IsOr=e}return s.prototype.GetFiltersByFieldName=function(e){for(var t=new Array,i=0;i<this.Filters.length;i++)this.Filters[i].FieldName===e&&t.push(this.Filters[i]);return t},s.prototype.Clear=function(){this.Filters=new Array},s.prototype.AddFilter=function(e,t,i,s,a,o){a=new SobyFilter(e,t,i,s,a);a.ShouldBeClearedOnUIFilterAction=o,this.Filters.push(a)},s.prototype.AddFilterObject=function(e){this.Filters.push(e)},s.prototype.AddFilterCollection=function(e){this.Filters.push(e)},s.prototype.ToCaml=function(){for(var e="",t=!0===this.IsOr?"Or":"And",i=0;i<this.Filters.length;i++)1===this.Filters.length?e+=this.Filters[i].ToCaml():1===i?e+="<"+t+">"+this.Filters[i-1].ToCaml()+this.Filters[i].ToCaml()+"</"+t+">":i%2==1?e="<"+t+">"+e+"<"+t+">"+this.Filters[i-1].ToCaml()+this.Filters[i].ToCaml()+"</"+t+"></"+t+">":i===this.Filters.length-1&&(e="<"+t+">"+e+this.Filters[i].ToCaml()+"</"+t+">");return e},s.prototype.ToXml=function(){for(var e="",t=0;t<this.Filters.length;t++){var i=this.Filters[t];e+="<"+i.FieldName+">"+i.FilterValue+"</"+i.FieldName+">"}return e},s.prototype.ToJson=function(){for(var e="",t=0;t<this.Filters.length;t++){var i=this.Filters[t];e+='"'+i.FieldName+'": "'+i.FilterValue+'",'}return""!==e?e.substr(0,e.length-1):e},s.prototype.ToQueryString=function(e){if(0===this.Filters.length)return"";for(var t="(",i=0;i<this.Filters.length;i++)t+=this.Filters[i].ToQueryString(e),i<this.Filters.length-1&&(this.IsOr?t+=" or ":t+=" and ");return t+=")"},s.prototype.ToSearch2010Xml=function(){if(0===this.Filters.length)return"";for(var e="(",t=0;t<this.Filters.length;t++){var i=this.Filters[t];0<t&&(this.IsOr?e+=" OR ":e+=" AND "),e+=i.ToSearch2010Xml()}return e+=")"},s.prototype.Clone=function(){for(var e=new s(this.IsOr),t=0;t<this.Filters.length;t++){var i=this.Filters[t];i instanceof SobyFilter?e.AddFilter(i.FieldName,i.FilterValue,i.FieldType,i.FilterType,i.LookupID,i.ShouldBeClearedOnUIFilterAction):e.AddFilterCollection(i.Clone())}return e},s}(),SobyFilter=function(){function e(e,t,i,s,a){this.ShouldBeClearedOnUIFilterAction=!1,this.FieldName=e,this.FieldType=i,this.FilterType=s,this.FilterValue=t,this.LookupID=a}return e.prototype.ToCaml=function(){var e="",t="",i="";!0===this.LookupID&&(e='LookupId="True"');var s="";switch(this.FieldType){case SobyFieldTypes.Text:s="Text";break;case SobyFieldTypes.Number:s="Number";break;case SobyFieldTypes.DateTime:s="DateTime";break;case SobyFieldTypes.Integer:s="Integer";break;case SobyFieldTypes.MultiChoice:s="MultiChoice";break;case SobyFieldTypes.Choice:s="Choice";break;case SobyFieldTypes.Boolean:s="Boolean";break;case SobyFieldTypes.ModStat:s="ModStat";break;case SobyFieldTypes.Lookup:s="Lookup";break;case SobyFieldTypes.User:s="User";break;case SobyFieldTypes.CurrentUserGroups:s="CurrentUserGroups";break;case SobyFieldTypes.TaxonomyFieldType:s="TaxonomyFieldType"}switch(i="[*ME*]"===this.FilterValue?"<Value Type='"+s+"'><UserID /></Value>":this.FieldType===SobyFieldTypes.DateTime||this.FieldType===SobyFieldTypes.Number?"<Value Type='"+s+"'>"+this.FilterValue+"</Value>":"<Value Type='"+s+"'><![CDATA["+this.FilterValue+"]]></Value>",this.FilterType){case SobyFilterTypes.Equal:t="Eq";break;case SobyFilterTypes.NotEqual:t="Neq";break;case SobyFilterTypes.Greater:t="Gt";break;case SobyFilterTypes.Lower:t="Lt";break;case SobyFilterTypes.GreaterEqual:t="Geq";break;case SobyFilterTypes.LowerEqual:t="Leq";break;case SobyFilterTypes.Contains:t="Contains";break;case SobyFilterTypes.BeginsWith:t="BeginsWith";break;case SobyFilterTypes.IsNull:t="IsNull",i="";break;case SobyFilterTypes.IsNotNull:t="IsNotNull",i="";break;case SobyFilterTypes.Membership:t="Membership",i="";break;case SobyFilterTypes.In:for(var t="In",a=this.FilterValue.split(soby_FilterValueSeperator),i="<Values>",o=0;o<a.length;o++)i+="<Value Type='"+s+"'>",this.FieldType!==SobyFieldTypes.DateTime&&this.FieldType!==SobyFieldTypes.Number?i+="<![CDATA["+a[o]+"]]></Value>":i+=a[o]+"</Value>";i+="</Values>"}return"<"+t+(this.FilterType===SobyFilterTypes.Membership?" Type='"+s+"'":"")+"><FieldRef Name='"+this.FieldName+"' "+e+" />"+i+"</"+t+">"},e.prototype.ToSearch2010Xml=function(){var e="",t=this.FilterValue;switch(this.FilterType){case SobyFilterTypes.Equal:e="=";break;case SobyFilterTypes.NotEqual:e="!=";break;case SobyFilterTypes.Contains:e=":"}return this.FieldName+e+t},e.prototype.ToQueryString=function(e){var t="",i=this.FilterValue,s="";switch(this.FilterType){case SobyFilterTypes.Equal:s=this.FieldType===SobyFieldTypes.Text?this.FieldName+" eq '"+i+"'":this.FieldType===SobyFieldTypes.DateTime?this.FieldName+" eq datetime'"+i+"'":this.FieldName+" eq "+i;break;case SobyFilterTypes.NotEqual:var a=1===e?"ne":"neq",s=this.FieldType===SobyFieldTypes.Text?this.FieldName+" "+a+" '"+i+"'":this.FieldType===SobyFieldTypes.DateTime?this.FieldName+" "+a+" datetime'"+i+"'":this.FieldName+" "+a+" "+i;break;case SobyFilterTypes.Greater:s=this.FieldType===SobyFieldTypes.DateTime?this.FieldName+" gt datetime'"+i+"'":this.FieldName+" gt "+i;break;case SobyFilterTypes.Lower:s=this.FieldType===SobyFieldTypes.DateTime?this.FieldName+" lt datetime'"+i+"'":this.FieldName+" lt "+i;break;case SobyFilterTypes.GreaterEqual:s=this.FieldType===SobyFieldTypes.DateTime?this.FieldName+" geq datetime'"+i+"'":this.FieldName+" geq "+i;break;case SobyFilterTypes.LowerEqual:s=this.FieldType===SobyFieldTypes.DateTime?this.FieldName+" leq datetime'"+i+"'":this.FieldName+" leq "+i;break;case SobyFilterTypes.IsNull:s=this.FieldName+" eq null ";break;case SobyFilterTypes.IsNotNull:a=1===e?"ne":"neq";s=this.FieldName+" "+a+" null ";break;case SobyFilterTypes.Contains:s=0===e?"contains("+this.FieldName+", '"+i+"')":"substringof('"+i+"', "+this.FieldName+")";break;case SobyFilterTypes.BeginsWith:s=0===e?"beginswith":"startsWith"}return t+=s},e}(),SobySchemaFields=function(i){function s(e){var t=i.call(this)||this;return e&&t.push.apply(t,e),Object.setPrototypeOf(t,Object.create(s.prototype)),t}return __extends(s,i),s.prototype.toWebAPIString=function(){for(var e="",t="",i=0;i<this.length;i++)e+=","+this[i].FieldName,this[i].FieldType!==SobyFieldTypes.Lookup&&this[i].FieldType!==SobyFieldTypes.User&&this[i].FieldType!==SobyFieldTypes.Choice||(t+=","+this[i].Args.ModelName);return(t=""!==t?"$expand="+t.substr(1)+"&":t)+"$select="+e.substr(1)},s.prototype.GetByFieldName=function(e){for(var t=0;t<this.length;t++)if(this[t].FieldName===e)return this[t];return null},s}(Array),SobySchemaField=function(e,t,i){this.FieldName=e,this.FieldType=t,this.Args=i},SobyNavigationInformation=function(){this.PageIndex=0,this.ViewType=SobyPaginationViewTypes.BasicButtons,this.VerticalAlign=SobyPaginationVerticalAlign.Center},SobyOrderByFields=function(i){function s(e){var t=i.call(this)||this;return e&&t.push.apply(t,e),Object.setPrototypeOf(t,Object.create(s.prototype)),t}return __extends(s,i),s.prototype.GetOrderFieldByName=function(e){for(var t=0;t<this.length;t++)if(this[t].FieldName.toLowerCase()===e.toLowerCase())return this[t];return null},s.prototype.ContainsField=function(e){for(var t=0;t<this.length;t++)if(this[t].FieldName.toLowerCase()===e.toLowerCase())return!0;return!1},s.prototype.ContainsFieldAsAsc=function(e){for(var t=0;t<this.length;t++)if(this[t].FieldName.toLowerCase()===e.toLowerCase())return this[0].IsAsc;return!1},s.prototype.Clone=function(){for(var e=new s,t=0;t<this.length;t++){var i=this[t];e.push(new SobyOrderByField(i.FieldName,i.IsAsc))}return e},s}(Array),SobyOrderByField=function(e,t){this.IsAsc=!1,this.FieldName=e,this.IsAsc=t},SobyAggregateFields=function(i){function s(e){var t=i.call(this)||this;return e&&t.push.apply(t,e),Object.setPrototypeOf(t,Object.create(s.prototype)),t}return __extends(s,i),s.prototype.ContainsField=function(e){for(var t=0;t<this.length;t++)if(this[t].FieldName.toLowerCase()===e.toLowerCase())return!0;return!1},s}(Array),SobyKeyFields=function(i){function s(e){var t=i.call(this)||this;return e&&t.push.apply(t,e),Object.setPrototypeOf(t,Object.create(s.prototype)),t}return __extends(s,i),s.prototype.ContainsField=function(e){for(var t=0;t<this.length;t++)if(this[t].FieldName.toLowerCase()===e.toLowerCase())return!0;return!1},s}(Array),SobyKeyField=function(e,t){this.FieldName=e,this.ParameterName=t},SobyGroupByFields=function(i){function s(e){var t=i.call(this)||this;return e&&t.push.apply(t,e),Object.setPrototypeOf(t,Object.create(s.prototype)),t}return __extends(s,i),s.prototype.ContainsField=function(e){for(var t=0;t<this.length;t++)if(this[t].FieldName.toLowerCase()===e.toLowerCase())return!0;return!1},s}(Array),SobyAggregateField=function(e,t){this.AggregateType=0,this.FieldName=e,this.AggregateType=t},SobyGroupByField=function(e,t,i){this.IsAsc=!1,this.DisplayFunction=null,this.FieldName=e,this.IsAsc=t,this.DisplayFunction=i},SobyHeaders=function(i){function s(e){var t=i.call(this)||this;return e&&t.push.apply(t,e),Object.setPrototypeOf(t,Object.create(s.prototype)),t}return __extends(s,i),s}(Array),SobyHeader=function(e,t){this.Key=e,this.Value=t},SobyArguments=function(i){function s(e){var t=i.call(this)||this;return e&&t.push.apply(t,e),Object.setPrototypeOf(t,Object.create(s.prototype)),t}return __extends(s,i),s.prototype.ToJson=function(){return""},s.prototype.ToQueryString=function(){return""},s.prototype.Clone=function(){return null},s}(Array),SobyArgument=function(){},soby_DataSourceBuilderAbstract=function(){function e(){this.PageIndex=0,this.NextPageExist=!1,this.Filters=new SobyFilters(!1),this.SchemaFields=new SobySchemaFields,this.OrderByFields=new SobyOrderByFields,this.Arguments=new SobyArguments,this.Headers=new SobyHeaders,this.CountQueryGenerated=null,this.MainQueryGenerated=null}return e.prototype.GetViewField=function(e){for(var t=0;t<this.SchemaFields.length;t++)if(this.SchemaFields[t].FieldName===e)return this.SchemaFields[t];return null},e.prototype.GetViewFieldByPropertyName=function(e){for(var t=0;t<this.SchemaFields.length;t++)if(this.SchemaFields[t].FieldName===e)return this.SchemaFields[t];return null},e.prototype.AddHeader=function(e,t){t=new SobyHeader(e,t);this.Headers.push(t)},e.prototype.AddSchemaField=function(e,t,i){i=new SobySchemaField(e,t,i);this.SchemaFields.push(i)},e.prototype.AddOrderField=function(e,t){this.OrderByFields.push(new SobyOrderByField(e,t))},e.prototype.AddOrderFields=function(e){for(var t=0;t<e.length;t++)this.OrderByFields.push(e[t])},e.prototype.GetCountQuery=function(e){return this.CountQueryBeingGenerated(),null},e.prototype.GetMainQuery=function(e,t){return this.MainQueryBeingGenerated(),""},e.prototype.Clone=function(){return null},e.prototype.CountQueryBeingGenerated=function(){},e.prototype.MainQueryBeingGenerated=function(){},e.prototype.DataBeingParsed=function(e,t){return e},e.prototype.ParseData=function(e){return null},e.prototype.GetData=function(e,t,i,s,a,o,n,r,l,h,d){},e}(),soby_Filter=function(){},soby_Item=function(){},soby_WebServiceService=function(){function e(e){this.NextPageString="",this.PageIndex=0,this.StartIndex=0,this.EndIndex=0,this.Filters=new SobyFilters(!1),this.GroupByFields=new SobyGroupByFields,this.OrderByFields=new SobyOrderByFields,this.NextPageExist=!1,this.ItemBeingPopulated=function(){},this.DataSourceBuilder=e,this.NextPageStrings=new Array,this.NextPageStrings[0]="",this.Transport=new soby_Transport}return e.prototype.SetRowLimit=function(e){this.DataSourceBuilder.RowLimit=e},e.prototype.PopulateNavigationInformation=function(){null!==this.NavigationInformationBeingPopulated&&this.NavigationInformationBeingPopulated();var e=this.GetQueriesAppliedDataSourceBuilder(),s=this;s.DataSourceBuilder.PageIndex=this.PageIndex,s.DataSourceBuilder.NextPageString=this.NextPageString;var t=this.Transport.Read.Type,i=this.Transport.Read.DataType,a=this.Transport.Read.ContentType,o=e.GetCountQuery(this.Transport.Read);if(null==o||""===o)return s.NextPageExist=this.DataSourceBuilder.NextPageExist,s.EndIndex=s.StartIndex+this.DataSourceBuilder.ItemCount-1,void s.NavigationInformationPopulated();var n="",r=e.GetMainQuery(this.Transport.Read,!1);null!==r&&""!==r&&("post"===t.toLowerCase()?n=r:(-1===o.indexOf("?")?o+="?":o+="&",o+=r)),e.GetData(n,function(e){var t=e.length,i=s.DataSourceBuilder.PageIndex*s.DataSourceBuilder.RowLimit+1,e=(s.DataSourceBuilder.PageIndex+1)*s.DataSourceBuilder.RowLimit;0!==(e=0===s.DataSourceBuilder.RowLimit?i=0:e)&&e<t?s.NextPageExist=!0:(s.NextPageExist=!1,e=t),s.StartIndex=i,s.EndIndex=e,s.NavigationInformationPopulated()},function(e,t,i){i="An error occured on populating grid"+e+" --- "+t+" --- "+i;null!==s.ErrorThrown&&s.ErrorThrown(i,null),soby_LogMessage(i)},function(e,t,i){},!0,o,s.DataSourceBuilder.Headers,t,i,a,this.Transport.Read.IncludeCredentials)},e.prototype.NavigationInformationBeingPopulated=function(){},e.prototype.NavigationInformationPopulated=function(){},e.prototype.GroupBy=function(e){this.GroupByFields=e,this.PopulateItems(null)},e.prototype.Sort=function(e){this.PageIndex=0,this.NextPageString="",this.NextPageStrings=new Array,this.NextPageStrings[0]="",this.OrderByFields=e,this.PopulateItems(null)},e.prototype.Filter=function(e,t){this.PageIndex=0,this.NextPageString="",this.NextPageStrings=new Array,!(this.NextPageStrings[0]="")===t&&(this.Filters=new SobyFilters(e.IsOr)),0<e.Filters.length&&this.Filters.AddFilterCollection(e),this.PopulateItems(null)},e.prototype.SortAndFilter=function(e,t,i){this.PageIndex=0,this.NextPageString="",this.NextPageStrings=new Array,this.NextPageStrings[0]="",this.OrderByFields=e,!0===i&&(this.Filters=new SobyFilters(t.IsOr)),0<t.Filters.length&&this.Filters.AddFilterCollection(t),this.PopulateItems(null)},e.prototype.GoToPage=function(e){this.DataSourceBuilder.PageIndex=e,this.PageIndex=e,this.PopulateItems(null)},e.prototype.CanNavigateToNextPage=function(){return!1!==this.NextPageExist},e.prototype.CanNavigateToPreviousPage=function(){return 0!==this.DataSourceBuilder.PageIndex},e.prototype.GetQueriesAppliedDataSourceBuilder=function(){for(var e=this.DataSourceBuilder.Clone(),t=0;t<this.GroupByFields.length;t++)e.AddOrderField(this.GroupByFields[t].FieldName,this.GroupByFields[t].IsAsc);return 0<this.OrderByFields.length&&e.AddOrderFields(this.OrderByFields),0<this.Filters.Filters.length&&e.Filters.AddFilterCollection(this.Filters),e.PageIndex=this.PageIndex,e.NextPageString=this.NextPageString,e},e.prototype.PopulateItems=function(e){this.Args=e,null!==this.ItemBeingPopulated&&this.ItemBeingPopulated(),soby_LogMessage("this.DataSourceBuilder.PageIndex:"+this.DataSourceBuilder.PageIndex),soby_LogMessage("this.DataSourceBuilder.RowLimit:"+this.DataSourceBuilder.RowLimit);var t=this.GetQueriesAppliedDataSourceBuilder();soby_LogMessage("dataSourceBuilder.PageIndex:"+t.PageIndex),soby_LogMessage("dataSourceBuilder.RowLimit:"+t.RowLimit);var s=this,i=this.Transport.Read.Url,a=this.Transport.Read.Type,o=this.Transport.Read.DataType,n=this.Transport.Read.ContentType,r="",e=t.GetMainQuery(this.Transport.Read,!1);null!==e&&""!==e&&("post"===a.toLowerCase()?r=e:(-1===i.indexOf("?")?i+="?":i+="&",i+=e)),t.GetData(r,function(e){soby_LogMessage(e);var t=s.DataSourceBuilder.ParseData(e);soby_LogMessage("service.DataSourceBuilder.PageIndex:"+s.DataSourceBuilder.PageIndex),soby_LogMessage("service.DataSourceBuilder.RowLimit:"+s.DataSourceBuilder.RowLimit),soby_LogMessage("service.DataSourceBuilder.ItemCount :"+s.DataSourceBuilder.ItemCount);var i=s.DataSourceBuilder.PageIndex*s.DataSourceBuilder.RowLimit+1,e=i+s.DataSourceBuilder.ItemCount-1;soby_LogMessage("startIndex :"+i),soby_LogMessage("endIndex :"+e),0===s.DataSourceBuilder.ItemCount&&(e=i=0),s.StartIndex=i,s.EndIndex=e,s.ItemPopulated(t)},function(e,t,i){i="An error occured on populating grid"+e+" --- "+t+" --- "+i;null!==s.ErrorThrown&&s.ErrorThrown(i,null),soby_LogMessage(i)},function(e,t,i){},!0,i,s.DataSourceBuilder.Headers,a,o,n,this.Transport.Read.IncludeCredentials)},e.prototype.Parse=function(){},e.prototype.GetFieldNames=function(){for(var e=new Array,t=0;t<this.DataSourceBuilder.SchemaFields.length;t++)e[e.length]={FieldName:this.DataSourceBuilder.SchemaFields[t].FieldName};return e},e.prototype.ItemPopulated=function(e){},e.prototype.ErrorThrown=function(e,t){},e.prototype.UpdateItem=function(e,t,i){for(var s=this.Transport.Update.Url,a=0;a<t.length;a++)var o=new RegExp(e[a],"gi"),s=s.replace(o,t[a]);ajaxHelper(s,this.Transport.Update.Type,i,[this,t],function(e,t){t[0].ItemUpdated(t)},function(e){})},e.prototype.DeleteItem=function(e,t){for(var i=this.Transport.Delete.Url,s=0;s<t.length;s++)var a=new RegExp(e[s],"gi"),i=i.replace(a,t[s]);ajaxHelper(i,this.Transport.Delete.Type,null,[this,t],function(e,t){t[0].ItemDeleted(t)},function(e){})},e.prototype.AddItem=function(e){ajaxHelper(this.Transport.Add.Url,this.Transport.Add.Type,e,[this],function(e,t){t[0].ItemAdded(t)},function(e){})},e.prototype.ItemUpdated=function(e){},e.prototype.ItemAdded=function(e){},e.prototype.ItemDeleted=function(e){},e}(),soby_StaticDataBuilder=function(t){function e(){var e=t.call(this)||this;return e.RowLimit=100,e}return __extends(e,t),e.prototype.Clone=function(){var e=new soby_WSBuilder;e.RowLimit=this.RowLimit;for(var t=0;t<this.SchemaFields.length;t++){var i=this.SchemaFields[t];e.AddSchemaField(i.FieldName,i.FieldType,i.Args)}e.Filters=this.Filters.Clone();for(t=0;t<this.Headers.length;t++){var s=this.Headers[t];e.AddHeader(s.Key,s.Value)}for(t=0;t<this.OrderByFields.length;t++){var a=this.OrderByFields[t];e.AddOrderField(a.FieldName,a.IsAsc)}return e.Arguments=null!==this.Arguments?this.Arguments.Clone():null,e},e.prototype.GetPagingQuery=function(e){return"POST"===e.Type?"'pageIndex': "+this.PageIndex+",'pageItemCount': "+this.RowLimit:"$skip="+this.PageIndex*this.RowLimit+"&$top="+this.RowLimit},e.prototype.GetViewFieldsQuery=function(e){return e.Type,this.SchemaFields.toWebAPIString()},e.prototype.GetOrderByFieldsQuery=function(e){for(var t="",i=0;i<this.OrderByFields.length;i++)t+=this.OrderByFields[i].FieldName+" "+(!0===this.OrderByFields[i].IsAsc?"asc":"desc")+",";return""!==t&&(t=t.substr(0,t.length-1)),"POST"===e.Type?t="'orderByString': \""+(t=""===t?"null":t)+'"':""!==t&&(t="$orderby="+t),t},e.prototype.GetWhereQuery=function(e){var t="";return"POST"===e.Type?t=this.Filters.ToJson():""!==(t=this.Filters.ToQueryString(0))&&(t="$filter="+t),t},e.prototype.GetMainQuery=function(e,t){this.MainQueryBeingGenerated();var i=this.GetViewFieldsQuery(e),s=this.GetWhereQuery(e),a=this.GetOrderByFieldsQuery(e),o="";!1===t&&(o=this.GetPagingQuery(e));var n;return"POST"===e.Type?n="{"+(""!==s?s+", ":"")+(""!==a?a+", ":"")+(o=!0===t?"''":o)+"}":(""!==(n=s)&&""!==i&&(n+="&"),""!==(n+=i)&&""!==a&&(n+="&"),""!==(n+=a)&&""!==o&&(n+="&"),n+=o),null!==this.MainQueryGenerated?this.MainQueryGenerated(n):n},e.prototype.GetCountQuery=function(e){this.CountQueryBeingGenerated();var t=this.GetMainQuery(e,!0),i=e.Url+"/$count?"+t;return"POST"===e.Type?"{"+t+"}":i},e.prototype.ParseData=function(e){for(var e=null!=e.value?e.value:e,t=0;t<e.length;t++)for(var i,s,a=0;a<this.SchemaFields.length;a++)this.SchemaFields[a].FieldType===SobyFieldTypes.DateTime&&(i=this.SchemaFields[a].FieldName,null!==(s=e[t][i])&&""!==s&&(e[t][i]=new Date(+s.match(/\d+/)[0])));return e},e.prototype.GetData=function(e,t,s,i,a,o,n,r,l,h){null!==r&&""!==r||(r="POST"),null===h&&(h=!1),$.ajax({async:null===a||a,url:o,type:r,dataType:l,data:e,processData:!1,contentType:"application/json; charset=utf-8",xhrFields:!0===h?{withCredentials:!0}:{},complete:function(e){},error:function(e,t,i){s&&s(e,t,i)},success:function(e){null!==(e=e).d&&(e=e.d),t&&t(e)},beforeSend:function(e){if(null!==n)for(var t=0;t<n.length;t++)e.setRequestHeader(n[t].Key,n[t].Value)}})},e}(soby_DataSourceBuilderAbstract),soby_StaticDataService=function(){function e(e,t){this.NextPageString="",this.PageIndex=0,this.StartIndex=0,this.EndIndex=0,this.Filters=new SobyFilters(!1),this.GroupByFields=new SobyGroupByFields,this.OrderByFields=new SobyOrderByFields,this.NextPageExist=!1,this.Items=t;var i=new soby_StaticDataBuilder;i.Filters=new SobyFilters(!1);for(var s=0;s<e.length;s++)i.AddSchemaField(e[s].FieldName,e[s].FieldType,e[s].Args);this.DataSourceBuilder=i,this.DataSourceBuilder=this.DataSourceBuilder.Clone(),this.NextPageStrings=new Array,this.NextPageStrings[0]=""}return e.prototype.GroupBy=function(e){this.GroupByFields=e,this.PopulateItems(null)},e.prototype.NavigationInformationBeingPopulated=function(){},e.prototype.NavigationInformationPopulated=function(){},e.prototype.ItemPopulated=function(e){},e.prototype.ItemBeingPopulated=function(){},e.prototype.ErrorThrown=function(e){},e.prototype.ItemUpdated=function(e){},e.prototype.ItemAdded=function(e){},e.prototype.ItemDeleted=function(e){},e.prototype.SetRowLimit=function(e){this.DataSourceBuilder.RowLimit=e},e.prototype.PopulateNavigationInformation=function(){null!==this.NavigationInformationBeingPopulated&&this.NavigationInformationBeingPopulated();var e=this.Items.length,t=this.DataSourceBuilder.PageIndex*this.DataSourceBuilder.RowLimit+1,i=(this.DataSourceBuilder.PageIndex+1)*this.DataSourceBuilder.RowLimit;0!==(i=0===this.DataSourceBuilder.RowLimit?t=0:i)&&i<e?this.NextPageExist=!0:(this.NextPageExist=!1,i=e),soby_LogMessage("NextPageExist:"+this.NextPageExist),this.StartIndex=t,this.EndIndex=i,this.NavigationInformationPopulated()},e.prototype.Sort=function(e){this.PageIndex=0,this.NextPageString="",this.NextPageStrings=new Array,this.NextPageStrings[0]="",this.OrderByFields=e,this.PopulateItems(null)},e.prototype.Filter=function(e,t){this.PageIndex=0,this.NextPageString="",this.NextPageStrings=new Array,!(this.NextPageStrings[0]="")===t&&(this.Filters=new SobyFilters(e.IsOr)),this.Filters.AddFilterCollection(e),this.PopulateItems(null)},e.prototype.SortAndFilter=function(e,t,i){this.PageIndex=0,this.NextPageString="",this.NextPageStrings=new Array,this.NextPageStrings[0]="",this.OrderByFields=e,!0===i&&(this.Filters=new SobyFilters(t.IsOr)),0<t.Filters.length&&this.Filters.AddFilterCollection(t),this.PopulateItems(null)},e.prototype.GoToPage=function(e){this.DataSourceBuilder.PageIndex=e,this.PageIndex=e,this.PopulateItems(null)},e.prototype.CanNavigateToNextPage=function(){return!1!==this.NextPageExist},e.prototype.CanNavigateToPreviousPage=function(){return 0!==this.DataSourceBuilder.PageIndex},e.prototype.PopulateItems=function(e){this.Args=e,null!==this.ItemBeingPopulated&&this.ItemBeingPopulated(),this.DataSourceBuilder.PageIndex=this.PageIndex,this.DataSourceBuilder.NextPageString=this.NextPageString;var s,t=JSON.parse(JSON.stringify(this.Items));if(0<this.Filters.Filters.length)for(var i=t.length-1;-1<i;i--)!1===this.CheckIfMatchFilters(t[i],this.Filters)&&t.splice(i,1);else if(0<this.DataSourceBuilder.Filters.Filters.length)for(i=t.length-1;-1<i;i--)!1===this.CheckIfMatchFilters(t[i],this.DataSourceBuilder.Filters)&&t.splice(i,1);0<this.OrderByFields.length&&(s=this.OrderByFields,t.sort(function(e,t){for(var i=0;i<s.length;i++){if(e[s[i].FieldName]>t[s[i].FieldName])return!0===s[i].IsAsc?1:-1;if(e[s[i].FieldName]<t[s[i].FieldName])return!0===s[i].IsAsc?-1:1}return 0}));var a=new Array;if(0<this.DataSourceBuilder.RowLimit)for(i=this.PageIndex*this.DataSourceBuilder.RowLimit;i<(this.PageIndex+1)*this.DataSourceBuilder.RowLimit&&!(i>t.length-1);i++)a.push(t[i]);else a=t;this.ItemPopulated(a)},e.prototype.CheckIfMatchFilter=function(e,t){if(t.FilterType===SobyFilterTypes.Equal){if(e!==t.FilterValue)return!1}else if(t.FilterType===SobyFilterTypes.BeginsWith){if(null==e)return!1;if(!1===e.toString().startsWith(t.FilterValue))return!1}else if(t.FilterType===SobyFilterTypes.Contains){if(null==e)return!1;if(-1===e.toString().indexOf(t.FilterValue))return!1}else if(t.FilterType===SobyFilterTypes.Greater){if(e>t.FilterValue)return!1}else if(t.FilterType===SobyFilterTypes.GreaterEqual){if(e>=t.FilterValue)return!1}else if(t.FilterType===SobyFilterTypes.IsNotNull){if(null==e)return!1}else if(t.FilterType===SobyFilterTypes.IsNull){if(null!==e||void 0!==e)return!1}else if(t.FilterType===SobyFilterTypes.Lower){if(e<t.FilterValue)return!1}else if(t.FilterType===SobyFilterTypes.LowerEqual){if(e<=t.FilterValue)return!1}else if(t.FilterType===SobyFilterTypes.NotEqual&&e===t.FilterValue)return!1;return!0},e.prototype.CheckIfMatchFilters=function(e,t){for(var i=0;i<t.Filters.length;i++)if(t.Filters[i]instanceof SobyFilters){if(!1===this.CheckIfMatchFilters(e,t.Filters[i]))return!1}else if(!1===this.CheckIfMatchFilter(e[t.Filters[i].FieldName],t.Filters[i]))return!1;return!0},e.prototype.GetFieldNames=function(){return new Array},e.prototype.UpdateItem=function(e,t,i){if(null!=t&&0!==t.length){for(var s=0;s<this.Items.length;s++){for(var a=!0,o=0;o<e.length;o++)if(this.Items[s][e[o]]!==t[0][e[o]]){a=!1;break}!0===a&&(this.Items[s]=i)}this.ItemUpdated(null)}},e.prototype.DeleteItem=function(e,t){for(var i=new Array,s=this.Items.length-1;-1<s;s--){for(var a=!0,o=0;o<e.length;o++)this.Items[s][e[o]]!==t[o]&&(a=!1);!1===a&&(i[i.length]=this.Items[s])}this.Items=i,this.ItemDeleted(null)},e.prototype.AddItem=function(e){this.Items[this.Items.length]=e,this.ItemAdded(null)},e}();function WSArgument(e,t){this.FieldName=e,this.FilterValue=t}function WSHeader(e,t){this.Key=e,this.Value=t}var soby_WSBuilder=function(t){function r(){var e=t.call(this)||this;return e.WebServiceDataTypes=SobyWebServiceDataTypes.Json,e.MethodName="",e.CountQuerySupported=!0,e.RowLimit=100,e}return __extends(r,t),r.prototype.Clone=function(){var e,t=new r;for(e in this)"function"==typeof this[e]&&(t[e.toString()]=this[e]);t.RowLimit=this.RowLimit,t.PageIndex=this.PageIndex,t.NextPageExist=this.NextPageExist;for(var i=0;i<this.SchemaFields.length;i++){var s=this.SchemaFields[i];t.AddSchemaField(s.FieldName,s.FieldType,s.Args)}t.Filters=this.Filters.Clone();for(i=0;i<this.Headers.length;i++){var a=this.Headers[i];t.AddHeader(a.Key,a.Value)}for(i=0;i<this.OrderByFields.length;i++){var o=this.OrderByFields[i];t.AddOrderField(o.FieldName,o.IsAsc)}if(null!==this.Arguments){t.Arguments=new SobyArguments;for(i=0;i<this.Arguments.length;i++){var n=this.Arguments[i];t.Arguments.push(n)}}return t.DataBeingParsed=this.DataBeingParsed,t.WebServiceDataTypes=this.WebServiceDataTypes,t.MethodName=this.MethodName,t.CountQuerySupported=this.CountQuerySupported,t.MainQueryBeingGenerated=this.MainQueryBeingGenerated,t.CountQueryBeingGenerated=this.CountQueryBeingGenerated,t},r.prototype.GetPagingQuery=function(e){if(this.WebServiceDataTypes!==SobyWebServiceDataTypes.Soap)return"POST"===e.Type?"'pageIndex': "+this.PageIndex+",'pageItemCount': "+this.RowLimit:0<this.RowLimit?"$skip="+this.PageIndex*this.RowLimit+"&$top="+this.RowLimit:""},r.prototype.GetViewFieldsQuery=function(e){return e.Type,this.SchemaFields.toWebAPIString()},r.prototype.GetOrderByFieldsQuery=function(e){for(var t="",i=0;i<this.OrderByFields.length;i++)t+=this.OrderByFields[i].FieldName+" "+(!0===this.OrderByFields[i].IsAsc?"asc":"desc")+",";return""!==t&&(t=t.substr(0,t.length-1)),"POST"===e.Type?t="'orderByString': \""+(t=""===t?"null":t)+'"':""!==t&&(t="$orderby="+t),t},r.prototype.GetWhereQuery=function(e){var t="";return this.WebServiceDataTypes===SobyWebServiceDataTypes.Soap&&(t=this.Filters.ToXml()),"POST"===e.Type?t=this.Filters.ToJson():""!==(t=this.Filters.ToQueryString(0))&&(t="$filter="+t),t},r.prototype.GetMainQuery=function(e,t){if(this.MainQueryBeingGenerated(),this.WebServiceDataTypes===SobyWebServiceDataTypes.Soap)return i="<?xml version= '1.0' encoding= 'utf-8' ?><soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'><soap:Body><"+this.MethodName+" xmlns= 'http://tempuri.org/'> "+this.Filters.ToXml()+"</"+this.MethodName+"></soap:Body></soap:Envelope>";var i,s="",a=this.GetViewFieldsQuery(e),o=this.GetWhereQuery(e),n=this.GetOrderByFieldsQuery(e),r="";return!1===t&&(r=this.GetPagingQuery(e)),s="POST"===e.Type?"{"+(""!==o?o+", ":"")+(""!==n?n+", ":"")+(r=!0===t?"''":r)+"}":(""!==(i=o)&&""!==a&&(i+="&"),""!==(i+=a)&&""!==n&&(i+="&"),""!==(i+=n)&&""!==r&&(i+="&"),i+=r),s=null!==this.MainQueryGenerated?this.MainQueryGenerated(s):s},r.prototype.GetCountQuery=function(e){if(!1===this.CountQuerySupported)return"";this.CountQueryBeingGenerated();var t=this.GetMainQuery(e,!0),i=e.Url+"/$count?"+t;return"POST"===e.Type?"{"+t+"}":i},r.prototype.ParseData=function(e){for(var t=null!==e.value&&void 0!==e.value?e.value:e,t=this.DataBeingParsed(t,!1),i=0;i<t.length;i++)for(var s,a,o=0;o<this.SchemaFields.length;o++)this.SchemaFields[o].FieldType===SobyFieldTypes.DateTime&&(s=this.SchemaFields[o].FieldName,null!==(a=t[i][s])&&(a instanceof Date==!0?t[i][s]=a:""!==a&&(0===a.indexOf("20")||0===a.indexOf("19")?t[i][s]=new Date(a):t[i][s]=new Date(+a.match(/\d+/)[0]))));return t},r.prototype.GetData=function(e,t,s,i,a,o,n,r,l,h,d){null!==h&&""!==h||(h="application/json; charset=utf-8"),"GET"===(r=null===r||""===r?"POST":r)&&(h=""),$.ajax({async:null===a||a,url:o,type:r,dataType:l,data:e,processData:!1,contentType:h,xhrFields:!0===d?{withCredentials:!0}:{},complete:function(e){},error:function(e,t,i){s&&s(e,t,i)},success:function(e){null!==(e=null!==(e=sobyLastReturnData=e).d&&void 0!==e.d?e.d:e).results&&void 0!==e.results&&(e=e.results),t&&t(e)},beforeSend:function(e){if(null!==n)for(var t=0;t<n.length;t++)e.setRequestHeader(n[t].Key,n[t].Value)}})},r}(soby_DataSourceBuilderAbstract);Date.prototype.toISOString||function(){function e(e){e=String(e);return e=1===e.length?"0"+e:e}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+e(this.getUTCMonth()+1)+"-"+e(this.getUTCDate())+"T"+e(this.getUTCHours())+":"+e(this.getUTCMinutes())+":"+e(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}();var soby_guid=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return function(){return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}}();function soby_LogMessage(e){try{console.log(e)}catch(e){}}function soby_DateToIso(e){var t=6e4*(new Date).getTimezoneOffset();return new Date(e-t).toISOString()}function soby_DateFromISO(e){var t=e.split(" ")[0],i=e.split(" ")[1].split(":"),s=i[0],a=i[1],o=i[2],e=t.split("-"),i=e[0],t=e[1]-1,e=e[2];return new Date(i,t,e,s,a,o)}function soby_GetFormatedDateString(e){return null!==e?e.toLocaleDateString("en-gb",{year:"numeric",month:"short",day:"numeric"}):""}function soby_GetDateWithFormat(e,t){var i="";if(0<t.indexOf(".")?i=".":0<t.indexOf("\\")?i="\\":0<t.indexOf("/")?i="/":0<t.indexOf("-")&&(i="-"),""===i)return null;var s=t.toLowerCase().split(i),t=e.split(i),e=s.indexOf("mm"),i=s.indexOf("dd"),s=s.indexOf("yyyy");if(-1===i)return null;if(-1===e)return null;if(-1===s)return null;i=t[i],e=parseInt(t[e])-1;return new Date(t[s],e,i)}function soby_TicksFromDate(e){return 1e4*e.getTime()+621355968e9}function soby_DateFromTicks(e){return new Date((e-621355968e9)/1e4)}function soby_IsNullOrEmpty(e){return null==e||""===e}var __extends=this&&this.__extends||function(){var s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)};return function(e,t){function i(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),soby_SharePointService=function(){function e(e){this.NextPageString="",this.PageIndex=0,this.StartIndex=0,this.EndIndex=0,this.Filters=new SobyFilters(!1),this.GroupByFields=new SobyGroupByFields,this.OrderByFields=new SobyOrderByFields,this.InitialFilters=new SobyFilters(!1),this.InitialOrderByFields=new SobyOrderByFields,this.NextPageExist=!1,this.DataSourceBuilder=e,this.NextPageStrings=new Array,this.NextPageStrings[0]="",this.Transport=new soby_Transport,this.InitialFilters=e.Filters.Clone(),this.InitialOrderByFields=e.OrderByFields.Clone(),this.DataSourceBuilder.Filters=new SobyFilters(!1),this.DataSourceBuilder.OrderByFields=new SobyOrderByFields}return e.prototype.SetRowLimit=function(e){this.DataSourceBuilder.RowLimit=e},e.prototype.PopulateNavigationInformation=function(){null!=this.NavigationInformationBeingPopulated&&this.NavigationInformationBeingPopulated();var s=this,e=this.Transport.Read.Type,t=this.Transport.Read.DataType,i=this.Transport.Read.ContentType,a=this.GetDataSourceBuilderForQueries(),o=a.GetCountQuery(this.Transport.Read);if(soby_LogMessage("dataSourceBuilder:"),soby_LogMessage(a),soby_LogMessage("this.dataSourceBuilder:"),soby_LogMessage(this),null===o){var n=s.DataSourceBuilder.PageIndex*s.DataSourceBuilder.RowLimit+1,r=(s.DataSourceBuilder.PageIndex+1)*s.DataSourceBuilder.RowLimit;return 0===s.DataSourceBuilder.RowLimit&&(r=n=0),s.NextPageExist=s.DataSourceBuilder.NextPageExist,s.NextPageString=s.DataSourceBuilder.NextPageString,s.NextPageStrings[this.PageIndex+1]=s.NextPageString,soby_LogMessage("NextPageExist:"+s.NextPageExist),this.StartIndex=n,this.EndIndex=r,void this.NavigationInformationPopulated()}soby_LogMessage("querying count..."),a.GetData("",function(e){var t=parseInt(e);soby_LogMessage("Total item count:"+t);var i=s.DataSourceBuilder.PageIndex*s.DataSourceBuilder.RowLimit+1,e=(s.DataSourceBuilder.PageIndex+1)*s.DataSourceBuilder.RowLimit;0!=(e=0===s.DataSourceBuilder.RowLimit?i=0:e)&&e<t?s.NextPageExist=!0:(s.NextPageExist=!1,e=t),soby_LogMessage("NextPageExist:"+s.NextPageExist),s.StartIndex=i,s.EndIndex=e,s.NavigationInformationPopulated()},function(e,t,i){e="An error occured on populating grid"+e+" --- "+t+" --- "+i,i="";try{i=t.get_errorTypeName()}catch(e){}null!=s.ErrorThrown&&s.ErrorThrown(e,i),soby_LogMessage(e)},function(e,t,i){},!0,o,s.DataSourceBuilder.Headers,e,t,i,this.Transport.Read.IncludeCredentials)},e.prototype.NavigationInformationBeingPopulated=function(){},e.prototype.NavigationInformationPopulated=function(){},e.prototype.GroupBy=function(e){this.GroupByFields=e,this.PopulateItems(null)},e.prototype.Sort=function(e){this.PageIndex=0,this.NextPageString="",this.NextPageStrings=[],this.NextPageStrings[0]="",this.OrderByFields=e,this.PopulateItems(null)},e.prototype.Filter=function(e,t){this.PageIndex=0,this.NextPageString="",this.NextPageStrings=[],!(this.NextPageStrings[0]="")===t&&(this.Filters=new SobyFilters(e.IsOr)),0<e.Filters.length&&this.Filters.AddFilterCollection(e),this.PopulateItems(null)},e.prototype.SortAndFilter=function(e,t,i){this.PageIndex=0,this.NextPageString="",this.NextPageStrings=[],this.NextPageStrings[0]="",this.OrderByFields=e,!0===i&&(this.Filters=new SobyFilters(t.IsOr)),0<t.Filters.length&&this.Filters.AddFilterCollection(t),this.PopulateItems(null)},e.prototype.GoToPage=function(e){this.DataSourceBuilder.PageIndex=e,this.PageIndex=e,this.NextPageString=this.NextPageStrings[e],this.PopulateItems(null)},e.prototype.CanNavigateToNextPage=function(){return!1!==this.NextPageExist},e.prototype.CanNavigateToPreviousPage=function(){return 0!==this.DataSourceBuilder.PageIndex},e.prototype.GetDataSourceBuilderForQueries=function(){for(var e=this.DataSourceBuilder.Clone(),t=0;t<this.GroupByFields.length;t++)e.AddOrderField(this.GroupByFields[t].FieldName,this.GroupByFields[t].IsAsc);return e.OrderByFields=new SobyOrderByFields([]),0<this.OrderByFields.length&&e.AddOrderFields(this.OrderByFields),e.Filters=new SobyFilters(!1),0<this.Filters.Filters.length&&e.Filters.AddFilterCollection(this.Filters),0<this.InitialFilters.Filters.length&&e.Filters.AddFilterCollection(this.InitialFilters),e.PageIndex=this.PageIndex,0===this.PageIndex?e.NextPageString="":e.NextPageString=this.NextPageString,e},e.prototype.PopulateItems=function(e){this.Args=e,null!=this.ItemBeingPopulated&&this.ItemBeingPopulated();var s=this.GetDataSourceBuilderForQueries(),a=this,t=this.Transport.Read.Url,i=this.Transport.Read.Type,o=this.Transport.Read.DataType,n=this.Transport.Read.ContentType,e=s.GetMainQuery(this.Transport.Read,!1);null!=e&&""!=e&&(-1===t.indexOf("?")?t+="?":t+="&",t+=e),s.GetData("",function(e){soby_LogMessage(e);var t=s.ParseData(e);soby_LogMessage(t),soby_LogMessage(a);var i=s.PageIndex*s.RowLimit+1,e=i+s.ItemCount-1;0===s.ItemCount&&(e=i=0),a.DataSourceBuilder.NextPageExist=s.NextPageExist,a.DataSourceBuilder.NextPageString=s.NextPageString,a.StartIndex=i,a.EndIndex=e,a.ItemPopulated(t)},function(e,t,i){e="An error occured on populating grid"+e+" --- "+t+" --- "+i,i="";try{"Microsoft.SharePoint.SPQueryThrottledException"===(i=t.get_errorTypeName())&&(e="Your query returned number of items which is higher than threshold. Please apply some filters and try again.")}catch(e){}null!=a.ErrorThrown&&a.ErrorThrown(e,i),soby_LogMessage(e)},function(e,t,i){},!0,t,s.Headers,i,o,n,this.Transport.Read.IncludeCredentials)},e.prototype.Parse=function(){},e.prototype.GetFieldNames=function(){for(var e=[],t=0;t<this.DataSourceBuilder.SchemaFields.length;t++)e[e.length]={FieldName:this.DataSourceBuilder.SchemaFields[t].FieldName};return e},e.prototype.ItemPopulated=function(e){},e.prototype.ItemBeingPopulated=function(){},e.prototype.ErrorThrown=function(e,t){},e.prototype.UpdateItem=function(e,t,i){for(var s=this.Transport.Update.Url,a=0;a<t.length;a++)var o=new RegExp(e[a],"gi"),s=s.replace(o,t[a]);ajaxHelper(s,this.Transport.Update.Type,i,[this,t],function(e,t){t[0].ItemUpdated(t)},function(e){})},e.prototype.DeleteItem=function(e,t){for(var i=this.Transport.Delete.Url,s=0;s<t.length;s++)var a=new RegExp(e[s],"gi"),i=i.replace(a,t[s]);ajaxHelper(i,this.Transport.Delete.Type,null,[this,t],function(e,t){t[0].ItemDeleted(t)},function(e){})},e.prototype.AddItem=function(e){ajaxHelper(this.Transport.Add.Url,this.Transport.Add.Type,e,[this],function(e,t){t[0].ItemAdded(t)},function(e){})},e.prototype.ItemUpdated=function(e){},e.prototype.ItemAdded=function(e){},e.prototype.ItemDeleted=function(e){},e}(),soby_SPSearchBuilder=function(t){function o(){var e=null!==t&&t.apply(this,arguments)||this;return e.SourceId="",e}return __extends(o,t),o.prototype.Clone=function(){var e=new o;e.RowLimit=this.RowLimit,e.PageIndex=this.PageIndex,e.SourceId=this.SourceId;for(var t=0;t<this.SchemaFields.length;t++){var i=this.SchemaFields[t];e.AddSchemaField(i.FieldName,i.FieldType,i.Args)}e.Filters=this.Filters.Clone();for(t=0;t<this.Headers.length;t++){var s=this.Headers[t];e.AddHeader(s.Key,s.Value)}for(t=0;t<this.OrderByFields.length;t++){var a=this.OrderByFields[t];e.AddOrderField(a.FieldName,a.IsAsc)}return e.Arguments=null!=this.Arguments?this.Arguments.Clone():null,e},o.prototype.GetWhereQuery=function(e){var t="";return"POST"===e.Type?t=this.Filters.ToJson():(t="querytext="+(t=this.Filters.ToQueryString(1)),""!=this.SourceId&&(t+="&sourceId='"+this.SourceId+"'")),t},o.prototype.GetViewFieldsQuery=function(e){for(var t="",i=0;i<this.SchemaFields.length;i++)0<i&&(t+=","),t+=this.SchemaFields[i].FieldName;return t=""!=t?"&selectproperties='"+t+"'":t},o.prototype.GetPagingQuery=function(e){return 0<this.RowLimit?"startrow="+this.PageIndex*this.RowLimit+"&rowlimit="+this.RowLimit:""},o.prototype.ParseData=function(e){for(var t=[],i=e.PrimaryQueryResult.RelevantResults.Table.Rows,s=0;s<i.length;s++){for(var a=new Object,o=i[0],n=0;n<this.SchemaFields.length;n++){a[this.SchemaFields[n].FieldName]="";for(var r=0;r<o.Cells.length;r++)this.SchemaFields[n].FieldName===o.Cells[r].Key&&(a[this.SchemaFields[n].FieldName]=o.Cells[r].Value)}t.push(a)}return t},o.prototype.GetCountQuery=function(e){return null},o}(soby_WSBuilder),soby_SPSearch2010Builder=function(t){function o(){var e=null!==t&&t.apply(this,arguments)||this;return e.Scope="",e.IsDocument=!1,e}return __extends(o,t),o.prototype.Clone=function(){var e=new o;e.RowLimit=this.RowLimit,e.PageIndex=this.PageIndex,e.Scope=this.Scope;for(var t=0;t<this.SchemaFields.length;t++){var i=this.SchemaFields[t];e.AddSchemaField(i.FieldName,i.FieldType,i.Args)}e.Filters=this.Filters.Clone();for(t=0;t<this.Headers.length;t++){var s=this.Headers[t];e.AddHeader(s.Key,s.Value)}for(t=0;t<this.OrderByFields.length;t++){var a=this.OrderByFields[t];e.AddOrderField(a.FieldName,a.IsAsc)}return e.Arguments=null!=this.Arguments?this.Arguments.Clone():null,e},o.prototype.GetWhereQuery=function(e){var t="",t=this.Filters.ToSearch2010Xml();return""!=this.Scope&&(""!=t&&(t+=" AND "),t+="(scope:"+this.Scope+")"),t+="<Context><QueryText language='en-US' type='STRING'>"+t+"</QueryText></Context>"},o.prototype.GetViewFieldsQuery=function(e){for(var t="<Properties>",i=0;i<this.SchemaFields.length;i++)t+="<Property name='"+this.SchemaFields[i].FieldName+"'></Property>";return t+="</Properties>"},o.prototype.GetPagingQuery=function(e){return 0<this.RowLimit?"<Range><Count>"+this.RowLimit+"</Count></Range>":""},o.prototype.GetMainQuery=function(e,t){var i=this.GetViewFieldsQuery(e),s="";return"<soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'><soap:Body><QueryEx xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'><queryXml><![CDATA[<QueryPacket xmlns='urn:Microsoft.Search.Query'><Query><TrimDuplicates>false</TrimDuplicates>"+this.GetWhereQuery(e)+(s=!1===t?this.GetPagingQuery(e):s)+i+"</Query></QueryPacket>]]></queryXml></QueryEx></soap:Body></soap:Envelope>"},o.prototype.ParseData=function(e){for(var e=$(e.children[0]).html(),t=[],i=$(e.replace(/<soap:/gi,"<").replace(/<\/soap:/gi,"</").replace(/<xsi:/gi,"<").replace(/<\/xsi:/gi,"</").replace(/<xsd:/gi,"<").replace(/<\/xsd:/gi,"</").replace(/<xs:/gi,"<").replace(/<\/xs:/gi,"</")).find("Results RelevantResults"),s=0;s<i.length;s++){for(var a=new Object,o=$(i[s]),n=0;n<this.SchemaFields.length;n++){var r=o.find(this.SchemaFields[n].FieldName);0<r.length?a[this.SchemaFields[n].FieldName]=r.text():a[this.SchemaFields[n].FieldName]=""}t.push(a)}return t},o.prototype.GetCountQuery=function(e){return null},o}(soby_WSBuilder),soby_SPRestBuilder=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return __extends(o,e),o.prototype.Clone=function(){var e=new o;e.RowLimit=this.RowLimit,e.PageIndex=this.PageIndex,e.NextPageExist=this.NextPageExist,e.NextPageString=this.NextPageString;for(var t=0;t<this.SchemaFields.length;t++){var i=this.SchemaFields[t];e.AddSchemaField(i.FieldName,i.FieldType,i.Args)}e.Filters=this.Filters.Clone();for(t=0;t<this.Headers.length;t++){var s=this.Headers[t];e.AddHeader(s.Key,s.Value)}e.OrderByFields=new SobyOrderByFields;for(t=0;t<this.OrderByFields.length;t++){var a=this.OrderByFields[t];e.AddOrderField(a.FieldName,a.IsAsc)}return e.Arguments=null!==this.Arguments?this.Arguments.Clone():null,e},o.prototype.GetWhereQuery=function(e){var t="";return"POST"===e.Type?t=this.Filters.ToJson():""!==(t=this.Filters.ToQueryString(1))&&(t="$filter="+t),t},o}(soby_WSBuilder),soby_SPCSOMBuilder=function(t){function o(){var e=null!==t&&t.apply(this,arguments)||this;return e.ListTitle="",e.SiteUrl="",e.UseViewFields=!1,e}return __extends(o,t),o.prototype.Clone=function(){var e=new o;e.ListTitle=this.ListTitle,e.SiteUrl=this.SiteUrl,e.RowLimit=this.RowLimit,e.UseViewFields=this.UseViewFields,e.NextPageExist=this.NextPageExist,e.NextPageString=this.NextPageString;for(var t=0;t<this.SchemaFields.length;t++){var i=this.SchemaFields[t];e.AddSchemaField(i.FieldName,i.FieldType,i.Args)}e.Filters=this.Filters.Clone();for(t=0;t<this.Headers.length;t++){var s=this.Headers[t];e.AddHeader(s.Key,s.Value)}for(t=0;t<this.OrderByFields.length;t++){var a=this.OrderByFields[t];e.AddOrderField(a.FieldName,a.IsAsc)}return e.Arguments=null!=this.Arguments?this.Arguments.Clone():null,e},o.prototype.GetCountQuery=function(e){return null},o.prototype.GetData=function(e,d,a,t,i,s,o,n,r){var c=new soby_CamlBuilder(this.ListTitle,"",10,"");c.Filters=this.Filters,c.OrderByFields=this.OrderByFields,c.SchemaFields=this.SchemaFields;var u=null,p=(u=null!=this.SiteUrl&&""!=this.SiteUrl?new SP.ClientContext(this.SiteUrl):new SP.ClientContext.get_current).get_web().get_lists().getByTitle(this.ListTitle);u.load(p),u.executeQueryAsync(Function.createDelegate(this,function(e,t){var i=new SP.CamlQuery;null!=this.NextPageString&&""!=this.NextPageString&&((s=new SP.ListItemCollectionPosition).set_pagingInfo(this.NextPageString),i.set_listItemCollectionPosition(s));var s="<View Scope='RecursiveAll'>"+(!0===this.UseViewFields?c.GetViewFieldsQuery():"")+"<Query>"+c.GetOrderByFieldsQuery()+c.GetWhereQuery()+"</Query><RowLimit>"+this.RowLimit+"</RowLimit></View>";soby_LogMessage(s),i.set_viewXml(s);var l=p.getItems(i);u.load(l);var h=this;u.executeQueryAsync(Function.createDelegate(this,function(e,t){var i=l.get_listItemCollectionPosition();null!=i?(h.NextPageExist=!0,h.NextPageString=i.get_pagingInfo()):h.NextPageExist=!1;for(var s=[],a=l.getEnumerator();a.moveNext();){for(var o=new Object,n=a.get_current(),r=0;r<h.SchemaFields.length;r++)try{o[h.SchemaFields[r].FieldName]=n.get_item(h.SchemaFields[r].FieldName)}catch(e){}s[s.length]=o}d&&d(s)}),Function.createDelegate(this,function(e,t,i){a&&a(e,t,i)}))}),Function.createDelegate(this,function(e,t,i){a&&a(e,t,i)}))},o}(soby_SPRestBuilder);function soby_CamlBuilder(e,t,i,s){this.WebUrl=s,this.ActionName=e,this.SchemaFields=[],this.ViewName=t,this.RowLimit=i,this.PageIndex=0,this.NextPageString="",this.OrderByFields=[],this.Filters=null,this.ItemCount=0,this.Clone=function(){for(var e=new soby_CamlBuilder(this.ActionName,this.ViewName,this.RowLimit,this.WebUrl),t=0;t<this.SchemaFields.length;t++){var i=this.SchemaFields[t];e.AddViewField(i.FieldName,i.PropertyName,i.FieldType,i.DisplayName,i.IsVisible,i.DisplayFunction)}for(t=0;t<this.OrderByFields.length;t++){var s=this.OrderByFields[t];e.AddOrderField(s.FieldName,s.IsAsc)}return e.Filters=this.Filters.Clone(),e},this.GetViewField=function(e){for(var t=0;t<this.SchemaFields.length;t++)if(this.SchemaFields[t].FieldName===e)return this.SchemaFields[t];return null},this.GetViewFieldByPropertyName=function(e){for(var t=0;t<this.SchemaFields.length;t++)if(this.SchemaFields[t].PropertyName===e)return this.SchemaFields[t];return null},this.AddViewField=function(e,t,i){this.SchemaFields[this.SchemaFields.length]={FieldName:e,PropertyName:t,FieldType:i}},this.AddOrderField=function(e,t){this.OrderByFields[this.OrderByFields.length]={FieldName:e,IsAsc:t}},this.GetPagingQuery=function(){return null!=this.NextPageString&&""!=this.NextPageString?'<Paging ListItemCollectionPositionNext="'+this.NextPageString.replace(/&/gi,"&amp;")+'" />':""},this.GetViewFieldsQuery=function(){for(var e="",t=0;t<this.SchemaFields.length;t++)e+="<FieldRef Name='"+this.SchemaFields[t].FieldName+"' />";return e=""!=e?'<ViewFields xmlns="">'+e+"</ViewFields>":e},this.GetOrderByFieldsQuery=function(){for(var e="",t=0;t<this.OrderByFields.length;t++)e+="<FieldRef Name='"+this.OrderByFields[t].FieldName+"'  Ascending='"+(!0===this.OrderByFields[t].IsAsc?"TRUE":"FALSE")+"' />";return e=""!=e?"<OrderBy>"+e+"</OrderBy>":e},this.GetWhereQuery=function(){var e="";return e=null!=this.Filters?"<Where>"+this.Filters.ToCaml()+"</Where>":e},this.GetMainQuery=function(){return"<soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' \t\t\t\t\t      xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'> \t\t\t\t\t      <soap:Body> \t\t\t\t\t        <GetListItems xmlns='http://schemas.microsoft.com/sharepoint/soap/'> \t\t\t\t\t          <listName>"+this.ActionName+"</listName> \t\t\t\t\t          <viewName>"+this.ViewName+"</viewName> \t\t\t\t\t          <query><Query>"+this.GetWhereQuery()+this.GetOrderByFieldsQuery()+"</Query></query> \t\t\t\t\t          <viewFields>"+this.GetViewFieldsQuery()+"</viewFields> \t\t\t\t\t          <rowLimit>"+this.RowLimit+"</rowLimit> \t\t\t\t\t          <queryOptions><QueryOptions xmlns=''><IncludeMandatoryColumns>FALSE</IncludeMandatoryColumns><ViewAttributes Scope='RecursiveAll'/>"+this.GetPagingQuery()+"</QueryOptions></queryOptions> \t\t\t\t\t        </GetListItems> \t\t\t\t\t      </soap:Body> \t\t\t\t\t    </soap:Envelope>"},this.ParseData=function(e){var l=[],h=this.ViewFields,t=$(e.responseText);this.ItemCount=parseInt(t.find("rs\\:data, data").attr("ItemCount"));e=t.find("rs\\:data, data").attr("ListItemCollectionPositionNext");return this.NextPageString=""!=e&&null!=e?e:null,t.find("z\\:row, row").each(function(){for(var s=new Object,e=0;e<h.length;e++){var t=h[e].PropertyName,i=$(this).attr("ows_"+h[e].FieldName);switch(h[e].FieldType){case SobyFieldTypes.Lookup:var a=[];if(""!=i&&null!=i)for(var o=i.split(";#"),n=0;n<o.length;n+=2){var r={ID:o[n],DisplayName:o[n+1]};a[a.length]=r}s[t]=a;break;case SobyFieldTypes.MultiChoice:a=[];if(""!=i&&null!=i)for(o=i.split(";#"),n=0;n<o.length;n++)0!==n&&n!==o.length-1&&(a[a.length]=o[n]);s[t]=a;break;case SobyFieldTypes.Boolean:s[t]="1"===i;break;case SobyFieldTypes.DateTime:""!=i&&null!=i&&(s[t]=soby_DateFromISO(i));break;default:s[t]=null===i?"":i}}0===h.length&&$.each(this.attributes,function(e,t){var i=t.name.substring(4),t=t.value;s[i]=t}),l[l.length]=s}),l}}var sobySPListsObject=function(){function e(){}return e.prototype.ApproveListItem=function(e,t,i,s){$.ajax({async:!1,url:e+"/_vti_bin/lists.asmx",beforeSend:function(e){e.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/UpdateListItems")},type:"POST",dataType:"xml",data:'<?xml version="1.0" encoding="utf-8"?>                     <soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance/"                         xmlns:xsd="http://www.w3.org/2001/XMLSchema/"                         xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">                       <soap:Body>                         <UpdateListItems xmlns="http://schemas.microsoft.com/sharepoint/soap/">                           <listName>'+t+"</listName>                           <updates>                             "+('<Batch OnError="Continue">                         <Method ID="1" Cmd="Moderate">                             <Field Name="ID">'+i+'</Field>                             <Field Name="_ModerationStatus">0</Field>                                                              </Method>                     </Batch>')+"</updates>                         </UpdateListItems>                       </soap:Body>                     </soap:Envelope>",complete:function(e){null!=s&&s()},success:function(e,t,i){soby_LogMessage(e)},error:function(e,t,i){soby_LogMessage(e)},contentType:"text/xml; charset=utf-8"})},e.prototype.DeleteFile=function(e,t,i,s,a){$.ajax({url:e+"/_api/web/GetFileByServerRelativeUrl('"+t+"')",type:"POST",headers:{accept:"application/json;odata=verbose","content-type":"application/json;odata=verbose","X-RequestDigest":$("#__REQUESTDIGEST").val(),"X-HTTP-Method":"DELETE","IF-MATCH":"*"},success:function(){null!=s&&s(i)},error:function(){null!=a&&a(i)}})},e.prototype.DeleteItem=function(e,t,i,s,a,o){e=new SP.ClientContext(e);e.get_web().get_lists().getByTitle(t).getItemById(i).deleteObject(),e.executeQueryAsync(Function.createDelegate(this,function(){null!=s&&s(o)}),Function.createDelegate(this,function(){null!=a&&a(o)}))},e.prototype.RecycleFile=function(e,t,i,s,a){$.ajax({url:e+"/_api/web/GetFileByServerRelativeUrl('"+t+"')/recycle()",type:"POST",headers:{accept:"application/json;odata=verbose","content-type":"application/json;odata=verbose","X-RequestDigest":$("#__REQUESTDIGEST").val(),"IF-MATCH":"*"},success:function(){null!=s&&s(i)},error:function(){null!=a&&a(i)}})},e.prototype.GetListProperties=function(e,t,i){soby.SPLibrary.GetData("<soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'> \t\t\t\t\t<soap:Body> \t\t\t\t\t <GetList xmlns='http://schemas.microsoft.com/sharepoint/soap/'> \t\t\t\t\t \t<listName>"+t+"</listName> \t\t\t\t \t </GetList> \t\t\t\t \t</soap:Body> \t\t\t\t   </soap:Envelope>",function(e){var t=null,e=$(e.responseText).find("List");0<e.length?((t=new Object).ID=$(e[0]).attr("id"),i(t)):i(null)},function(e,t,i){soby_LogMessage(i)},function(e,t,i){},!0,e,null)},e.prototype.GetListItem=function(e,t,i,s,a){var o=new SP.ClientContext(e),e=o.get_web().get_lists().getByTitle(t),t=new SP.CamlQuery;t.set_viewXml("<View><Query><Where><Geq><FieldRef Name='ID'/><Value Type='Number'>"+i+"</Value></Geq></Where></Query><RowLimit>1</RowLimit></View>");var n=e.getItems(t);o.load(n),o.executeQueryAsync(Function.createDelegate(this,function(){0<n.get_count()?s(n.getItemAtIndex(0)):s(null)}),Function.createDelegate(this,function(){}))},e.prototype.UpdateList=function(e,t,i,s,a){for(var o="<List ",n=0;n<i.length;n++)o+=i[n].Key+'="'+i[n].Value+'" ';o+="></List>",$.ajax({url:e+"/_vti_bin/Lists.asmx",beforeSend:function(e){e.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/UpdateList")},type:"POST",dataType:"xml",data:"<soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'> \t\t\t\t\t<soap:Body> \t\t\t\t\t    <UpdateList xmlns=\"http://schemas.microsoft.com/sharepoint/soap/\"> \t\t\t\t\t\t  <listName>"+t+"</listName> \t\t\t\t\t\t  <listProperties>"+o+"</listProperties> \t\t\t\t\t\t</UpdateList> \t\t\t\t\t</soap:Body> \t\t\t\t</soap:Envelope>",complete:function(e,t){soby_LogMessage(e.responseText),null!=s&&s(a)},error:function(e,t,i){soby_LogMessage(e),soby_LogMessage(t),soby_LogMessage(i)},contentType:'text/xml; charset="utf-8"'})},e.prototype.UpdateItem=function(e,t,i,s,a,o,n,r){var l='<Batch OnError="Continue">';l+=null!=i&&""!=i?'<Method ID="'+i+'" Cmd="Update">':'<Method ID="1" Cmd="New">',null!=i&&""!=i&&(s[s.length]={FieldName:"ID",Value:i});for(var h=0;h<s.length;h++)l+='<Field Name="'+s[h].FieldName+'"><![CDATA['+s[h].Value+"]]></Field>";t='<?xml version="1.0" encoding="utf-8"?>         <soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance/"             xmlns:xsd="http://www.w3.org/2001/XMLSchema/"             xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">           <soap:Body>             <UpdateListItems xmlns="http://schemas.microsoft.com/sharepoint/soap/">               <listName>'+t+"</listName>               <updates>                 "+(l+="</Method></Batch>")+"</updates>             </UpdateListItems>           </soap:Body>         </soap:Envelope>";soby_LogMessage(t),null!==n&&""!==n||(n=!0),$.ajax({async:n,url:e+"/_vti_bin/lists.asmx",beforeSend:function(e){e.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/UpdateListItems")},type:"POST",dataType:"xml",data:t,complete:function(e){},error:function(e,t,i){soby_LogMessage("An error occured on UpdateItem"),soby_LogMessage(e),soby_LogMessage(t),soby_LogMessage(i),null!=o&&o(r)},success:function(e){e=$(e).find("z\\:row, row").attr("ows_ID");null!=a&&a(e,r)},contentType:"text/xml; charset=utf-8"})},e.prototype.UploadFile=function(e,t,i,s,a,o,n){for(var r="",l=0;l<s.length;l++)r+="<FieldInformation Type='"+s[l].Type+"' Value='"+s[l].Value+"' ",null!=s[l].InternalName?r+=" InternalName='"+s[l].InternalName+"'":r+=" DisplayName='"+s[l].DisplayName+"'",r+=" />";i="<soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'>         <soap:Body>            <CopyIntoItemsLocal xmlns='http://schemas.microsoft.com/sharepoint/soap/'>                <SourceUrl><![CDATA["+t.trim()+"]]></SourceUrl>                    <DestinationUrls>                        <string><![CDATA["+i.trim()+"]]></string>                    </DestinationUrls>                    <Fields>                    "+r+"                     </Fields>            </CopyIntoItemsLocal>        </soap:Body>    </soap:Envelope>";soby_LogMessage(i),null===n&&(n=!0),$.ajax({async:n,url:e+"/_vti_bin/copy.asmx",beforeSend:function(e){e.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/CopyIntoItemsLocal")},type:"POST",dataType:"xml",data:i,complete:function(e,t){soby_LogMessage("Upload result;"),soby_LogMessage(e),soby_LogMessage(t),null!=a&&a(o)},contentType:'text/xml; charset="utf-8"'})},e.prototype.GetLists=function(n,r){$.ajax({async:!1,url:n+"/_vti_bin/lists.asmx",beforeSend:function(e){e.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/GetListCollection")},type:"POST",dataType:"xml",data:'<?xml version="1.0" encoding="utf-8"?>         <soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance/"             xmlns:xsd="http://www.w3.org/2001/XMLSchema/"             xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">           <soap:Body> \t\t     <GetListCollection xmlns="http://schemas.microsoft.com/sharepoint/soap/" />           </soap:Body>     </soap:Envelope>',complete:function(e){for(var t=[],i=$(e.responseText).find("List"),s=0;s<i.length;s++){var a=$(i[s]),o=a.attr("Title"),o={ID:a.attr("ID"),Title:o,Fields:soby.SPLibrary.Lists.GetListFields(n,o)};t[t.length]=o}null!=r&&r(t)},success:function(e,t,i){soby_LogMessage(e)},error:function(e,t,i){soby_LogMessage(e)},contentType:"text/xml; charset=utf-8"})},e.prototype.GetListAndView=function(e,t,i,s){$.ajax({async:!1,url:e+"/_vti_bin/lists.asmx",beforeSend:function(e){e.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/GetListAndView")},type:"POST",dataType:"xml",data:'<?xml version="1.0" encoding="utf-8"?>         <soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance/"             xmlns:xsd="http://www.w3.org/2001/XMLSchema/"             xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">           <soap:Body> \t\t     <GetListAndView xmlns="http://schemas.microsoft.com/sharepoint/soap/" ><listName>'+t+"</listName><viewName>"+i+"</viewName></GetListAndView>           </soap:Body>     </soap:Envelope>",complete:function(e){},success:function(e,t,i){soby_LogMessage(e)},error:function(e,t,i){soby_LogMessage(e)},contentType:"text/xml; charset=utf-8"})},e.prototype.GetListFields=function(e,t){var n=[];return $.ajax({async:!1,url:e+"/_vti_bin/lists.asmx",beforeSend:function(e){e.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/GetList")},type:"POST",dataType:"xml",data:'<?xml version="1.0" encoding="utf-8"?>         <soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance/"             xmlns:xsd="http://www.w3.org/2001/XMLSchema/"             xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">           <soap:Body> \t\t    <GetList xmlns="http://schemas.microsoft.com/sharepoint/soap/"> \t\t      <listName>'+t+"</listName> \t\t    </GetList> \t      </soap:Body> \t    </soap:Envelope>",complete:function(e){for(var t=$(e.responseText).find("Field"),i=0;i<t.length;i++){var s,a,o=$(t[i]);"TRUE"===o.attr("frombasetype")&&"Title"!=o.attr("name")||null!==o.attr("id")&&""!==o.attr("id")&&(s=!1,"TRUE"===o.attr("required")&&(s=!0),a=!1,"TRUE"===o.attr("hidden")&&(a=!0),a={ID:o.attr("id"),InternalName:o.attr("name"),DisplayName:o.attr("displayname"),Type:o.attr("type"),Required:s,Hidden:a},n[n.length]=a)}},success:function(e,t,i){soby_LogMessage(e)},error:function(e,t,i){soby_LogMessage(e)},contentType:"text/xml; charset=utf-8"}),n},e.prototype.CreateList=function(e,t,i){$.ajax({async:!1,url:e+"/_vti_bin/lists.asmx",beforeSend:function(e){e.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/AddList")},type:"POST",dataType:"xml",data:'<?xml version="1.0" encoding="utf-8"?>         <soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance/"             xmlns:xsd="http://www.w3.org/2001/XMLSchema/"             xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">           <soap:Body> \t\t    <AddList xmlns="http://schemas.microsoft.com/sharepoint/soap/"> \t\t      <listName>'+t+"</listName> \t\t      <description>"+t+"</description> \t\t      <templateID>"+i+"</templateID> \t\t    </AddList> \t      </soap:Body> \t    </soap:Envelope>",complete:function(e){$(e.responseText)},success:function(e,t,i){soby_LogMessage(e)},error:function(e,t,i){soby_LogMessage(e)},contentType:"text/xml; charset=utf-8"})},e.prototype.DeleteList=function(e,t){$.ajax({async:!1,url:e+"/_vti_bin/lists.asmx",beforeSend:function(e){e.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/AddList")},type:"POST",dataType:"xml",data:'<?xml version="1.0" encoding="utf-8"?>         <soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance/"             xmlns:xsd="http://www.w3.org/2001/XMLSchema/"             xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">           <soap:Body> \t\t    <DeleteList xmlns="http://schemas.microsoft.com/sharepoint/soap/"> \t\t      <listName>'+t+"</listName> \t\t    </DeleteList> \t      </soap:Body> \t    </soap:Envelope>",complete:function(e){$(e.responseText)},success:function(e,t,i){soby_LogMessage(e)},error:function(e,t,i){soby_LogMessage(e)},contentType:"text/xml; charset=utf-8"})},e.prototype.CheckOutFile=function(e,t,i,s,a){null===a&&(a=!0),$.ajax({async:a,url:e+"/_vti_bin/lists.asmx",beforeSend:function(e){e.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/CheckOutFile")},type:"POST",dataType:"xml",data:'<?xml version="1.0" encoding="utf-8"?>         <soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance/"             xmlns:xsd="http://www.w3.org/2001/XMLSchema/"             xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">           <soap:Body>             <CheckOutFile xmlns="http://schemas.microsoft.com/sharepoint/soap/">               <pageUrl>'+t+"</pageUrl>             </CheckOutFile>           </soap:Body>         </soap:Envelope>",complete:function(e){e=$(e.responseText).find("CheckOutFileResult").text();null!=i&&i("true"===e?!0:!1,s)},success:function(e,t,i){soby_LogMessage(e)},error:function(e,t,i){soby_LogMessage(e)},contentType:"text/xml; charset=utf-8"})},e.prototype.CheckInFile=function(e,t,i,s,a,o,n){null===n&&(n=!0),$.ajax({async:n,url:e+"/_vti_bin/lists.asmx",beforeSend:function(e){e.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/CheckInFile")},type:"POST",dataType:"xml",data:'<?xml version="1.0" encoding="utf-8"?>         <soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance/"             xmlns:xsd="http://www.w3.org/2001/XMLSchema/"             xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">           <soap:Body>             <CheckInFile xmlns="http://schemas.microsoft.com/sharepoint/soap/">               <pageUrl>'+t+"</pageUrl>               <comment>"+i+"</comment>               <CheckinType>"+s+"</CheckinType>             </CheckInFile>           </soap:Body>         </soap:Envelope>",complete:function(e){null!=a&&a(o)},success:function(e,t,i){soby_LogMessage(e)},error:function(e,t,i){soby_LogMessage(e)},contentType:"text/xml; charset=utf-8"})},e.prototype.UpdateFieldsToList=function(e,t,i,s,a,o){for(var n="",r=0;r<s.length;r++){var l="<Field "+(!1===soby_IsNullOrEmpty(s[r].ID)?" ID='"+s[r].ID+"'":"")+" DisplayName='"+(!0===e?s[r].InternalName:s[r].DisplayName)+"' Name='"+s[r].InternalName+"' ";if("User"===s[r].Type&&!0===s[r].Mult?l+=" Type='UserMulti'":"Lookup"===s[r].Type?l+=" Type='Lookup' List='"+s[r].LookupList+"' "+(!1===soby_IsNullOrEmpty(s[r].FieldRef)?" FieldRef='"+s[r].FieldRef+"'":"")+(!1===soby_IsNullOrEmpty(s[r].ShowField)?" ShowField='"+s[r].ShowField+"'":"")+(!1===soby_IsNullOrEmpty(s[r].Mult)?" Mult='"+s[r].Mult+"'":""):l+=" Type='"+s[r].Type+"'",!0===s[r].Hidden&&(l+=" Hidden='TRUE'"),!0===s[r].Required&&(l+=" Required='TRUE'"),"Choice"===s[r].Type||"MultiChoice"===s[r].Type){l+="><CHOICES>";for(var h=0;h<s[r].Choices.length;h++)l+="<CHOICE>"+s[r].Choices[h]+"</CHOICE>";l+="</CHOICES>",null!=s[r].DefaultValue&&""!=s[r].DefaultValue&&(l+="<Default>"+s[r].DefaultValue+"</Default>"),l+="</Field>"}else"URL"===s[r].Type?l+=" Format='Hyperlink' />":"Note"===s[r].Type?l+=" NumLines='6' AppendOnly='FALSE' RichText='FALSE' />":"User"===s[r].Type?(s[r].Mult,l+=" UserSelectionMode='PeopleOnly' UserSelectionScope='0' Mult='TRUE' />"):l+=" />";n+='<Method ID="'+r+'">'+l+"</Method>"}var n="<Fields>"+n+"</Fields>",d="",c="";!0===e?d="<newFields>"+n+"</newFields>":c="<updateFields>"+n+"</updateFields>",$.ajax({async:!1,url:t+"/_vti_bin/lists.asmx",beforeSend:function(e){e.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/UpdateList")},type:"POST",dataType:"xml",data:"<soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'> \t\t\t\t\t<soap:Body> \t\t\t\t\t\t <UpdateList xmlns=\"http://schemas.microsoft.com/sharepoint/soap/\"> \t\t\t\t\t\t\t  <listName>"+i+"</listName> \t\t\t\t\t\t\t  <listProperties></listProperties> \t\t\t\t\t\t\t  "+d+" \t\t\t\t\t\t\t  "+c+" \t\t\t\t\t\t</UpdateList> \t\t\t\t \t</soap:Body> \t\t\t\t   </soap:Envelope>",complete:function(e){$(e.responseText)},success:function(e,t,i){},error:function(e,t,i){soby_LogMessage(e)},contentType:"text/xml; charset=utf-8"}),null!=a&&a()},e.prototype.GetListItemAttachments=function(e,a,o,t){soby.SPLibrary.GetData("<soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'> \t\t\t\t\t<soap:Body> \t\t\t\t\t <GetAttachmentCollection xmlns='http://schemas.microsoft.com/sharepoint/soap/'> \t\t\t\t\t \t<listName>"+e+"</listName> \t\t\t\t\t \t<listItemID>"+a+"</listItemID> \t\t\t\t \t </GetAttachmentCollection> \t\t\t\t \t</soap:Body> \t\t\t\t   </soap:Envelope>",function(e){for(var t=$(e.responseText).find("Attachment"),i=[],s=0;s<t.length;s++)i[i.length]=$(t[s]).text();o(a,i)},function(e,t,i){soby_LogMessage(i)},function(e,t,i){},!0,t,null)},e}(),sobySPUserGroupObject=function(){function e(){}return e.prototype.GetGroupInfo=function(e,t,i,s,a){null===s&&(s=!0),$.ajax({async:s,url:e+"/_vti_bin/usergroup.asmx",beforeSend:function(e){e.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/directory/GetGroupInfo")},type:"POST",dataType:"xml",data:"<soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'> \t\t\t\t\t<soap:Body> \t\t\t\t\t    <GetGroupInfo xmlns='http://schemas.microsoft.com/sharepoint/soap/directory/'> \t\t\t\t\t      <groupName>"+t+"</groupName>  \t\t\t\t\t   </GetGroupInfo > \t\t\t\t \t</soap:Body> \t\t\t\t   </soap:Envelope>",complete:function(e){e=$(e.responseText).find("Group").attr("ID");null!=i&&i(e,a)},success:function(e,t,i){},error:function(e,t,i){soby_LogMessage(e)},contentType:"text/xml; charset=utf-8"})},e.prototype.CheckGroupContainsUser=function(e,t,a,o,i){null===i&&(i=!0),$.ajax({async:i,url:e+"/_vti_bin/usergroup.asmx",beforeSend:function(e){e.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/directory/GetUserCollectionFromGroup")},type:"POST",dataType:"xml",data:"<soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'> \t\t\t\t\t<soap:Body> \t\t\t\t\t    <GetUserCollectionFromGroup xmlns='http://schemas.microsoft.com/sharepoint/soap/directory/'> \t\t\t\t\t      <groupName>"+t+"</groupName>  \t\t\t\t\t   </GetUserCollectionFromGroup> \t\t\t\t \t</soap:Body> \t\t\t\t   </soap:Envelope>",complete:function(e){for(var t=$(e.responseText).find("User"),i=!1,s=0;s<t.length;s++)$(t[s]).attr("id")===a&&(i=!0);null!=o&&o(i)},success:function(e,t,i){},error:function(e,t,i){soby_LogMessage(e)},contentType:"text/xml; charset=utf-8"})},e.prototype.CheckUserRolesAndPermissions=function(e,t){$.ajax({async:!0,url:e+"/_vti_bin/usergroup.asmx",beforeSend:function(e){e.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/directory/GetRolesAndPermissionsForCurrentUser ")},type:"POST",dataType:"xml",data:"<soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'> \t\t\t\t\t<soap:Body> \t\t\t\t\t    <GetRolesAndPermissionsForCurrentUser xmlns='http://schemas.microsoft.com/sharepoint/soap/directory/'></GetRolesAndPermissionsForCurrentUser > \t\t\t\t \t</soap:Body> \t\t\t\t   </soap:Envelope>",complete:function(e){$(e.responseText);e=parseInt($(e.responseText).find("Permissions").attr("Value"));null!=t&&t(0<e?!0:!1)},success:function(e,t,i){},error:function(e,t,i){soby_LogMessage(e)},contentType:"text/xml; charset=utf-8"})},e.prototype.GetRolesAndPermissionsForCurrentUser=function(e,r){$.ajax({async:!0,url:e+"/_vti_bin/UserGroup.asmx",beforeSend:function(e){e.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/directory/GetRolesAndPermissionsForCurrentUser")},type:"POST",dataType:"xml",data:"<soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'> \t\t\t\t\t<soap:Body> \t\t\t\t\t    <GetRolesAndPermissionsForCurrentUser xmlns=\"http://schemas.microsoft.com/sharepoint/soap/directory/\" /> \t\t\t\t \t</soap:Body> \t\t\t\t   </soap:Envelope>",complete:function(e){for(var t=[],i=$(e.responseText).find("Role"),s=0;s<i.length;s++){var a=$(i[s]).attr("ID"),o=$(i[s]).attr("Name"),n=$(i[s]).attr("Type");t[t.length]={ID:a,Name:o,Type:n}}r(t)},success:function(e,t,i){},error:function(e,t,i){soby_LogMessage(e)},contentType:"text/xml; charset=utf-8"})},e}(),sobySPWebsObject=function(){function e(){}return e.prototype.GetSites=function(n,r){$.ajax({async:!0,url:n+"/_vti_bin/webs.asmx",beforeSend:function(e){e.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/GetWebCollection")},type:"POST",dataType:"xml",data:"<soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'> \t\t\t\t\t<soap:Body> \t\t\t\t\t    <GetWebCollection xmlns='http://schemas.microsoft.com/sharepoint/soap/directory/'>  \t\t\t\t\t   </GetWebCollection> \t\t\t\t \t</soap:Body> \t\t\t\t   </soap:Envelope>",complete:function(e){for(var t=[],i=$(e.responseText).find("Web"),s=0;s<i.length;s++){var a=$(i[s]).attr("Title"),o=$(i[s]).attr("Url");t[t.length]={Title:a,Url:o}}r(n,t)},success:function(e,t,i){},error:function(e,t,i){soby_LogMessage(e)},contentType:"text/xml; charset=utf-8"})},e}(),sobySPSitesObject=function(){function e(){}return e.prototype.CreateSubSite=function(e,t,i,s,a){$.ajax({url:e+"/_vti_bin/Sites.asmx",beforeSend:function(e){e.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/CreateWeb")},type:"POST",dataType:"xml",data:"<soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'> \t\t\t\t\t<soap:Body> \t\t\t\t\t\t<CreateWeb xmlns=\"http://schemas.microsoft.com/sharepoint/soap/\"> \t\t\t\t\t\t  <url><![CDATA["+t+"]]></url> \t\t\t\t\t\t  <title><![CDATA["+i+"]]></title> \t\t\t\t\t\t  <description><![CDATA["+i+"]]></description> \t\t\t\t\t\t  <templateName>STS#0</templateName> \t\t\t\t\t\t  <language>1033</language> \t\t\t\t\t\t  <locale>1033</locale> \t\t\t\t\t\t  <collationLocale>1033</collationLocale> \t\t\t\t\t\t  <uniquePermissions>1</uniquePermissions> \t\t\t\t\t\t  <anonymous>1</anonymous> \t\t\t\t\t\t  <presence>1</presence> \t\t\t\t\t\t</CreateWeb> \t\t\t\t\t</soap:Body> \t\t\t\t</soap:Envelope>",complete:function(e,t){null!=s&&s(a)},error:function(e,t,i){soby_LogMessage(e),soby_LogMessage(t),soby_LogMessage(i)},contentType:'text/xml; charset="utf-8"'})},e}(),sobySPViewsObject=function(){function e(){}return e.prototype.GetViews=function(e,t,o){$.ajax({async:!1,url:e+"/_vti_bin/views.asmx",beforeSend:function(e){e.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/GetViewCollection")},type:"POST",dataType:"xml",data:'<?xml version="1.0" encoding="utf-8"?>         <soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance/"             xmlns:xsd="http://www.w3.org/2001/XMLSchema/"             xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">           <soap:Body> \t\t     <GetViewCollection xmlns="http://schemas.microsoft.com/sharepoint/soap/" ><listName>'+t+"</listName></GetViewCollection>           </soap:Body>     </soap:Envelope>",complete:function(e){for(var t=[],i=$(e.responseText).find("View"),s=0;s<i.length;s++){var a=$(i[s]),a={ID:a.attr("Name"),Title:a.attr("DisplayName"),Url:a.attr("Url")};t[t.length]=a}null!=o&&o(t)},success:function(e,t,i){soby_LogMessage(e)},error:function(e,t,i){soby_LogMessage(e)},contentType:"text/xml; charset=utf-8"})},e}(),sobySPWebPartPagesObject=function(){function e(){}return e.prototype.AddContentEditorWebPart=function(e,t,i,s,a){for(var o="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-16&quot;?&gt;&lt;WebPart xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns=&quot;http://schemas.microsoft.com/WebPart/v2&quot;&gt;&lt;Title&gt;Custom Part&lt;/Title&gt;&lt;FrameType&gt;None&lt;/FrameType&gt;&lt;Description&gt;Use for formatted text, tables, and images.&lt;/Description&gt;&lt;IsIncluded&gt;true&lt;/IsIncluded&gt;&lt;ZoneID&gt;Left&lt;/ZoneID&gt; &lt;PartOrder&gt;6&lt;/PartOrder&gt;&lt;FrameState&gt;Normal&lt;/FrameState&gt;&lt;Height /&gt;&lt;Width /&gt; &lt;AllowRemove&gt;true&lt;/AllowRemove&gt;&lt;AllowZoneChange&gt;true&lt;/AllowZoneChange&gt;&lt;AllowMinimize&gt;true&lt;/AllowMinimize&gt;&lt;IsVisible&gt;true&lt;/IsVisible&gt;&lt;DetailLink /&gt;&lt;HelpLink /&gt;&lt;Dir&gt;Default&lt;/Dir&gt;&lt;PartImageSmall /&gt;&lt;MissingAssembly /&gt;&lt;PartImageLarge&gt;/_layouts/images/mscontl.gif&lt;/PartImageLarge&gt;&lt;IsIncludedFilter /&gt;&lt;Assembly&gt;Microsoft.SharePoint, Version=12.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c&lt;/Assembly&gt;&lt;TypeName&gt;Microsoft.SharePoint.WebPartPages.ContentEditorWebPart&lt;/TypeName&gt;",n=0;n<i.length;n++){var r=i[n].Value.replace(/</gi,"&lt;").replace(/>/gi,"&gt;").replace(/\"/gi,"&quot;");o+="&lt;"+i[n].Key+" xmlns=&quot;http://schemas.microsoft.com/WebPart/v2/ContentEditor&quot;&gt;"+r+"&lt;/"+i[n].Key+"&gt;"}o+="&lt;Content xmlns=&quot;http://schemas.microsoft.com/WebPart/v2/ContentEditor&quot; /&gt;",o+=" &lt;PartStorage xmlns=&quot;http://schemas.microsoft.com/WebPart/v2/ContentEditor&quot; /&gt;&lt;/WebPart&gt;",$.ajax({url:e+"/_vti_bin/WebPartPages.asmx",beforeSend:function(e){e.setRequestHeader("SOAPAction","http://microsoft.com/sharepoint/webpartpages/AddWebPart")},type:"POST",dataType:"xml",data:"<soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'> \t\t\t\t\t<soap:Body> \t\t\t\t\t <AddWebPart xmlns=\"http://microsoft.com/sharepoint/webpartpages\"> \t\t\t\t\t\t  <pageUrl>"+t+"</pageUrl> \t\t\t\t\t\t  <webPartXml>"+o+"</webPartXml> \t\t\t\t\t\t  <storage>Shared</storage> \t\t\t\t\t</AddWebPart> \t\t\t\t\t</soap:Body> \t\t\t\t</soap:Envelope>",complete:function(e,t){null!=s&&s(a)},error:function(e,t,i){soby_LogMessage(e),soby_LogMessage(t),soby_LogMessage(i)},contentType:'text/xml; charset="utf-8"'})},e}(),sobySPVersionsObject=function(){function e(){}return e.prototype.GetVersions=function(e,t,i){$.ajax({async:!1,url:e+"/_vti_bin/versions.asmx",beforeSend:function(e){e.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/GetVersions")},type:"POST",dataType:"xml",data:'<?xml version="1.0" encoding="utf-8"?>         <soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance/"             xmlns:xsd="http://www.w3.org/2001/XMLSchema/"             xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">           <soap:Body>             <GetVersions xmlns="http://schemas.microsoft.com/sharepoint/soap/">               <fileName><![CDATA['+t+"]]></fileName>             </GetVersions>           </soap:Body>         </soap:Envelope>",complete:function(e){null!=i&&i(e)},success:function(e,t,i){soby_LogMessage(e)},error:function(e,t,i){soby_LogMessage(e)},contentType:"text/xml; charset=utf-8"})},e.prototype.GetVersionCollection=function(e,t,i,s,a){$.ajax({async:!1,url:e+"/_vti_bin/lists.asmx",beforeSend:function(e){e.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/GetVersionCollection")},type:"POST",dataType:"xml",data:'<?xml version="1.0" encoding="utf-8"?>         <soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance/"             xmlns:xsd="http://www.w3.org/2001/XMLSchema/"             xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">           <soap:Body>             <GetVersionCollection xmlns="http://schemas.microsoft.com/sharepoint/soap/">               <strlistID><![CDATA['+t+"]]></strlistID>               <strlistItemID><![CDATA["+i+"]]></strlistItemID>               <strFieldName><![CDATA["+s+"]]></strFieldName>             </GetVersionCollection>           </soap:Body>         </soap:Envelope>",complete:function(e){null!=a&&a(e)},success:function(e,t,i){soby_LogMessage(e)},error:function(e,t,i){soby_LogMessage(e)},contentType:"text/xml; charset=utf-8"})},e}(),sobySPWorkflowsObject=function(){function e(){}return e.prototype.StartWorkFlow=function(e,t,i,s,a){for(var o="",n=0;n<s.length;n++)o+="<"+s[n].Name+">"+s[n].Value+"</"+s[n].Name+">";$.ajax({url:e+"/_vti_bin/workflow.asmx",beforeSend:function(e){e.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/workflow/StartWorkflow")},type:"POST",dataType:"xml",data:'<?xml version="1.0" encoding="utf-8"?>         <soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"             xmlns:xsd="http://www.w3.org/2001/XMLSchema"             xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">           <soap:Body>             <StartWorkflow xmlns="http://schemas.microsoft.com/sharepoint/soap/workflow/">                 <item>'+t+"</item>                 <templateId>"+i+"</templateId>                 <workflowParameters><Data>"+o+"</Data></workflowParameters>             </StartWorkflow>           </soap:Body>         </soap:Envelope>",complete:function(e){null!=a&&a()},error:function(e,t,i){soby_LogMessage("An error occured on StartWorkFlow"),soby_LogMessage(t),soby_LogMessage(i)},contentType:"text/xml; charset=utf-8"})},e}(),sobySPLibraryObject=function(){this.GetData=function(e,t,s,a,i,o,n){var r="/_vti_bin/Lists.asmx",r=null!=o&&""!=o?o+"/_vti_bin/Lists.asmx":"/_vti_bin/Lists.asmx";$.ajax({async:null==i||i,url:r,type:"POST",dataType:"xml",data:e,contentType:'text/xml; charset="utf-8"',complete:function(e){t&&t(e,n)},error:function(e,t,i){s&&s(e,t,i)},success:function(e,t,i){a&&a(e,t,i,n)}})},this.Lists=new sobySPListsObject,this.UserGroup=new sobySPUserGroupObject,this.Webs=new sobySPWebsObject,this.Sites=new sobySPSitesObject,this.Views=new sobySPViewsObject,this.WebPartPages=new sobySPWebPartPagesObject,this.Versions=new sobySPVersionsObject,this.Workflows=new sobySPWorkflowsObject},sobyObject=function(){this.SPLibrary=new sobySPLibraryObject},soby=new sobyObject,__extends=this&&this.__extends||function(){var s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)};return function(e,t){function i(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),testObj=null,soby_EditControls=[],SobyListItem=function(e,t){this.Value=e,this.Text=t},SobyTextBox=function(){function e(e,t,i){this.ContainerClientId=e,this.FieldType=t,this.Args=i}return e.prototype.PopulateChoiceItems=function(){},e.prototype.GetValue=function(){var e=$("#"+this.ContainerClientId+" input.sobytextbox").val().toString();return this.FieldType===SobyFieldTypes.Number&&(e=parseInt(e),!0===isNaN(e)&&(e=null)),e},e.prototype.SetValue=function(e){$("#"+this.ContainerClientId+" input.sobytextbox").val(e)},e.prototype.Initialize=function(){var e=$("<input type='textbox' class='sobytextbox'>");$("#"+this.ContainerClientId).html(""),null!==this.ItemClassName&&""!==this.ItemClassName&&e.addClass(this.ItemClassName),$("#"+this.ContainerClientId).append(e),(soby_EditControls[this.ContainerClientId]=this).Initialized()},e.prototype.Initialized=function(){},e.prototype.ValueBeingChanged=function(){},e.prototype.ValueChanged=function(){},e.prototype.Validate=function(){return!0},e}(),SobyLookupSelectBox=function(){function e(e,t,i){if(this.DataService=null,this.ValueFieldName=null,this.TitleFieldName=null,this.EmptyText="Please Select",this.ShowEmptyOption=!1,this.ContainerClientId=e,this.FieldType=t,this.Args=i,null!==(soby_EditControls[this.ContainerClientId]=this).Args){this.ValueFieldName=this.Args.ValueFieldName,this.TitleFieldName=this.Args.TitleFieldName;i=this.Args.ReadTransport;if(null!=i){var s=new soby_WSBuilder;if(s.Filters=new SobyFilters(!1),s.AddSchemaField(this.Args.ValueFieldName,SobyFieldTypes.Text,null),s.AddSchemaField(this.Args.TitleFieldName,SobyFieldTypes.Text,null),null!==this.Args.AdditionalReadFields&&void 0!==this.Args.AdditionalReadFields)for(var a=this.Args.AdditionalReadFields.split(","),o=0;o<a.length;o++)s.AddSchemaField(a[o],SobyFieldTypes.Text,null);var n=new soby_WebServiceService(s);n.SetRowLimit(0),n.Transport.Read=new soby_TransportRequest(i.Url,i.DataType,i.ContentType,i.Type),this.DataService=n}else{n=new soby_StaticDataService([new SobySchemaField(this.Args.ValueFieldName,SobyFieldTypes.Text,null),new SobySchemaField(this.Args.TitleFieldName,SobyFieldTypes.Text,null)],this.Args.Items);n.SetRowLimit(0),this.DataService=n}}}return e.prototype.GetValue=function(){if(null===$("#"+this.ContainerClientId+" select.sobylookupselectbox option.listitem:selected"))return null;var e=parseInt($("#"+this.ContainerClientId+" select.sobylookupselectbox option.listitem:selected").attr("itemindex"));return this.ListItems[e]},e.prototype.SetValue=function(e){$("#"+this.ContainerClientId+" select.sobylookupselectbox").val(e)},e.prototype.PopulateChoiceItems=function(){this.ListItems=new Array;var s=this;this.DataService.ItemPopulated=function(e){!0===s.ShowEmptyOption&&((t=new SobyListItem("",s.EmptyText)).Properties=[],s.ListItems.push(t));for(var t,i=0;i<e.length;i++)(t=new SobyListItem(e[i][s.ValueFieldName],e[i][s.TitleFieldName])).Properties=e[i],s.ListItems.push(t);s.DrawChoiceItems()},this.DataService.PopulateItems(null)},e.prototype.DrawChoiceItems=function(){var e=$("#"+this.ContainerClientId+" select.sobylookupselectbox");e.find("option.listitem").remove();for(var t=0;t<this.ListItems.length;t++){var i=$("<option itemindex='"+t+"' class='listitem'></option>");null!==this.ItemClassName&&""!==this.ItemClassName&&i.addClass(this.ItemClassName),i.attr("value",this.ListItems[t].Value),i.text(this.ListItems[t].Text),e.append(i)}this.Initialized()},e.prototype.Initialize=function(){var e=$("<select class='sobylookupselectbox' onchange=\"soby_EditControls['"+this.ContainerClientId+"'].ValueChanged()\"></select>");$("#"+this.ContainerClientId).html(""),$("#"+this.ContainerClientId).append(e),this.PopulateChoiceItems()},e.prototype.Initialized=function(){},e.prototype.ValueBeingChanged=function(){},e.prototype.ValueChanged=function(){},e.prototype.Validate=function(){return!0},e}(),SobyCheckBoxList=function(){function e(e,t,i){if(this.DataService=null,this.ValueFieldName=null,this.TitleFieldName=null,this.ShowSearchBox=!1,this.SVGImages=new soby_SVGImages,this.ContainerClientId=e,this.FieldType=t,this.Args=i,null!==(soby_EditControls[this.ContainerClientId]=this).Args){this.ValueFieldName=this.Args.ValueFieldName,this.TitleFieldName=this.Args.TitleFieldName;t=this.Args.ReadTransport;if(null!==t){var s=new soby_WSBuilder;if(s.Filters=new SobyFilters(!1),s.AddSchemaField(this.Args.ValueFieldName,SobyFieldTypes.Text,null),s.AddSchemaField(this.Args.TitleFieldName,SobyFieldTypes.Text,null),null!==this.Args.AdditionalReadFields)for(var a=this.Args.AdditionalReadFields.split(","),o=0;o<a.length;o++)s.AddSchemaField(a[o],SobyFieldTypes.Text,null);s.RowLimit=0;i=new soby_WebServiceService(s);i.Transport.Read=new soby_TransportRequest(t.Url,t.DataType,t.ContentType,t.Type),this.DataService=i}}}return e.prototype.GetValue=function(){var e,t=[];!0!==this.ShowSearchBox||null!=(e=$("#"+this.ContainerClientId+" .sobycheckboxlist-searchbox").val())&&""!==e&&(t[t.length]=e);for(var i=$("#"+this.ContainerClientId+" ul.sobycheckboxlist input:checked"),s=0;s<i.length;s++){var a=parseInt($(i[s]).attr("itemindex"));t[t.length]=this.ListItems[a]}return t},e.prototype.SetValue=function(e){e=e.split(soby_FilterValueSeperator);this.SetArrayValue(e)},e.prototype.SetArrayValue=function(e){if($("#"+this.ContainerClientId+" ul.sobycheckboxlist input:checked").prop("checked",!1),null!==e){for(var t=0;t<e.length;t++)$("#"+this.ContainerClientId+" ul.sobycheckboxlist input[value='"+e[t]+"']").prop("checked",!0);this.SaveState()}},e.prototype.PopulateChoiceItems=function(){var e=$("#"+this.ContainerClientId+" ul.sobycheckboxlist");e.find("li").remove();var t=$("<li></li>");t.append(this.SVGImages.GetLoading()+" Loading..."),e.append(t),this.ListItems=new Array;var s=this;this.DataService.ItemPopulated=function(e){for(var t=0;t<e.length;t++){var i=new SobyListItem(e[t][s.ValueFieldName],e[t][s.TitleFieldName]);i.Properties=e[t],s.ListItems.push(i)}s.DrawChoiceItems()},this.DataService.PopulateItems(null)},e.prototype.DrawChoiceItems=function(){var e=$("#"+this.ContainerClientId+" ul.sobycheckboxlist");e.find("li").remove();for(var t=0;t<this.ListItems.length;t++){var i=$("<li></li>"),s=soby_guid(),a=$("<input type='checkbox' id='"+s+"' itemindex='"+t+"' onclick=\"soby_EditControls['"+this.ContainerClientId+"']._ValueChanged("+t+')" />');null!==this.ItemClassName&&""!==this.ItemClassName&&a.addClass(this.ItemClassName),null!==this.SelectedValuesTempState&&-1<$.inArray(this.ListItems[t].Value,this.SelectedValuesTempState)&&a.prop("checked",!0);s=$("<label for='"+s+"'></label>");a.attr("value",this.ListItems[t].Value),s.text(this.ListItems[t].Text),i.append(a),i.append(s),e.append(i)}this.Initialized(),this.SaveState()},e.prototype.Initialize=function(){$("#"+this.ContainerClientId).html("<ul class='sobycheckboxlist'></ul>"),!0===this.ShowSearchBox&&$("#"+this.ContainerClientId).prepend("<input type='text' class='sobycheckboxlist-searchbox'>"),this.PopulateChoiceItems()},e.prototype.SaveState=function(){this.SelectedValuesTempState=[];for(var e=this.GetValue(),t=0;t<e.length;t++){var i=e[t].Value;this.SelectedValuesTempState[this.SelectedValuesTempState.length]=i}},e.prototype.Initialized=function(){},e.prototype.ValueBeingChanged=function(){},e.prototype.ValueChanged=function(){},e.prototype._ValueChanged=function(e){var t=!1,i=null;null!==e&&(i=this.ListItems[e],0<$("#"+this.ContainerClientId+" ul.sobycheckboxlist input[itemindex='"+e+"']:checked").length&&(t=!0)),this.ListItemStateBeingChanged(i,t),this.ValueBeingChanged(),this.SaveState(),this.ListItemStateChanged(i,t),this.ValueChanged()},e.prototype.Validate=function(){return!0},e.prototype.ListItemStateBeingChanged=function(e,t){},e.prototype.ListItemStateChanged=function(e,t){},e}(),SobySPViewFilterCheckBoxList=function(n){function e(e,t,i,s,a,o){i=n.call(this,e,t,i)||this;return i.WebUrl=s,i.ListName=a,i.FieldName=o,i.ShowSearchBox=!0,i}return __extends(e,n),e.prototype.PopulateChoiceItems=function(){this.ListItems=new Array;var o=this;soby.SPLibrary.Lists.GetListProperties(this.WebUrl,this.ListName,function(e){o.ListId=e.ID,soby.SPLibrary.Views.GetViews(o.WebUrl,o.ListName,function(e){o.ViewId=e[0].ID;var e=o.WebUrl+"/_layouts/15/filter.aspx?ListId="+o.ListId+"&FieldInternalName="+o.FieldName+"&ViewId="+o.ViewId+"&FilterOnly=1&Filter=1",a=$("<div></div>");a.load(e,null,function(e){for(var t=a.find("select option"),i=0;i<t.length;i++){var s=$(t[i]);"(All)"!==s.text()&&(s=new SobyListItem(s.val().toString(),s.text()),o.ListItems.push(s))}o.DrawChoiceItems()})})}),o.DrawChoiceItems()},e}(SobyCheckBoxList),SobySelectBox=function(){function e(e){this.SearchOnDemand=!1,this.AllowMultipleSelections=!0,this.SearchParameterName="",this.PopulateItemsOnRender=!0,this.Items=[],this.TempItems=[],this.SelectedItemKeyValues=null,this.SelectedItemDisplayValues=null,this.EmptyText="Please Select",this.NoRecordsText="No records found",this.DataService=null,this.ValueFieldName=null,this.TitleFieldName=null,this.ThemeName="classic",this.ThemeClassName=this.ThemeName,this.FocusToNextItemAfterItemSelection=!0,this.Width="600px",this.LastSearchKeyword="",this.ShowClearAllButton=!0,this.SVGImages=new soby_SVGImages,this.OnSelectBoxItemsPopulated=null,this.ContainerClientId=e}return e.prototype.SetValue=function(e){for(var t=0;t<this.Items.length;t++)if(this.Items[t][this.ValueFieldName]===e){this.SelectItem(t);break}},e.prototype.SetValueWithTitle=function(e,t){var i=new Object;i[this.ValueFieldName]=e,i[this.TitleFieldName]=t,this.Items.push(i),this.SelectItem(this.Items.length-1)},e.prototype.ChangeTheme=function(e){$(".sobyselectbox").removeClass(this.ThemeClassName),this.ThemeName=e,this.ThemeClassName=e,$(".sobyselectbox").addClass(this.ThemeClassName)},e.prototype.ShowLoadingIcon=function(){$("#"+this.ContainerClientId+" .loadingicon").removeClass("hidden"),$("#"+this.ContainerClientId+" .clearitemslink").addClass("hidden")},e.prototype.HideLoadingIcon=function(){$("#"+this.ContainerClientId+" .loadingicon").addClass("hidden"),null!==this.SelectedItemKeyValues&&1<this.SelectedItemKeyValues.length?$("#"+this.ContainerClientId+" .clearitemslink").removeClass("hidden"):$("#"+this.ContainerClientId+" .clearitemslink").addClass("hidden")},e.prototype.Initialize=function(){var n,i=this;this.SelectedItemKeyValues=[],this.SelectedItemDisplayValues=[],$("#"+this.ContainerClientId).addClass("sobyselectbox"),$("#"+this.ContainerClientId).css("width",this.Width),$("#"+this.ContainerClientId).addClass(this.ThemeClassName),$("#"+this.ContainerClientId).html("<div class='selectionfilterpanel' onclick=\"soby_EditControls['"+this.ContainerClientId+"'].ShowSelectBox()\"><div class='selecteditemsandsearchpanel'><div class='selecteditems'></div></div><div class='additionalcellonexpanderpanel'><span class='loadingicon hidden'>"+this.SVGImages.GetLoading()+"</span>"+(!0===this.ShowClearAllButton?"<a href='javascript:void(0)'  onclick =\"soby_EditControls['"+this.ContainerClientId+'\'].ClearItems()" class="soby-itmHoverEnabled soby-selectboxitem-delete-link clearitemslink hidden">'+this.SVGImages.GetXCircle()+"</a>":"")+"</div><div class='expanderpanel'><a href='javascript:void(0)'  onclick=\"soby_EditControls['"+this.ContainerClientId+"'].ShowHideSelectBox()\">"+this.SVGImages.GetCollapse()+"</a></div></div><div class='selectbox hidden'><div class='searchpanel' style='width:100%'><input type='text' class='searchtextbox' onfocus=\"soby_EditControls['"+this.ContainerClientId+"'].SearchTextBoxFocused()\" onblur=\"soby_EditControls['"+this.ContainerClientId+"'].SearchTextBoxLostFocused()\"><div class='emptytext'></div></div></div><div><div></div>"),$("#"+this.ContainerClientId+" .emptytext").text(this.EmptyText),$("#"+this.ContainerClientId+" .searchtextbox").keyup(function(){var e=$(this).val();i.SearchFromService(e)}),$("#"+this.ContainerClientId+" .searchtextbox").keydown(function(e){switch(e.which){case 8:0===$("#"+i.ContainerClientId+" .searchtextbox")[0].selectionStart&&$("#"+i.ContainerClientId+" .selecteditemsandsearchpanel .selecteditem:last a").click();break;case 40:e.preventDefault(),$("#"+i.ContainerClientId+" .selectbox a:visible:first").focus();break;case 38:e.preventDefault(),$("#"+i.ContainerClientId+" .selectbox a:visible:last").focus();break;case 37:var t=$("#"+i.ContainerClientId+" .searchtextbox").val();null!=t&&""!==t||(e.preventDefault(),$("#"+i.ContainerClientId+" .selecteditemsandsearchpanel .selecteditem:last a").focus())}}),$("body").click(function(e){0===$(e.target).parents("#"+i.ContainerClientId).length&&i.HideSelectBox()}),null!==(soby_EditControls[this.ContainerClientId]=this).DataService&&((n=this).DataService.ItemPopulated=function(e){n.Items=e;var t=$("#"+n.ContainerClientId+" .selectbox");t.find(".soby_dataitem").remove(),0===e.length&&((s=$("<div class='item soby_dataitem soby-itmHoverEnabled'></div>")).text(n.NoRecordsText),t.append(s));for(var i=0;i<e.length;i++){var s=$("<div class='item soby_dataitem soby-itmHoverEnabled'></div>"),a=$("<a href='javascript:void(0)'></a>"),o=e[i][n.TitleFieldName];null===o&&(o=""),s.attr("value",e[i][n.ValueFieldName]),s.attr("title",o),s.attr("itemindex",i),a.text(e[i][n.TitleFieldName]),a.attr("onclick","soby_EditControls['"+n.ContainerClientId+"'].SelectItem("+i+")"),s.append(a),t.append(s),a.keydown(function(e){switch(e.which){case 40:0<$(this).parent().nextAll(":visible:first").length?(e.preventDefault(),$(this).parent().nextAll(":visible:first").find("a").focus()):($("#"+n.ContainerClientId+" .searchtextbox").focus(),$("#"+n.ContainerClientId+" .searchtextbox").select());break;case 38:0<$(this).parent().prevAll(":visible:first").length?(e.preventDefault(),$(this).parent().prevAll(":visible:first").find("a").focus()):($("#"+n.ContainerClientId+" .searchtextbox").focus(),$("#"+n.ContainerClientId+" .searchtextbox").select())}})}n.Initialized(),null!==n.OnSelectBoxItemsPopulated&&n.OnSelectBoxItemsPopulated(),n.HideLoadingIcon()},!0===this.PopulateItemsOnRender&&(this.ShowLoadingIcon(),this.DataService.PopulateItems(null)))},e.prototype.SearchFromService=function(e){this.ShowLoadingIcon();for(var t=this.DataService.DataSourceBuilder.Filters.Filters.length-1;-1<t;t--)this.DataService.DataSourceBuilder.Filters.Filters[t].FieldName===this.SearchParameterName&&this.DataService.DataSourceBuilder.Filters.Filters.splice(t,1);null===e||""===e||this.DataService.DataSourceBuilder.Filters.AddFilter(this.SearchParameterName,e,SobyFieldTypes.Text,SobyFilterTypes.Contains,!1,!0),this.DataService.PopulateItems(null)},e.prototype.SearchFromPopulatedData=function(e){this.LastSearchKeyword!==e&&(this.LastSearchKeyword=e,this.ShowLoadingIcon(),$("#"+this.ContainerClientId+" .soby_dataitem").addClass("hidden"),0===this.SelectedItemKeyValues.length&&""===e?$("#"+this.ContainerClientId+" .emptytext").show():$("#"+this.ContainerClientId+" .emptytext").hide(),(0<e.length?$("#"+this.ContainerClientId+' .soby_dataitem[title*="'+e.toLowerCase()+'" i] '):$("#"+this.ContainerClientId+" .soby_dataitem")).removeClass("hidden"),$(this).css("width",30*e.length+"px"),this.HideLoadingIcon())},e.prototype.SelectItem=function(e){var t=this.Items[e];this.TempItems.push(t);var i=t[this.ValueFieldName],t=t[this.TitleFieldName];!1===this.AllowMultipleSelections&&(this.SelectedItemKeyValues=[],this.SelectedItemDisplayValues=[]),-1===$.inArray(i,this.SelectedItemKeyValues)&&(this.SelectedItemKeyValues.push(i),this.SelectedItemDisplayValues.push(t)),this.PopulateSelectedItems();e=$("#"+this.ContainerClientId+" .selectbox .soby_dataitem[itemindex='"+e+"']");0<e.nextAll(":visible:first").length&&!0===this.FocusToNextItemAfterItemSelection?(event.preventDefault(),e.nextAll(":visible:first").find("a").focus()):0<e.prevAll(":visible:first").length&&!0===this.FocusToNextItemAfterItemSelection?(event.preventDefault(),e.prevAll(":visible:first").find("a").focus()):$("#"+this.ContainerClientId+" .searchtextbox").focus(),this.HideLoadingIcon(),this.ValueChanged(),!1===this.AllowMultipleSelections&&this.HideSelectBox()},e.prototype.PopulateSelectedItems=function(){var t=this;$("#"+this.ContainerClientId+" .soby_dataitem").removeClass("selected");var e=$("#"+this.ContainerClientId+" .searchtextbox").val(),i=$("#"+this.ContainerClientId+" .selecteditems");i.html(""),0===this.SelectedItemKeyValues.length&&""===e?$("#"+this.ContainerClientId+" .emptytext").show():$("#"+this.ContainerClientId+" .emptytext").hide();for(var s=0;s<this.SelectedItemKeyValues.length;s++){for(var a,o,n=this.SelectedItemKeyValues[s],r=null,l=0;l<this.TempItems.length;l++){var h=this.TempItems[l];if(h[this.ValueFieldName]===n){r=h,$("#"+this.ContainerClientId+" .soby_dataitem[itemindex='"+l+"']").addClass("selected");break}}null!==r&&(a=$("<div class='selecteditem'></div>"),o=$("<a href='javascript:void(0)' onclick=\"soby_EditControls['"+this.ContainerClientId+"'].RemoveItem("+s+")\" class='soby-itmHoverEnabled soby-selectboxitem-delete-link'>"+this.SVGImages.GetXCircle()+"</a>"),a.text(r[this.TitleFieldName]+" "),a.append(o),i.append(a),o.keydown(function(e){switch(e.which){case 46:e.preventDefault(),$(this).click();break;case 39:e.preventDefault(),0<$(this).parent().nextAll("div:visible:first").length?(e.preventDefault(),$(this).parent().nextAll("div:visible:first").find("a").focus()):$("#"+t.ContainerClientId+" .searchtextbox").focus();break;case 37:e.preventDefault(),0<$(this).parent().prevAll(":visible:first").length&&(e.preventDefault(),$(this).parent().prevAll(":visible:first").find("a").focus())}}))}var d=$("#"+this.ContainerClientId+" .selectionfilterpanel").position(),e=$("#"+this.ContainerClientId+" .selecteditemsandsearchpanel").height(),e=d.top+(e=e<10?30:e)+5;$("#"+this.ContainerClientId+" .selectbox").css("top",e)},e.prototype.GetSelectedItems=function(){for(var e=[],t=0;t<this.SelectedItemKeyValues.length;t++){for(var i=this.SelectedItemKeyValues[t],s=null,a=0;a<this.TempItems.length;a++){var o=this.TempItems[a];if(o[this.ValueFieldName]===i){s=o;break}}null!==s&&(e[e.length]=s)}return e},e.prototype.RemoveItem=function(e){this.SelectedItemKeyValues.splice(e,1),this.SelectedItemDisplayValues.splice(e,1),this.PopulateSelectedItems();var t=this;setTimeout(function(){t.ShowSelectBox()},500),this.HideLoadingIcon(),this.ValueChanged()},e.prototype.ClearItems=function(e){var t;this.SelectedItemKeyValues=[],this.SelectedItemDisplayValues=[],this.PopulateSelectedItems(),!0===e&&(t=this,setTimeout(function(){t.ShowSelectBox()},500)),this.ValueChanged()},e.prototype.ShowHideSelectBox=function(){var e=this;!0===$("#"+this.ContainerClientId+" .selectbox").hasClass("hidden")?this.ShowSelectBox():setTimeout(function(){e.HideSelectBox()},500)},e.prototype.ShowSelectBox=function(){var e,t;!1!==$("#"+this.ContainerClientId+" .selectbox").hasClass("hidden")&&($("#"+this.ContainerClientId+" .selectbox").removeClass("hidden"),e=$("#"+this.ContainerClientId+" .selectionfilterpanel").position(),t=$("#"+this.ContainerClientId+" .selecteditemsandsearchpanel").height(),t=e.top+(t=t<10?30:t)+5,$("#"+this.ContainerClientId+" .selectbox").css("top",t),$("#"+this.ContainerClientId+" .searchtextbox").focus())},e.prototype.HideSelectBox=function(){$("#"+this.ContainerClientId+" .selectbox").addClass("hidden")},e.prototype.SearchTextBoxLostFocused=function(){$("#"+this.ContainerClientId).removeClass("focus")},e.prototype.SearchTextBoxFocused=function(){$("#"+this.ContainerClientId).addClass("focus"),this.ShowSelectBox()},e.prototype.Initialized=function(){},e.prototype.ValueBeingChanged=function(){},e.prototype.ValueChanged=function(){},e.prototype.Validate=function(){return!0},e}(),SobyEditControlFactory=function(){function e(){}return e.prototype.CreateEditControl=function(e,t,i){var s=null;return t===SobyFieldTypes.Text?s=new SobyTextBox(e,SobyFieldTypes.Text,i):t===SobyFieldTypes.Number?s=new SobyTextBox(e,SobyFieldTypes.Number,i):t===SobyFieldTypes.Lookup&&(s=new SobyLookupSelectBox(e,SobyFieldTypes.Lookup,i)),s},e.prototype.GetEditControl=function(e){return soby_EditControls[e]},e}(),sobyEditControlFactory=new SobyEditControlFactory,soby_WebGrids=new Array,soby_IsCtrlOnHold=!1,SobyShowFieldsOnObject=function(){this.All=0,this.ListOnly=1,this.EditOnly=2,this.NewOnly=3,this.ListEdit=4,this.ListNew=5,this.EditNew=6},SobyShowFieldsOn=new SobyShowFieldsOnObject;function soby_GetActiveDataGrid(){var e=$(".soby_grid.active:visible").attr("id");return soby_WebGrids[e]}function soby_GetAllGrids(){var e,t=[];for(e in soby_WebGrids)0!==$(soby_WebGrids[e].ContentDivSelector+"[gridid='"+soby_WebGrids[e].GridID+"']").length&&t.push(soby_WebGrids[e]);return t}function soby_GetAllVisibleGrids(){for(var e=$(".soby_grid:visible"),t=[],i=0;i<e.length;i++){var s=$(e[i]).attr("id");t.push(soby_WebGrids[s])}return t}function soby_RefreshAllGrids(){for(var e=soby_GetAllGrids(),t=0;t<e.length;t++)e[t].Initialize(!0)}null!==$("form")&&$("form").click(function(e){!1===$(e.target).parents().hasClass("sobygridmenu")&&$(".sobygridmenu").hide()}),document.onkeydown=function(e){17===e.keyCode&&(soby_IsCtrlOnHold=!0)},window.onresize=function(e){for(var t=soby_GetAllGrids(),i=0;i<t.length;i++)t[i].ApplyResponsiveElementsVisibility()},document.onkeyup=function(e){17===e.keyCode&&(soby_IsCtrlOnHold=!1);var t,i,s,a,o=soby_GetActiveDataGrid();null!=o&&(113===e.keyCode&&!0===o.IsEditable&&o.EditSelectedRow(),null!==(t=o.GetSelectedCellID())&&(i=$("#"+t).attr("rowid"),s=parseInt($("#"+t).attr("cellindex")),a=parseInt($("#"+t).parent().attr("rowindex"))),37===e.keyCode?0<s&&o.SelectCell(i,--s):38===e.keyCode?0<a&&(a--,i=$(o.ContentDivSelector+" tr[rowindex='"+a+"'").attr("id"),o.SelectCell(i,s)):39===e.keyCode?s<o.Columns.length-1&&o.SelectCell(i,++s):40===e.keyCode&&a<$(o.ContentDivSelector+" .soby_griddatarow").length-1&&(a++,i=$(o.ContentDivSelector+" tr[rowindex='"+a+"'").attr("id"),o.SelectCell(i,s)))};var sobyActionPaneButtons=function(i){function s(e){var t=i.call(this)||this;return e&&t.push.apply(t,e),Object.setPrototypeOf(t,Object.create(s.prototype)),t}return __extends(s,i),s.prototype.Clone=function(){for(var e=new s,t=0;t<e.length;t++)e.AddButton(e[t].Clone());return e},s.prototype.AddButton=function(e){return this.push(new sobyActionPaneButton(e.Key,e.Text,e.Index,e.ImageUrl,e.ClassName,e.Visible,e.OnClick,e.EnabilityFunction)),this[this.length-1]},s.prototype.Add=function(e,t,i,s,a,o,n,r){return this.push(new sobyActionPaneButton(e,t,i,s,a,o,n,r)),this[this.length-1]},s.prototype.AddAsSVG=function(e,t,i,s,a,o,n,r){r=this.Add(e,t,i,"",a,o,n,r);return r.SVG=s,r},s.prototype.AddCollection=function(e){for(var t=0;t<e.length;t++)this.push(e[t])},s.prototype.Get=function(e){for(var t=0;t<this.length;t++)if(this[t].Key.toLowerCase()===e.toLowerCase())return this[t]},s.prototype.Hide=function(e){this.Get(e).Hide()},s.prototype.Show=function(e){this.Get(e).Show()},s}(Array),sobyActionPaneButton=function(){function e(e,t,i,s,a,o,n,r){this.ID="actionpanebutton_"+soby_guid(),this.Key="",this.Text="",this.Index=null,this.ImageUrl="",this.ClassName="",this.Visible=!0,this.OnClick=null,this.EnabilityFunction=null,this.SVG=null,this.Key=e,this.Text=t,this.Index=i,this.ImageUrl=s,this.ClassName=a,this.OnClick=n,this.Visible=o,this.EnabilityFunction=r}return e.prototype.Clone=function(){return new e(this.Key,this.Text,this.Index,this.ImageUrl,this.ClassName,this.Visible,this.OnClick,this.EnabilityFunction)},e.prototype.Hide=function(){$("#"+this.ID).hide()},e.prototype.Show=function(){$("#"+this.ID).show()},e}(),sobyResponsiveCondition=function(){function e(e){this.ValidateFunction=null,this.ID=null,this.ValidateFunction=e,this.ID=soby_guid()}return e.prototype.Validate=function(){var e=$(window).width(),t=$(window).height();return this.ValidateFunction(e,t)},e.prototype.GetClassName=function(){return"responsivecondition_"+this.ID},e}(),SobyGridColumn=function(e,t,i,s,a,o,n,r,l,h,d,c){void 0===l&&(l=null),this.FilterControl=null,this.CellCss="",this.CellClassNames="",this.HeaderCss="",this.HeaderClassNames="",this.ResponsiveConditionID=null,this.IsVisible=!0,this.FieldName=e,this.DisplayName=t,this.ShowFieldsOn=i,this.DisplayFunction=s,this.CellTemplate=a,this.Sortable=o,this.Filterable=n,this.Editable=r,this.FilterControl=l,this.CellCss=h,this.CellClassNames=d,this.ResponsiveConditionID=c},soby_WebGrid=function(){function t(e,t,i,s){this.ActionInProgress=!1,this.NavigationActionInProgress=!1,this.Active=!1,this.AllowExportData=!1,this.AllowMultipleSelections=!0,this.GridID="",this.ThemeName="classic",this.ThemeClassName=this.ThemeName,this.ContentDivSelector="",this.ItemDialogClientID="",this.Title="",this.AltTitle="",this.DisplayTitle=!0,this.DataService=null,this.EmptyDataHtml="",this.NavigationInformation=new SobyNavigationInformation,this.OrderByFields=new SobyOrderByFields,this.Filters=new SobyFilters(!1),this.FilterControls=[],this.GroupByFields=new SobyGroupByFields,this.AggregateFields=new SobyAggregateFields,this.ResponsiveConditions=new Array,this.KeyFields=new SobyKeyFields,this.CellCount=0,this.DataRelations=[],this.Columns=new Array,this.InitializedActionPaneButtons=!1,this.IsSelectable=!0,this.IsAddAllowed=!0,this.IsEditable=!0,this.IsDeletable=!0,this.IsGroupable=!1,this.IsScrollable=!1,this.Items=null,this.ShowRefreshButton=!0,this.ShowHeader=!0,this.SVGImages=new soby_SVGImages,this.ActionPaneButtons=new sobyActionPaneButtons,this.LastGroupByValues=[],this.TableTagName="table",this.TBodyTagName="tbody",this.THeadTagName="thead",this.TFootTagName="tfoot",this.RowTagName="tr",this.CellTagName="td",this.TableAdditionalClassNames="",this.RowAdditionalClassNames="",this.CellAdditionalClassNames="",this.OnItemAdded=null,this.OnItemUpdated=null,this.OnItemsDeleted=null,this.OnGridRowPopulated=null,this.OnGridPopulated=null,this.OnGridDataBeingParsed=null,this.OnGridPrintBeingStarted=null,this.OnRowSelected=null,this.OnCellSelected=null,this.OnCellTemplateContentPopulated=null,this.RowDetailDisplayFunction=null,this.RowDetailDisplayViewResponsiveCondition=null,this.GridID="soby_grid_"+soby_guid(),this.ContentDivSelector=e,this.ItemDialogClientID=this.GridID+"_dialog",this.Title=t,this.DataService=i,this.EmptyDataHtml=s,this.EnsureGridExistency()}return t.prototype.Clone=function(e){e=new t(e,this.Title,this.DataService,this.EmptyDataHtml);return e.AllowExportData=this.AllowExportData,e.AllowMultipleSelections=this.AllowMultipleSelections,e.ThemeName=this.ThemeName,e.ThemeClassName=this.ThemeClassName,e.ItemDialogClientID=this.ItemDialogClientID,e.DisplayTitle=this.DisplayTitle,e.NavigationInformation=this.NavigationInformation,e.OrderByFields=this.OrderByFields,e.Filters=this.Filters.Clone(),e.FilterControls=this.FilterControls,e.GroupByFields=this.GroupByFields,e.AggregateFields=this.AggregateFields,e.ResponsiveConditions=this.ResponsiveConditions,e.KeyFields=this.KeyFields,e.CellCount=this.CellCount,e.DataRelations=this.DataRelations,e.Columns=this.Columns,e.IsSelectable=this.IsSelectable,e.IsAddAllowed=this.IsAddAllowed,e.IsEditable=this.IsEditable,e.IsDeletable=this.IsDeletable,e.IsGroupable=this.IsGroupable,e.ShowRefreshButton=this.ShowRefreshButton,e.ShowHeader=this.ShowHeader,e.ActionPaneButtons=this.ActionPaneButtons.Clone(),e.LastGroupByValues=this.LastGroupByValues,e.TableTagName=this.TableTagName,e.TBodyTagName=this.TBodyTagName,e.THeadTagName=this.THeadTagName,e.TFootTagName=this.TFootTagName,e.RowTagName=this.RowTagName,e.CellTagName=this.CellTagName,e.TableAdditionalClassNames=this.TableAdditionalClassNames,e.RowAdditionalClassNames=this.RowAdditionalClassNames,e.CellAdditionalClassNames=this.CellAdditionalClassNames,e},t.prototype.GetResponsiveConditionById=function(e){for(var t=0;t<this.ResponsiveConditions.length;t++)if(this.ResponsiveConditions[t].ID===e)return this.ResponsiveConditions[t];return null},t.prototype.InitializeActionPaneButtons=function(){var e;!0!==this.InitializedActionPaneButtons&&((e=new sobyActionPaneButtons).AddAsSVG("ExportToExcel","Export to excel",0,this.SVGImages.GetExcel(),"soby-icon-excel",!0,function(e){e.ExportToExcel()},function(e){return e.AllowExportData}),e.AddAsSVG("ExportToCSV","Export to csv",1,this.SVGImages.GetCSV(),"soby-icon-csv",!0,function(e){e.ExportTableToCSV()},function(e){return e.AllowExportData}),e.AddAsSVG("PrintGrid","Print",2,this.SVGImages.GetPrint(),"soby-icon-print",!0,function(e){e.PrintGrid()},function(e){return e.AllowExportData}),e.AddAsSVG("CopyToClipboard","Copy to clipboard",3,this.SVGImages.GetClipboard(),"soby-icon-clipboard",!0,function(e){e.CopyToClipboard()},function(e){return e.AllowExportData}),this.ActionPaneButtons.AddCollection(e),this.InitializedActionPaneButtons=!0)},t.prototype.EnsureGridExistency=function(){for(var e in soby_WebGrids)if(e===this.GridID)return;soby_WebGrids[this.GridID]=this},t.prototype.GetItemFieldValue=function(e,t){var i=this.DataService.DataSourceBuilder.SchemaFields.GetByFieldName(t);if(null==i||null===i.Args||void 0===i.Args||null===i.Args.ModelName||void 0===i.Args.ModelName)return this.Items[e][t];e=this.Items[e][i.Args.ModelName];return null==e?null:void 0!==i.Args.ValueFieldName?e[i.Args.ValueFieldName]:void 0},t.prototype.HideItemDialog=function(){$("#"+this.ItemDialogClientID).hide()},t.prototype.EnsureItemDialogContainer=function(){var e=$("#"+this.ItemDialogClientID);return 0===e.length?((e=$("<div class='sobyitemdialog "+this.ThemeClassName+"'></div>")).attr("id",this.ItemDialogClientID),$("body").append(e)):e.html(""),e},t.prototype.PopulateEditControlsOnNewEditForm=function(r,e){var t=this.EnsureItemDialogContainer(),l=null;!0===r&&(l=$("#"+e));var h=$("<table></table>");t.append(h);for(var d=this,i=0;i<this.Columns.length;i++)!function(e){var t=d.Columns[e];if(!1===t.Editable)return;var i=$("<tr></tr>"),s=$("<td></td>");s.text(t.DisplayName);var a=$("<td></td>"),e=d.GridID+"_fieldeditcell_"+t.FieldName;a.attr("id",e),i.append(s),i.append(a),h.append(i);var a=d.DataService.DataSourceBuilder.GetViewFieldByPropertyName(t.FieldName),i=a.FieldType,o=sobyEditControlFactory.CreateEditControl(e,i,a.Args),n=d;o.Initialized=function(){var e;!0===r&&(e=parseInt(l.attr("rowindex")),e=n.GetItemFieldValue(e,t.FieldName),o.SetValue(e))},o.Initialize()}(i);var s=$("<p align='right'></p>"),a=$("<input type='button' value='Save' onclick=\"javascript:soby_WebGrids['"+this.GridID+"'].SaveItemDetail("+(!0===r?"'"+e+"'":"null")+')">'),e=$("<input type='button' value='Cancel' onclick=\"javascript:soby_WebGrids['"+this.GridID+"'].HideItemDialog()\">");s.append(a),s.append(e),t.append(s);s=(l=!1===r?$(this.ContentDivSelector+" .actionpane"):l).offset();t.css("top",s.top+35),t.css("left",s.left+l.width()-l.width()),t.show()},t.prototype.EditSelectedRow=function(){var e=this.GetSelectedRowIDs();1===e.length&&(e=e[0],this.PopulateEditControlsOnNewEditForm(!0,e))},t.prototype.EditNewRow=function(){this.PopulateEditControlsOnNewEditForm(!1,"")},t.prototype.SaveItemDetail=function(e){$("#"+this.ItemDialogClientID);for(var t={},i=this.DataService.DataSourceBuilder.SchemaFields,s=0;s<i.length;s++){var a,o=(d=i[s]).FieldName;(t[o=null!=d&&null!==d.Args&&void 0!==d.Args&&null!==d.Args.ModelName&&void 0!==d.Args.ModelName?d.Args.ModelName:o]=null)!==e&&""!==e&&(a=$("#"+e),a=parseInt(a.attr("rowindex")),t[o]=this.Items[a][d.FieldName])}for(var n=[],r=[],s=0;s<this.KeyFields.length;s++){var l={};l[this.KeyFields[s].ParameterName]=t[this.KeyFields[s].FieldName],n.push(l),r.push(this.KeyFields[s].ParameterName)}for(s=0;s<this.Columns.length;s++){var h=this.Columns[s];if(!1!==h.Editable){var d,c=this.GridID+"_fieldeditcell_"+h.FieldName,u=sobyEditControlFactory.GetEditControl(c).GetValue();if(null!==u!==null&&void 0!==u.Value){if(null!=(d=i.GetByFieldName(h.FieldName))&&null!==d.Args&&void 0!==d.Args&&null!==d.Args.ModelName&&void 0!==d.Args.ModelName){c=t[d.Args.ModelName];null==c&&(c={}),void 0!==d.Args.ValueFieldName&&(c[d.Args.ValueFieldName]=u.Value),void 0!==d.Args.TitleFieldName&&(c[d.Args.TitleFieldName]=u.Text),t[d.Args.ModelName]=c;break}u=u.Value}t[h.FieldName]=u}else for(var p=0;p<this.KeyFields.length;p++)this.KeyFields[p].FieldName===h.FieldName&&(t[h.FieldName]=0)}null!==e&&""!==e?this.UpdateRecord(r,n,t,e):this.AddNewRecord(t)},t.prototype.AddNewRecord=function(e){this.DataService.AddItem(e),null!==this.OnItemAdded&&this.OnItemAdded(e)},t.prototype.UpdateRecord=function(e,t,i,s){this.DataService.UpdateItem(e,t,i),null!==this.OnItemUpdated&&this.OnItemUpdated(s,i)},t.prototype.DeleteSelectedRows=function(){if(!1!==confirm("Are you sure you want to delete the selected item(s)")){for(var e=this.GetSelectedRowIDs(),t=[],i=0;i<e.length;i++){var s=$("#"+e[i]),s=parseInt(s.attr("rowindex")),a=this.Items[s];t.push(a)}for(i=0;i<t.length;i++){for(var a=t[i],o=[],n=[],r=0;r<this.KeyFields.length;r++)o.push(a[this.KeyFields[r].FieldName]),n.push(this.KeyFields[r].ParameterName);this.DataService.DeleteItem(n,o)}null!==this.OnItemsDeleted&&this.OnItemsDeleted(t)}},t.prototype.EditOffOnEditedCells=function(){for(var e=$(this.ContentDivSelector+" .edited"),t=0;t<e.length;t++){var i=$(e[t]).attr("id");this.EditOffCell(i)}},t.prototype.EditSelectedCell=function(){this.EditOffOnEditedCells();var e=this.GetSelectedCellID();this.EditCell(e)},t.prototype.EditOffCell=function(e){$("#"+e).removeClass("edited")},t.prototype.EditCell=function(e){$("#"+e).addClass("edited");parseInt($("#"+e).attr("columnindex"))},t.prototype.Activate=function(){$(this.ContentDivSelector+" .soby_grid").addClass("active"),this.HideHeaderRowMenu(null)},t.prototype.DeActivate=function(){$(this.ContentDivSelector+" .soby_grid").removeClass("active")},t.prototype.AddKeyField=function(e,t){this.KeyFields.push(new SobyKeyField(e,t))},t.prototype.AddFilterControl=function(e,t,i){this.FilterControls[this.FilterControls.length]={FieldName:e,DisplayName:t,FieldType:i}},t.prototype.AddAggregateField=function(e,t){this.AggregateFields.push(new SobyAggregateField(e,t))},t.prototype.AddColumn=function(e,t,i,s,a,o,n,r,l,h,d,c){var u=null;if(null!=c){for(var u=c.ID,p=!1,y=0;y<this.ResponsiveConditions.length;y++)if(this.ResponsiveConditions[y].ID===c.ID){p=!0;break}!1===p&&this.ResponsiveConditions.push(c)}u=new SobyGridColumn(e,t,i,s,a,o,n,r,l,h,d,u);return this.Columns.push(u),u},t.prototype.AddDataRelation=function(e,t,i,s){this.DataRelations[this.DataRelations.length]={MasterFieldDisplayName:e,MasterFieldValueName:t,DetailGridID:i,DetailFieldName:s}},t.prototype.GetRowIds=function(){for(var e=[],t=$(this.ContentDivSelector+" .soby_griddatarow"),i=0;i<t.length;i++)e[e.length]=$(t[i]).attr("id");return e},t.prototype.GetRowIdByItemIndex=function(e){e=$(this.ContentDivSelector+" .soby_griddatarow[rowindex='"+e+"']");return null!==e?e.attr("id"):null},t.prototype.GetSelectedRowID=function(){var e=$(this.ContentDivSelector+" .soby_griddatarow.selected");return(0<e.length?e:$(this.ContentDivSelector+" .soby_griddatarow")).attr("id")},t.prototype.GetActiveRowID=function(){var e=$(this.ContentDivSelector+" .soby_griddatarow.active");return 0<e.length?e.attr("id"):null},t.prototype.GetSelectedCellIds=function(){for(var e=[],t=$(this.ContentDivSelector+" .soby_gridcell.selected"),i=0;i<t.length;i++)e[e.length]=$(t[i]).attr("id");return e},t.prototype.GetSelectedCellID=function(){var e=$(this.ContentDivSelector+" .soby_gridcell.selected");return(0<e.length?e:$(this.ContentDivSelector+" .soby_gridcell")).attr("id")},t.prototype.GetColumn=function(e){for(var t=0;t<this.Columns.length;t++)if(this.Columns[t].FieldName===e)return this.Columns[t];return null},t.prototype.GetSelectedRowIDs=function(){for(var e=$(this.ContentDivSelector+" .soby_griddatarow.selected"),t=[],i=0;i<e.length;i++)t[t.length]=$(e[i]).attr("id");return t},t.prototype.GetSelectedDataItems=function(){for(var e=$(this.ContentDivSelector+" .soby_griddatarow.selected"),t=[],i=0;i<e.length;i++){var s=$(e[i]).attr("rowindex");t[t.length]=this.Items[s]}return t},t.prototype.SelectAllRows=function(){var e=$(".soby_gridheaderrow").hasClass("selected");!0===e?$(".soby_gridheaderrow").removeClass("selected"):$(".soby_gridheaderrow").addClass("selected");for(var t,i=$(this.ContentDivSelector+" .soby_griddatarow"),s=0;s<i.length;s++)!1===e?(t=$(i[s]).attr("id"),$(i[s]).addClass("selected"),null!==this.OnRowSelected&&this.OnRowSelected(this,t)):$(i[s]).removeClass("selected");this.SetActionPaneButtonsVisibility()},t.prototype.SelectRow=function(e){for(var t=-1,i=this.GetSelectedRowIDs(),s=0;s<i.length;s++)if(i[s]===e){t=s;break}-1<t?$("#"+i[t]).removeClass("selected"):(!0===this.AllowMultipleSelections&&!0===soby_IsCtrlOnHold||$(this.ContentDivSelector+" .soby_griddatarow").removeClass("selected"),$("#"+e).addClass("selected")),this.GenerateActionPane(),""!==$(".soby_griddetailrow[mainrowid = '"+e+"'] .soby_gridtabheaderpanel").html()&&this.SelectDetailGridTab(e,0),null!==this.OnRowSelected&&this.OnRowSelected(this,e),this.SetActionPaneButtonsVisibility()},t.prototype.SelectRowByIndex=function(e){e=$(this.ContentDivSelector+" .soby_griddatarow:eq("+e+")").attr("id");this.SelectRow(e)},t.prototype.SelectCell=function(e,t){$(this.ContentDivSelector+" .soby_griddatarow").removeClass("active"),$(this.ContentDivSelector+" .soby_gridcell").removeClass("selected"),$("#"+e+" td[cellindex='"+t+"']").addClass("selected"),$("#"+e).addClass("active"),null!==this.OnCellSelected&&this.OnCellSelected(this,e,t),this.SetActionPaneButtonsVisibility()},t.prototype.HideShowFilterPane=function(){var e=$(this.ContentDivSelector+" .filterpane");!0==0<e.find(".filterpanetable:visible").length?(e.find(".showhidebutton").text("V"),e.find(".filterpanetable").slideUp("slow")):(e.find(".showhidebutton").text("^"),e.find(".filterpanetable").slideDown("slow"))},t.prototype.GenerateFilterPane=function(){var e=$(this.ContentDivSelector+" .filterpane");if(0===this.FilterControls.length)return e.hide(),void e.parent().hide();for(var t=$("<div></div>"),i=$("<div><a href='javascript:void(0)' class='showhidebutton' onclick=\"javascript:soby_WebGrids['"+this.GridID+"'].HideShowFilterPane()\" style='text-decoration: inherit;'>^</a></div>"),s=$("<div class='filterpanetable'></div>"),a=$("<table></table>"),o=0;o<this.FilterControls.length;o++){var n=$("<tr></tr>"),r=$("<td></td>"),l=$("<td></td>");r.html(this.FilterControls[o].DisplayName),l.html("<input type='text'>"),n.append(r),n.append(l),a.append(n)}s.append(a),t.append(s),e.html(""),e.append(i),e.append(t)},t.prototype.AllowDropColumn=function(e){e.preventDefault()},t.prototype.DragColumn=function(e,t){e.dataTransfer.setData("text",t)},t.prototype.DropColumn=function(e){e.preventDefault();e=e.dataTransfer.getData("text");this.GroupBy(e,!0,null)},t.prototype.DropGroupByColumn=function(e){for(var t=e.dataTransfer.getData("text"),i=new SobyGroupByFields,s=0;s<this.GroupByFields.length;s++)this.GroupByFields[s].FieldName!==t&&i.push(this.GroupByFields[s]);this.GroupByFields=i,this.DataService.GroupBy(this.GroupByFields)},t.prototype.ExportToExcel=function(){var e="exportdata1.xls",t=document.getElementById(this.GridID),i=$(t.outerHTML);i.find(".groupbypanerow").remove(),i.find(".actionpanerow").remove(),i.find(".loadingrow").remove(),i.find("img").remove();var s=i[0].outerHTML,t='<html xmlns:x="urn:schemas-microsoft-com:office:excel">',t='<html xmlns:x="urn:schemas-microsoft-com:office:excel"><head><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet>';t='<html xmlns:x="urn:schemas-microsoft-com:office:excel"><head><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Test Sheet</x:Name><x:WorksheetOptions><x:Panes></x:Panes></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml></head><body>',t=(t="<html xmlns:x=\"urn:schemas-microsoft-com:office:excel\"><head><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Test Sheet</x:Name><x:WorksheetOptions><x:Panes></x:Panes></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml></head><body><table border='1px'>")+s,t+="</table></body></html>";i=new Blob([t],{type:"application/vnd.ms-excel;charset=utf-8"}),t=document.createElement("a");document.body.appendChild(t),navigator.msSaveOrOpenBlob?navigator.msSaveOrOpenBlob(i,e):(t.href="data:application/vnd.ms-excel, "+s,t.download=e,t.click())},t.prototype.ExportTableToCSV=function(){for(var e=[],t=document.getElementById(this.GridID).querySelectorAll("tr.soby_gridheaderrow, tr.soby_griddatarow"),i=0;i<t.length;i++){for(var s=[],a=t[i].querySelectorAll("td, th"),o=0;o<a.length;o++)s.push(a[o].textContent);e.push(s.join(","))}this.DownloadCSV(e.join("\n"),"exportdata.csv")},t.prototype.DownloadCSV=function(e,t){var i=new Blob([e]);window.navigator.msSaveOrOpenBlob?window.navigator.msSaveBlob(i,"filename.csv"):((e=document.createElement("a")).download=t,e.href=window.URL.createObjectURL(i),e.style.display="none",document.body.appendChild(e),e.click())},t.prototype.PrintGrid=function(){var e=document.getElementById(this.GridID),t=$(e.outerHTML);t.find(".groupbypanerow").remove(),t.find(".actionpanerow").remove(),t.find(".loadingrow").remove(),t.find("img").remove();e=t[0].outerHTML,t=window.open("","","height=500, width=500");t.document.write("<html>"),t.document.write("<body >"),t.document.write(e),t.document.write("</body>"),null!==this.OnGridPrintBeingStarted&&this.OnGridPrintBeingStarted(t.document),t.document.write("</html>"),t.document.close(),t.print()},t.prototype.CopyToClipboard=function(){var e=document.createRange();e.selectNode(document.getElementById(this.GridID)),window.getSelection().removeAllRanges(),window.getSelection().addRange(e),$("#"+this.GridID+" .actionpanerow").hide(),document.execCommand("copy"),$("#"+this.GridID+" .actionpanerow").show(),window.getSelection().removeAllRanges()},t.prototype.GenerateGroupByPanePane=function(){var e=$(this.ContentDivSelector+" .groupbypane");if(e.html(""),!1!==this.IsGroupable){e.attr("ondragover","soby_WebGrids['"+this.GridID+"'].AllowDropColumn(event)"),e.attr("ondrop","soby_WebGrids['"+this.GridID+"'].DropColumn(event)");var t=$("<div>Drag a column header here to group by that column</div>");0<this.GroupByFields.length&&t.html("");for(var i=0;i<this.GroupByFields.length;i++){for(var s=$("<div class='soby-groupby-heading'></div>"),a="",o=0;o<this.Columns.length;o++)this.Columns[o].FieldName.toLowerCase()===this.GroupByFields[i].FieldName.toLowerCase()&&(a=this.Columns[o].DisplayName);var n=$("<a href='javascript:void(0)' onclick=\"soby_WebGrids['"+this.GridID+"'].SortGroupByField('"+this.GroupByFields[i].FieldName+"', true)\">"+a+"&nbsp;"+this.SVGImages.GetArrowDown()+"</a>");!0===this.GroupByFields[i].IsAsc&&(n=$("<a href='javascript:void(0)' onclick=\"soby_WebGrids['"+this.GridID+"'].SortGroupByField('"+this.GroupByFields[i].FieldName+"', false)\">"+a+"&nbsp;"+this.SVGImages.GetArrowUp()+"</a>")),s.append(n),s.attr("draggable","true"),s.attr("ondragstart","soby_WebGrids['"+this.GridID+"'].DragColumn(event, '"+this.GroupByFields[i].FieldName+"')"),t.append(s)}e.append(t)}else $(this.ContentDivSelector+" .groupbypanerow").hide()},t.prototype.SetActionPaneButtonsVisibility=function(){for(var e=!1,t=0;t<this.ActionPaneButtons.length;t++){var i=this.ActionPaneButtons[t];!0===i.EnabilityFunction(this)?(i.Show(),e=!0):i.Hide()}var s=$(this.ContentDivSelector+" .actionpanerow");!0===e?s.show():s.hide()},t.prototype.GenerateActionPane=function(){var e=$(this.ContentDivSelector+" .actionpane");if(!0!==e.hasClass("isloaded")){e.html("");for(var t=0;t<this.ActionPaneButtons.length;t++){var i=this.ActionPaneButtons[t],s=$("<a href='javascript:void(0)'>"+(""!==i.ImageUrl&&null!==i.ImageUrl&&void 0!==i.ImageUrl?"<span class='soby-icon-imgSpan' > <img class='"+i.ClassName+" soby-icon-img' src= '"+i.ImageUrl+"' > </span>":"")+(""!==i.SVG&&null!==i.SVG&&void 0!==i.SVG?i.SVG:"")+"<span>"+i.Text+"</span> </a>");s.attr("id",i.ID),s.attr("key",i.Key),s.attr("gridid",this.GridID),s.click(function(){var e=$(this).attr("key"),t=$(this).attr("gridid"),t=soby_WebGrids[t],e=t.ActionPaneButtons.Get(e);null!==e.OnClick&&e.OnClick(t)}),e.append(s)}}},t.prototype.GenerateNavigationPane=function(){var e=$(this.ContentDivSelector+" .navigationpane");if(!1===this.DataService.CanNavigateToNextPage()&&!1===this.DataService.CanNavigateToPreviousPage())return e.hide(),"";e.show();var t=$("<nav><ul class='pagination' ></ul></nav>"),i="margin:auto";this.NavigationInformation.VerticalAlign===SobyPaginationVerticalAlign.Left?i="margin:0px":this.NavigationInformation.VerticalAlign===SobyPaginationVerticalAlign.Right?i="margin:0px;float:right":this.NavigationInformation.VerticalAlign===SobyPaginationVerticalAlign.Center&&(i="margin:0px;width:100%",t.find(".pagination").css("-webkit-box-pack","center").css("-ms-flex-pack","center").css("justify-content","center")),!0===this.DataService.CanNavigateToPreviousPage()&&t.find("ul").append("<li class='page-item'><a class='page-link' href='javascript:void(0)' onclick=\"javascript:soby_WebGrids['"+this.GridID+"'].GoToPreviousPage()\" aria-label='Previous'><span aria-hidden='true'>«</span><span class='sr-only'>Previous</span></a></li>"),t.find("ul").append("<li class='page-item disabled'><a class='page-link' href='#'>"+this.DataService.StartIndex+" - "+this.DataService.EndIndex+"</a></li>"),!0===this.DataService.CanNavigateToNextPage()&&t.find("ul").append("<li class='page-item'><a class='page-link'  onclick=\"javascript:soby_WebGrids['"+this.GridID+"'].GoToNextPage()\" aria-label='Next'><span aria-hidden='true'>»</span><span class='sr-only'>Next</span></a></li>");i=$("<div style='"+i+"'></div>");i.append(t),e.html(""),e.append(i)},t.prototype.GoToNextPage=function(){this.NavigationActionInProgress=!0,this.NavigationInformation.PageIndex=this.NavigationInformation.PageIndex+1,this.DataService.GoToPage(this.NavigationInformation.PageIndex)},t.prototype.GoToPreviousPage=function(){this.NavigationActionInProgress=!0,this.NavigationInformation.PageIndex=this.NavigationInformation.PageIndex-1,this.DataService.GoToPage(this.NavigationInformation.PageIndex)},t.prototype.PopulateDetailGrid=function(e,t,i,s,a){if($(this.ContentDivSelector+" tr[id!='"+i+"'] .soby-list-hiderelateddata").removeClass("soby-list-hiderelateddata").addClass("soby-list-showrelateddata"),0<$(".soby_griddetailrow[mainrowid='"+i+"'] .detailgridcell:visible").length)$(".soby_griddetailrow[mainrowid='"+i+"'] .detailgridcell").hide(),$("#"+i+" .soby-list-hiderelateddata").removeClass("soby-list-hiderelateddata").addClass("soby-list-showrelateddata");else{var o=e.split(soby_FilterValueSeperator),n=t.split(soby_FilterValueSeperator),r=s.split(soby_FilterValueSeperator),l=a.split(soby_FilterValueSeperator);$(this.ContentDivSelector+" .detailgridcell").hide(),$(".soby_griddetailrow[mainrowid='"+i+"'] .detailgridcell").show(),$("#"+i+" .soby-list-showrelateddata").removeClass("soby-list-showrelateddata").addClass("soby-list-hiderelateddata");a=$(".soby_griddetailrow[mainrowid='"+i+"'] .detailgridcell").attr("data-isloaded");if("1"!==a&&(null!==e&&""!==e)){for(var h=0;h<o.length;h++){var d=o[h],c=n[h],u=r[h],p=l[h],y=soby_WebGrids[d].Clone(c);y.Initialize(!1);d=y.DataService.DataSourceBuilder.GetViewFieldByPropertyName(u),c=d.FieldType;if((c=c===SobyFieldTypes.Lookup&&null!==d.Args.ValueFieldType?d.Args.ValueFieldType:c)===SobyFieldTypes.Number&&null!=p&&""!==p)try{p=parseInt(p)}catch(e){}y.Filters.Clear(),y.FilterResult(u,p,c,SobyFilterTypes.Equal,!1)}$(".soby_griddetailrow[mainrowid='"+i+"'] .detailgridcell").attr("data-isloaded","1")}}},t.prototype.SelectDetailGridTab=function(e,t){e=$("tr[mainrowid='"+e+"']");e.find(".soby_tabheader").removeClass("active"),e.find(".soby_tabheader[index='"+t+"']").addClass("active"),e.find(".soby_tabcontent").hide(),e.find(".soby_tabcontent[index='"+t+"']").show(),$(this.ContentDivSelector+" .detailgridcell").hide(),e.find(".detailgridcell").show()},t.prototype.ShowCellPopupContent=function(e,t,i){this.PopulateCellTemplateContent(e,t,i),null!==this.OnCellTemplateContentPopulated&&this.OnCellTemplateContentPopulated(e,t,i),$(this.ContentDivSelector+" .popup_content").hide();var s=$("#"+e),t=$(window).width()/4,i=$(window).height()/4,e=s.position().left+40;s.find(".popup_content").css("left",e+"px"),s.find(".popup_content").css("width",t+"px"),s.find(".popup_content").css("height",i+"px"),s.find(".popup_content").show()},t.prototype.HideCellPopupContent=function(e){$("#"+e+" .popup_content").hide()},t.prototype.ClearFiltersOn=function(e){for(var t=[],i=0;i<this.Filters.Filters.length;i++)!1!==this.Filters.Filters[i].ShouldBeClearedOnUIFilterAction&&this.Filters.Filters[i].FieldName===e||(t[t.length]=this.Filters.Filters[i]);this.Filters.Filters=t,this.HideHeaderRowMenu(e),this.DataService.Filter(this.Filters,!0)},t.prototype.AddFilterField=function(e,t,i,s,a){this.Filters.AddFilter(e,t,i,s,!1,a)},t.prototype.FilterResult=function(e,t,i,s,a){this.NavigationInformation.PageIndex=0,this.HideHeaderRowMenu(null),this.ClearUIFilters(),this.AddFilterField(e,t,i,s,a),this.DataService.Filter(this.Filters,!0)},t.prototype.FilterResultWithMultipleValues=function(e,t,i,s,a){this.NavigationInformation.PageIndex=0,this.HideHeaderRowMenu(null);var o=new SobyFilters(!0);if(this.ClearUIFilters(),0<t.length){for(var n,r=0;r<t.length;r++)""!==t[r]&&null!==t[r]&&(null===(n=t[r])&&(n=t[r]),soby_LogMessage("filterValue:"),soby_LogMessage(n),o.AddFilter(e,n,i,s,!1,a));this.Filters.AddFilterCollection(o)}this.DataService.Filter(this.Filters,!0)},t.prototype.ClearUIFilters=function(){for(var e=[],t=this.Filters.Filters.length-1;-1<t;t--)!1===this.Filters.Filters[t].ShouldBeClearedOnUIFilterAction&&(e[e.length]=this.Filters.Filters[t]);this.Filters.Filters=e},t.prototype.SortGroupByField=function(e,t){this.HideHeaderRowMenu(null);for(var i=0;i<this.GroupByFields.length;i++)this.GroupByFields[i].FieldName.toLowerCase()===e.toLowerCase()&&(this.GroupByFields[i].IsAsc=t);this.DataService.GroupBy(this.GroupByFields)},t.prototype.AddOrderByField=function(e,t){for(var i=!1,s=0;s<this.OrderByFields.length;s++)this.OrderByFields[s].FieldName===e&&(i=!0);!0!==i&&this.OrderByFields.push(new SobyOrderByField(e,t))},t.prototype.SortResult=function(e,t){this.HideHeaderRowMenu(null),this.OrderByFields=new SobyOrderByFields,this.AddOrderByField(e,t),this.NavigationInformation.PageIndex=0,this.DataService.Sort(this.OrderByFields)},t.prototype.AddGroupByField=function(e,t,i){for(var s=!1,a=0;a<this.GroupByFields.length;a++)this.GroupByFields[a].FieldName===e&&(s=!0);!0!==s&&this.GroupByFields.push(new SobyGroupByField(e,t,i))},t.prototype.GroupBy=function(e,t,i){this.AddGroupByField(e,t,i),this.DataService.GroupBy(this.GroupByFields)},t.prototype.AggregateBy=function(e,t){this.AddAggregateField(e,t),this.DataService.PopulateItems(null)},t.prototype.AddHeaderCell=function(e,t,i){var s="",a="",o="",n=!1,r=!1;null!==t?(s=t.FieldName,a=t.DisplayName,o=t.ResponsiveConditionID,n=null===t.Sortable||void 0===t.Sortable||t.Sortable,r=null===t.Filterable||void 0===t.Filterable||t.Filterable):(n=r=!0,s=i.MasterFieldValueName,a=i.MasterFieldDisplayName);for(var l="",h=0;h<this.Filters.Filters.length;h++)!0===this.Filters.Filters[h].ShouldBeClearedOnUIFilterAction&&this.Filters.Filters[h].FieldName===s&&(l="&nbsp;"+this.SVGImages.GetFilterCircle());var d=$("<th style='padding:5px;' nowrap='nowrap' scope='col' class='ms-vh2 soby_gridheadercell' fieldName='"+s+"'></th>");if(null!==o&&""!==o&&d.addClass(this.GetResponsiveConditionById(o).GetClassName()),null!==t.HeaderCss&&""!==t.HeaderCss)for(var c=t.HeaderCss.split(";"),u=0;u<c.length;u++){var p=c[u].split(":")[0],y=c[u].split(":")[1];d.css(p,y)}null!==t.HeaderClassNames&&""!==t.HeaderClassNames&&d.addClass(t.HeaderClassNames);var g=null,i=$("<div style='width:100%;position: relative;'></div>"),o=$("<div style='float:left;'></div>"),t=$("<div style='width:10px;float:right;display:none' class='headerrowmenuiconcontainer'><a href='javascript:void(0)' class='openmenulink'>"+this.SVGImages.GetCollapse()+"</a></div>");i.append(o),i.append(t),!0===this.IsGroupable&&(o.attr("draggable","true"),o.attr("ondragstart","soby_WebGrids['"+this.GridID+"'].DragColumn(event, '"+s+"')")),!0===n||!0===r?d.addClass("showmenu"):d.addClass("hidemenu");var m=this;!1===n&&!1===r?o.html(a):(!0===this.OrderByFields.ContainsField(s)?!0===this.OrderByFields.ContainsFieldAsAsc(s)?(g=$("<a href='javascript:void(0)' class='soby_gridheaderlink'>"+a+l+" "+this.SVGImages.GetArrowUp()+"</a>")).click(function(){!0===n?m.SortResult(s,!1):!0===r&&m.ShowHeaderRowMenu(s,a,n,r)}):(g=$("<a href='javascript:void(0)' class='soby_gridheaderlink'>"+a+l+" "+this.SVGImages.GetArrowDown()+"</a>")).click(function(){!0===n?m.SortResult(s,!0):!0===r&&m.ShowHeaderRowMenu(s,a,n,r)}):(g=$("<a href='javascript:void(0)' class='soby_gridheaderlink'>"+a+l+"</a>")).click(function(){!0===n?m.SortResult(s,!0):!0===r&&m.ShowHeaderRowMenu(s,a,n,r)}),o.html(g)),null!==g&&g.focus(function(){m.ShowHeaderRowMenuIcon(s)}),t.find("a.openmenulink").click(function(){m.ShowHeaderRowMenu(s,a,n,r)}),d.append(i),e.append(d),d.mouseover(function(){m.ShowHeaderRowMenuIcon(s)}),d.mouseout(function(){m.HideHeaderRowMenuIcon(s)})},t.prototype.ApplyResponsiveElementsVisibility=function(){for(var e=0;e<this.ResponsiveConditions.length;e++){var t=this.ResponsiveConditions[e];!0===t.Validate()?($(this.ContentDivSelector+" ."+t.GetClassName()).show(),$(this.ContentDivSelector+" .soby_gridheadercell.soby_selectitemcell").show()):($(this.ContentDivSelector+" ."+t.GetClassName()).hide(),$(this.ContentDivSelector+" .soby_gridheadercell.soby_selectitemcell").hide())}},t.prototype.PopulateHeaderCells=function(){var e=$(this.ContentDivSelector+" .soby_gridheaderrow");e.attr("ondragover","soby_WebGrids['"+this.GridID+"'].AllowDropColumn(event)"),e.attr("ondrop","soby_WebGrids['"+this.GridID+"'].DropGroupByColumn(event)"),e.find("th").remove();var t;(!0===this.IsSelectable||0<this.DataRelations.length||null!==this.RowDetailDisplayFunction)&&(t=$("<th class='soby_gridheadercell soby_selectitemcell' width='20px' style='padding:5px;text-align:center'></th>"),!0===this.IsSelectable&&t.html("<a href='javascript:void (0)' class='soby-list-selectitem-a' onclick=\"soby_WebGrids['"+this.GridID+"'].SelectAllRows();\">"+this.SVGImages.GetCheck()+"</a>"),e.append(t),!1===this.IsSelectable&&0===this.DataRelations.length&&0===this.GroupByFields.length&&null!==this.RowDetailDisplayFunction&&t.addClass(this.RowDetailDisplayViewResponsiveCondition.GetClassName())),1<this.GroupByFields.length&&((t=$("<th class='soby_gridheadercell' style='padding:5px;text-align:center'></th>")).attr("colspan",this.GroupByFields.length-1),e.append(t));for(var i=0;i<this.Columns.length;i++)!0!==this.GroupByFields.ContainsField(this.Columns[i].FieldName)&&this.AddHeaderCell(e,this.Columns[i],null)},t.prototype.ChangeTheme=function(e){$(".sobyitemdialog").removeClass(this.ThemeClassName),$(".sobygridmenu").removeClass(this.ThemeClassName),$(".soby_grid").removeClass(this.ThemeClassName),this.ThemeName=e,this.ThemeClassName=e,$(".sobyitemdialog").addClass(this.ThemeClassName),$(".sobygridmenu").addClass(this.ThemeClassName),$(".soby_grid").addClass(this.ThemeClassName)},t.prototype.ShowHeaderRowMenuIcon=function(e){$(this.ContentDivSelector+" th .headerrowmenuiconcontainer").hide(),!1===$(this.ContentDivSelector+" th[fieldName='"+e+"']").hasClass("hidemenu")&&$(this.ContentDivSelector+" th[fieldName='"+e+"'] .headerrowmenuiconcontainer").show()},t.prototype.HideHeaderRowMenuIcon=function(e){$(this.ContentDivSelector+" th[fieldName='"+e+"'] .headerrowmenuiconcontainer").hide()},t.prototype.HideHeaderRowMenu=function(e){},t.prototype.ShowHeaderRowMenu=function(e,t,i,s){if(this.ActionInProgress=!0,setTimeout(function(){var e=soby_GetActiveDataGrid();null!==e&&(e.ActionInProgress=!1)},1e3),!1!==i||!1!==s){var a=this.GridID+"_Menu",o=$("#"+a);if(0<o.length&&$("#"+a).remove(),o=$("<table id='"+a+"' class='sobygridmenu "+this.ThemeClassName+"' style='margin-top: 30px;margin-left: 30px;'></table>"),$("#"+this.GridID+" .soby_gridheadercell[fieldname='"+e+"']").append(o),o.html(""),!0===i&&(o.append("<tr><td style='width: 30px;text-align: center;padding-left:5px;padding-right:5px;border-right:1px solid;font-size: 5px;'>&nbsp;</td><td style='padding-right:5px;padding-left:5px;font-size: 5px;'>&nbsp;</td></tr>"),o.append("<tr onclick=\"javascript:soby_WebGrids['"+this.GridID+"'].SortResult('"+e+"', true)\" class='ms-vh2' style='cursor: pointer;'><td style='width: 30px;text-align: center;padding-left:5px;padding-right:5px;border-right:1px solid;'><a href='javascript:void(0)' onclick=\"javascript:soby_WebGrids['"+this.GridID+"'].SortResult('"+e+"', true)\">"+this.SVGImages.GetSortAZUp()+"</a></td><td style='padding-right:5px;padding-left:5px'>Ascending</td></tr><tr onclick=\"javascript:soby_WebGrids['"+this.GridID+"'].SortResult('"+e+"', false)\" class='ms-vh2' style='cursor: pointer;'><td style='width: 30px;text-align: center;padding-left:5px;padding-right:5px;border-right:1px solid;'><a href='javascript:void(0)' onclick=\"javascript:soby_WebGrids['"+this.GridID+"'].SortResult('"+e+"', false)\">"+this.SVGImages.GetSortAZDown()+"</a></td><td style='padding-right:5px;padding-left:5px'>Descending</td></tr><tr><td style='padding-left:5px;border-right:1px solid;;padding-right:5px'>&nbsp;</td><td><hr style='margin-top:5px;margin-bottom:5px;border: 0;border-bottom: 1px dashed #ccc;'></td></tr>")),!0===s){for(var n=0;n<this.Filters.Filters.length;n++)if(!0===this.Filters.Filters[n].ShouldBeClearedOnUIFilterAction&&this.Filters.Filters[n].FieldName===e){o.append("<tr onclick=\"javascript:soby_WebGrids['"+this.GridID+"'].ClearFiltersOn('"+e+"')\" class='ms-vh2' style='cursor: pointer;'><td style='width: 30px;text-align: center;padding-left:5px;padding-right:5px;border-right:1px solid;'><a href='javascript:void(0)' onclick=\"javascript:soby_WebGrids['"+this.GridID+"'].ClearFiltersOn('"+e+"')\">"+this.SVGImages.GetXCircle()+"</a></td><td style='padding-right:5px;padding-left:5px'>Clear filter from "+t+"</td></tr>");break}o.append("<tr class='filterloadingli'  style='width: 30px;padding-left:5px;padding-right:5px;border-right:1px solid;'>&nbsp;<td></td><td style='padding-right:5px;padding-left:5px''>Loading...</td></tr><tr><td  style='width: 30px;text-align: center;padding-left:5px;padding-right:5px;border-right:1px solid;'>&nbsp;</td><td style='text-align:right;padding-right:5px;padding-left:5px;padding-top:5px'><button class='btn btn-primary next applyfilters' type='button' style='width: 70px;padding-top: 5px;' onclick=\"soby_WebGrids['"+this.GridID+"'].ApplyFilters('"+e+"')\">Apply</button></td></tr>")}o.append("<tr><td style='width: 30px;text-align: center;padding-left:5px;padding-right:5px;border-right:1px solid;font-size: 5px;'>&nbsp;</td><td style='padding-top:5px;padding-right:5px;padding-left:5px;font-size: 5px;'>&nbsp;</td></tr>");$(this.ContentDivSelector+" th[fieldName='"+e+"']");setTimeout(function(){o.show()},1e3);for(var r=null,n=0;n<this.Columns.length;n++)this.Columns[n].FieldName===e&&(r=this.Columns[n].FilterControl);i=$("<tr></tr>"),s=soby_guid();if(null!==r)(l=$("<td style='padding-right:5px;padding-left:5px;'></td>")).attr("id",s),r.ContainerClientId=s,i.append("<td style='width: 30px;text-align: center;padding-left:5px;padding-right:5px;border-right:1px solid;'>&nbsp;</td>"),i.append(l);else{for(var l,h="",n=0;n<this.Filters.Filters.length;n++)!0===this.Filters.Filters[n].ShouldBeClearedOnUIFilterAction&&this.Filters.Filters[n].FieldName===e&&(h=this.Filters.Filters[n].Value);(l=$("<td style='padding-top:5px;padding-right:5px;padding-left:5px;text-align:right'></td>")).attr("id",s);s=$("<input type='text' class='filtertextbox' style='width:100px' fieldname='"+e+"' />");s.keydown(function(e){13===e.which&&(e.preventDefault(),$("#"+a+" .applyfilters").click())}),s.val(h),l.append(s),i.append("<td style='width: 30px;text-align: center;padding-left:5px;padding-right:5px;border-right:1px solid;'>&nbsp;</td>"),i.append(l)}i.insertBefore("#"+a+" .filterloadingli"),$("#"+a+" .filterloadingli").hide(),null!==r&&r.Initialize()}},t.prototype.ApplyFilters=function(e){var t,i;this.HideHeaderRowMenu(null);for(var s=null,a=0;a<this.Columns.length;a++)this.Columns[a].FieldName===e&&(s=this.Columns[a].FilterControl);for(a=0;a<this.DataService.DataSourceBuilder.SchemaFields.length;a++){var o=this.DataService.DataSourceBuilder.SchemaFields[a];o.FieldName===e&&(i=(t=o.FieldType)===SobyFieldTypes.Number?SobyFilterTypes.Equal:SobyFilterTypes.Contains)}if(null!==s)this.FilterResultWithMultipleValues(e,s.GetValue(),t,i,!0);else if(0<$("input.filtertextbox[fieldname='"+e+"']").length){var n=$("input.filtertextbox[fieldname='"+e+"']").val();this.FilterResult(e,n,t,i,!0)}else{var r=[],l=$("input[type='checkbox'][fieldname='"+e+"']:checked");if(0!==l.length){for(a=0;a<l.length;a++)r[r.length]=$(l[a]).val();this.FilterResultWithMultipleValues(e,r,t,i,!0)}}},t.prototype.Initialize=function(e){$(this.ContentDivSelector).attr("onclick","soby_WebGrids['"+this.GridID+"'].Activate()"),$(this.ContentDivSelector).attr("gridid",this.GridID);for(var t=0,i=0;i<this.Columns.length;i++)t++;!0===this.IsSelectable&&t++,this.CellCount=t;var s=$("<"+this.TableTagName+" width='100%' id='"+this.GridID+"' class='soby_grid "+this.ThemeClassName+" "+this.TableAdditionalClassNames+(!0===this.IsScrollable?" soby_scrollable ":"")+"' onclick=\"javascript:soby_WebGrids['"+this.GridID+"'].Activate()\"></"+this.TableTagName+">"),a=$("<"+this.TBodyTagName+" class='gridbody'></"+this.TBodyTagName+">"),o=$("<"+this.THeadTagName+" class='gridhead'></"+this.THeadTagName+">"),n=$("<"+this.TFootTagName+" class='gridfoot'></"+this.TFootTagName+">"),r=$("<"+this.RowTagName+" class='soby_gridheaderrow'></"+this.RowTagName+">"),l=$("<"+this.RowTagName+" class='emptydatarow' style='display:none'></"+this.RowTagName+">");l.append("<"+this.CellTagName+" colspan='"+this.CellCount+"'>"+this.EmptyDataHtml+"</"+this.CellTagName+">");var h=$("<"+this.RowTagName+" class='loadingrow' style='display:none'></"+this.RowTagName+">");h.append("<"+this.CellTagName+" colspan='"+this.CellCount+"'>"+this.SVGImages.GetLoading()+" Loading...</"+this.CellTagName+">");var d=$("<"+this.RowTagName+" class='actionpanerow'></"+this.RowTagName+">");d.append("<"+this.CellTagName+" class='actionpane' style='border: solid 1px gray;' colspan='"+this.CellCount+"'></"+this.CellTagName+">");var c=$("<"+this.RowTagName+" class='groupbypanerow'></"+this.RowTagName+">");c.append("<"+this.CellTagName+" class='groupbypane' style='border: solid 1px gray;' colspan='"+this.CellCount+"'></"+this.CellTagName+">");var u=$("<"+this.RowTagName+"></"+this.RowTagName+">");u.append("<"+this.CellTagName+" class='filterpane' style='border: solid 1px gray;background-color: lightgreen;' colspan='"+this.CellCount+"'></"+this.CellTagName+">");var p=$("<"+this.RowTagName+" class='soby_gridnavigationrow'></"+this.RowTagName+">");p.append("<"+this.CellTagName+" class='navigationpane' colspan='"+this.CellCount+"'></"+this.CellTagName+">"),o.append(c),o.append(d),o.append(u),o.append(r),o.append(h),a.append(l),n.append(p),s.append(o),s.append(a),s.append(n),$(this.ContentDivSelector).html(""),!0===this.DisplayTitle&&((n=$("<div class='soby_tabletitle'></div>").text(this.Title)).attr("title",this.AltTitle),$(this.ContentDivSelector).append(n)),$(this.ContentDivSelector).append(s),$(this.ContentDivSelector).append("<div style='display:none' class='tempdatadiv'></div>"),$(this.ContentDivSelector).append("<canvas style='display:none' class='soby_webgridcanvas' width='200' height='200'></canvas>");var y=this;this.DataService.ItemPopulated=function(e){y.PopulateGridData(e)},this.DataService.ErrorThrown=function(e,t){y.DisplayErrorMessage(e)},this.DataService.ItemBeingPopulated=function(){$(y.ContentDivSelector+" .loadingrow").show()},this.DataService.NavigationInformationPopulated=function(){y.GenerateNavigationPane()},this.DataService.NavigationInformationBeingPopulated=function(){$(y.ContentDivSelector+" .navigationpane .loadingrow").show()},this.DataService.ItemUpdated=function(e){y.HideItemDialog(),y.Initialize(!0)},this.DataService.ItemAdded=function(e){y.HideItemDialog(),y.Initialize(!0)},this.DataService.ItemDeleted=function(e){y.HideItemDialog(),y.Initialize(!0)},!0===e?0<this.OrderByFields.length&&0<this.Filters.Filters.length?this.DataService.SortAndFilter(this.OrderByFields,this.Filters,!0):0<this.OrderByFields.length?this.DataService.Sort(this.OrderByFields):0<this.Filters.Filters.length?this.DataService.Filter(this.Filters,!0):this.DataService.PopulateItems(null):(!0===this.ShowHeader&&this.PopulateHeaderCells(),this.InitializeActionPaneButtons(),this.GenerateActionPane(),this.SetActionPaneButtonsVisibility(),$(this.ContentDivSelector+" .emptydatarow td").html("&nbsp;Please search to display data."),$(this.ContentDivSelector+" .emptydatarow").show())},t.prototype.PopulateAggregateRowValues=function(e){for(var t=0,i=parseInt(e.attr("level")),s=e.prev(),a=[];0<s.length;){if(!0===s.hasClass("soby_griddatarow")){for(var o=parseInt(s.attr("rowindex")),n=this.Items[o],r=0;r<this.AggregateFields.length;r++){var l=n[this.AggregateFields[r].FieldName],h=this.AggregateFields[r].AggregateType+this.AggregateFields[r].FieldName;0===t?a[h]=l:this.AggregateFields[r].AggregateType===SobyAggregateTypes.Average||this.AggregateFields[r].AggregateType===SobyAggregateTypes.Sum?a[h]=a[h]+l:this.AggregateFields[r].AggregateType===SobyAggregateTypes.Max?l>a[h]&&(a[h]=l):this.AggregateFields[r].AggregateType===SobyAggregateTypes.Min&&l<a[h]&&(a[h]=l)}t++}else if(!0===s.hasClass("soby_gridgroupbyrow")&&parseInt(s.attr("level"))<=i||!0===s.hasClass("soby_gridheaderrow")){for(r=0;r<this.AggregateFields.length;r++){h=this.AggregateFields[r].AggregateType+this.AggregateFields[r].FieldName;this.AggregateFields[r].AggregateType===SobyAggregateTypes.Average?a[h]=a[h]/t:this.AggregateFields[r].AggregateType===SobyAggregateTypes.Count&&(a[h]=t),e.find(".soby_gridaggregatevaluecontainer[fieldname='"+this.AggregateFields[r].FieldName+"'][aggregatetype='"+this.AggregateFields[r].AggregateType+"'] .aggregatetypevalue").text(a[h])}return}s=s.prev()}},t.prototype.PopulateAggregateRowsValues=function(){for(var e=$(this.ContentDivSelector+" .soby_gridaggregatesrow"),t=0;t<e.length;t++){var i=$(e[t]);this.PopulateAggregateRowValues(i)}},t.prototype.PopulateAggregateRow=function(e,t,i){var s=$("<tr class='soby_gridaggregatesrow'></tr>");s.attr("level",t),!0===i&&(i=$("<td>&nbsp;</td>"),s.append(i));for(var a=0;a<this.Columns.length;a++)if(!1!==this.Columns[a].IsVisible){for(var o,n=$("<td class='soby_gridaggregatecell'>&nbsp;</td>"),r=0;r<this.AggregateFields.length;r++)this.AggregateFields[r].FieldName===this.Columns[a].FieldName&&((o=$("<div class='soby_gridaggregatevaluecontainer'></div>")).attr("fieldname",this.AggregateFields[r].FieldName),o.attr("aggregatetype",this.AggregateFields[r].AggregateType),o.html("<span class='aggregatetypename'></span><span class='aggregatetypevalue'></span>"),o.find(".aggregatetypename").text(SobyAggregateTypes.GetAggregateTypeName(this.AggregateFields[r].AggregateType)+":"),n.append(o));s.append(n)}e.before(s)},t.prototype.PopulateAggregateRows=function(){if(0!==this.AggregateFields.length&&0!==$(this.ContentDivSelector+" .soby_griddatarow").length){var e=!1;0<$(this.ContentDivSelector+" .soby_selectitemcell").length&&(e=!0);for(var t=!1,i=0,s=0,a=(a=$(this.ContentDivSelector+" tbody tr:first")).next();0<a.length;){if(!0===a.hasClass("soby_griddatarow"))t=!0;else if(!0===a.hasClass("soby_gridgroupbyrow")||!0===a.hasClass("soby_gridnavigationrow")){if(s=!1===a.hasClass("soby_gridnavigationrow")?parseInt(a.attr("level")):0,!0===t)for(var o=i;s-1<o;o--)this.PopulateAggregateRow(a,o,e);i=s}a=a.next()}this.PopulateAggregateRowsValues()}},t.prototype.PopulateGroupByRow=function(e,t,i){for(var s=null,a=!1,o=0;o<this.GroupByFields.length;o++){var n=null,n=null!==this.GroupByFields[o].DisplayFunction&&void 0!==this.GroupByFields[o].DisplayFunction?this.GroupByFields[o].DisplayFunction(t):t[this.GroupByFields[o].FieldName];if(0===e||!0===a||this.LastGroupByValues["Level_"+o].Value!==n){a=!0,this.LastGroupByValues["Level_"+o]={Level:o,Value:n};var r=this.GroupByFields[o].FieldName,l=this.GetColumn(this.GroupByFields[o].FieldName);null!==l&&(r=l.DisplayName);var h="soby_gridgrouprow_"+soby_guid(),d=$("<tr class='soby_gridgroupbyrow'></tr>");if(d.attr("id",h),d.attr("level",o),0===o&&d.addClass("first"),0<o)for(var c=0;c<o;c++){var u=$("<td>&nbsp;</td>");d.append(u)}l=$("<td class='soby_gridgroupbycell'></td>");l.html("<a class='toggler' href='javascript:void(0)' onclick=\"javascript:soby_WebGrids['"+this.GridID+"'].ExpandGroupBy('"+h+"')\"> "+this.SVGImages.GetCollapse()+"</a>");h=this.Columns.length-o;(!0===this.IsSelectable||0<this.DataRelations.length)&&h++,l.attr("colspan",h),l.append("&nbsp;"+r+": "+n),d.append(l),$(this.ContentDivSelector+" .soby_gridnavigationrow").before(d),s=d}}return 1<this.GroupByFields.length&&((u=$("<td>&nbsp;</td>")).attr("colspan",this.GroupByFields.length-1),i.append(u)),s},t.prototype.ExpandGroupBy=function(e){var e=$("#"+e),t=e.next().is(":visible");e.find("a").html(!0===t?this.SVGImages.GetExpand():this.SVGImages.GetCollapse());var i=e.next();if(!0===i.hasClass("soby_gridgroupbyrow"))for(var s=parseInt(e.attr("level")),a=!1;!1===a;){var o=parseInt(i.attr("level"));if(!0===i.hasClass("soby_gridgroupbyrow")&&o<=s){a=!0;break}if(i.hasClass("soby_gridgroupbyrow")&&(this.ExpandGroupBy(i.attr("id")),!0===t?i.hide():i.show()),0===(i=i.next()).length){a=!0;break}}else for(;!0===i.hasClass("soby_griddatarow")||!0===i.hasClass("soby_gridaggregatesrow");)!0===t?i.hide():i.show(),i=i.next()},t.prototype.PopulateDetailRow=function(e){if(0!==this.DataRelations.length||null!==this.RowDetailDisplayFunction){var t=$("<tr class='soby_griddetailrow'></tr>");t.attr("mainrowid",e);var i,s,a=$("<td colspan='"+this.CellCount+"' class='detailgridcell' style='display:none'></td>");null!==this.RowDetailDisplayFunction&&(s=$("#"+e).attr("rowindex"),i=this.Items[s],(s=$("<div class='soby_gridrowmaindetail'></div>")).html(this.RowDetailDisplayFunction(this,e,i)),a.append(s));var o=$("<div class='soby_gridtabheaderpanel'></div>");a.append(o);for(var n=0;n<this.DataRelations.length;n++){var r=this.DataRelations[n],l=$("<div class='soby_tabheader' index='"+n+"'><a href='javascript:void(0)' onclick=\"soby_WebGrids['"+this.GridID+"'].SelectDetailGridTab('"+e+"', '"+n+"')\">"+soby_WebGrids[r.DetailGridID].Title+"</a></div>");l.attr("title",soby_WebGrids[r.DetailGridID].AltTitle);var h=$("<div style='display:none' class='soby_tabcontent'></div>");0===n&&(h.show(),l.addClass("active")),h.attr("id",e+"_"+r.DetailGridID),h.attr("index",n),o.append(l),a.append(h)}t.append("<td></td>"),t.append(a),$("#"+e).after(t)}},t.prototype.PopulateSelectionCell=function(e,t,i){if(!0===this.IsSelectable||0<this.DataRelations.length||null!==this.RowDetailDisplayFunction){var s=$("<td valign='top' style='padding:5px;' width='20px' class='soby_selectitemcell'></td>");!0===this.IsSelectable&&(t.addClass("soby-itmHoverEnabled"),a="soby_WebGrids['"+this.GridID+"'].SelectRow('"+i+"');",(o=$("<a href='javascript:void(0)' class='soby-list-selectitem-a'>"+this.SVGImages.GetCheck()+"</a>")).attr("onclick",a),s.append(o));for(var a,o,n="",r="",l="",h="",d=0;d<this.DataRelations.length;d++){var c=this.DataRelations[d],u=e[c.MasterFieldValueName];n+=c.DetailGridID+soby_FilterValueSeperator,r+="#"+i+"_"+c.DetailGridID+soby_FilterValueSeperator,l+=c.DetailFieldName+soby_FilterValueSeperator,h+=u+soby_FilterValueSeperator}""!==n?(n=n.substring(0,n.length-soby_FilterValueSeperator.length),r=r.substring(0,r.length-soby_FilterValueSeperator.length),l=l.substring(0,l.length-soby_FilterValueSeperator.length),h=h.substring(0,h.length-soby_FilterValueSeperator.length),a="soby_WebGrids['"+this.GridID+"'].PopulateDetailGrid('"+n+"','"+r+"', '"+i+"', '"+l+"', '"+h+"');",(o=$("<a href='javascript:void(0)'>"+this.SVGImages.GetCardView()+"</a>")).attr("onclick",a),s.append(o)):null!==this.RowDetailDisplayFunction&&(a="soby_WebGrids['"+this.GridID+"'].PopulateDetailGrid('','', '"+i+"', '', '');",(o=$("<a href='javascript:void(0)'>"+this.SVGImages.GetCardView()+"</a>")).attr("onclick",a),null!==this.RowDetailDisplayViewResponsiveCondition&&(!1===this.IsSelectable?s:o).addClass(this.RowDetailDisplayViewResponsiveCondition.GetClassName()),s.append(o)),t.append(s)}},t.prototype.GenerateConteFromCellTemplate=function(e,t){for(var i=this.Items[t],s=this.Columns[e],a=s.CellTemplate.Template,o=[],n=a;-1<n.indexOf("#{");){var r=n.indexOf("#{");if(-1===r)break;var l=n.indexOf("}",r);if(-1===l)break;o.push(n.substr(r+2,l-r-2)),n=n.substr(l)}for(var h=0;h<o.length;h++)try{for(var d=o[h].split("."),c=i[d[0]],u=1;u<d.length;u++)null!==c&&(c=c[d[u]]);var p=new RegExp("#{"+o[h]+"}","ig");null===(c=null!==s.CellTemplate.ValueDisplayFunction&&void 0!==s.CellTemplate.ValueDisplayFunction?s.CellTemplate.ValueDisplayFunction(o[h],c):c)&&(c=""),a=a.replace(p,c)}catch(e){soby_LogMessage(e)}return a},t.prototype.PopulateCellTemplateContent=function(e,t,i){var s,a=$("#"+e+" .popup_content"),o=a.html();null!==o&&""!==o||(s=this.Columns[t],o=this.GenerateConteFromCellTemplate(t,i),"PopupContent"===s.CellTemplate.TemplateType&&(t=$("<table></table>"),i=$("<tr></tr>"),(s=$("<td style='width:95%'></td>")).append(o),i.append(s),i.append("<td style='vertical-align: top;width:20px;'><a href='javascript:void(0)' onclick=\"soby_WebGrids['"+this.GridID+"'].HideCellPopupContent('"+e+"')\">x</a></td>"),t.append(i),a.append(t)))},t.prototype.PopulateViewColumns=function(e,t,i,s){for(var a=0,o=0;o<this.Columns.length;o++)if(!1!==this.Columns[o].IsVisible&&!0!==this.GroupByFields.ContainsField(this.Columns[o].FieldName)){var n,r,l,h="soby_gridcell_"+soby_guid(),d="";null!==this.Columns[o].DisplayFunction?d=this.Columns[o].DisplayFunction(e,i,h):null!==this.Columns[o].CellTemplate?"CellContent"===this.Columns[o].CellTemplate.TemplateType?d=this.GenerateConteFromCellTemplate(o,s):"PopupContent"===this.Columns[o].CellTemplate.TemplateType&&(l=this.Columns[o].CellTemplate.PopupLinkText,(n=$("<a href='javascript:void(0)'></a>").html(l)).attr("onclick","soby_WebGrids['"+this.GridID+"'].ShowCellPopupContent('"+h+"', "+o+", "+s+")"),r=$("<div style='display:none;position: absolute;padding: 10px;border: 1px solid;background-color: white;padding-top: 0px;overflow: auto;' class='popup_content'></div>"),(l=$("<div></div>")).append(n),l.append(r),d=l.html()):d=l=(l=e[this.Columns[o].FieldName])instanceof Date?(9<l.getDate()?l.getDate():"0"+l.getDate())+"/"+(l.getMonth()+1)+"/"+l.getFullYear()+" "+(9<l.getHours()?l.getHours():"0"+l.getHours())+":"+(9<l.getMinutes()?l.getMinutes():"0"+l.getMinutes())+":"+(9<l.getSeconds()?l.getSeconds():"0"+l.getSeconds()):l;var c=$("<"+this.CellTagName+" class='soby_gridcell "+this.CellAdditionalClassNames+"' valign='top' style='padding:5px;'></"+this.CellTagName+">").html(d);if(null!==this.Columns[o].ResponsiveConditionID&&""!==this.Columns[o].ResponsiveConditionID&&c.addClass(this.GetResponsiveConditionById(this.Columns[o].ResponsiveConditionID).GetClassName()),c.attr("id",h),c.attr("cellindex",a),c.attr("columnindex",o),c.attr("rowid",i),c.attr("onclick","soby_WebGrids['"+this.GridID+"'].SelectCell('"+i+"', "+a+")"),null!==this.Columns[o].CellCss&&void 0!==this.Columns[o].CellCss&&""!==this.Columns[o].CellCss)for(var u=this.Columns[o].CellCss.split(";"),p=0;p<u.length;p++){var y=u[p].split(":")[0],g=u[p].split(":")[1];c.css(y,g)}null!==this.Columns[o].CellClassNames&&""!==this.Columns[o].CellClassNames&&c.addClass(this.Columns[o].CellClassNames),t.append(c),a++}},t.prototype.FocusToFirstItem=function(){0<this.Items.length&&$(this.ContentDivSelector+" .soby_griddatarow a:visible:first").focus()},t.prototype.DisplayErrorMessage=function(e){this.Items=null,this.InitializeActionPaneButtons(),!0===this.ShowHeader&&this.PopulateHeaderCells(),this.LastGroupByValues=[];$(this.ContentDivSelector+" .soby_grid");$(this.ContentDivSelector+" .soby_griddatarow").remove(),$(this.ContentDivSelector+" .soby_griddetailrow").remove(),$(this.ContentDivSelector+" .soby_gridgroupbyrow").remove(),$(this.ContentDivSelector+" .soby_gridaggregatesrow").remove(),$(this.ContentDivSelector+" .loadingrow").hide(),$(this.ContentDivSelector+" .soby_errorrow").show();var t,i=$(this.ContentDivSelector+" .soby_errorrow");0===i.length&&(i=$("<"+this.RowTagName+" class='soby_errorrow "+this.RowAdditionalClassNames+"'></"+this.RowTagName+">"),t=$("<"+this.CellTagName+" colspan='"+this.CellCount+"'></"+this.CellTagName+">"),i.append(t),$(this.ContentDivSelector+" "+this.TBodyTagName).append(i)),i.find(this.CellTagName).html(e)},t.prototype.PopulateGridData=function(e){this.Items=e,null!==this.OnGridDataBeingParsed&&this.OnGridDataBeingParsed(),e=this.Items,this.InitializeActionPaneButtons(),!0===this.ShowHeader&&this.PopulateHeaderCells(),this.LastGroupByValues=[];$(this.ContentDivSelector+" .soby_grid");$(this.ContentDivSelector+" .emptydatarow").hide(),$(this.ContentDivSelector+" .soby_errorrow").hide(),$(this.ContentDivSelector+" .soby_griddatarow").remove(),$(this.ContentDivSelector+" .soby_griddetailrow").remove(),$(this.ContentDivSelector+" .soby_gridgroupbyrow").remove(),$(this.ContentDivSelector+" .soby_gridaggregatesrow").remove();for(var t=null,i=0;i<e.length;i++){var s="soby_griddatarow_"+soby_guid(),a=$("<"+this.RowTagName+" class='soby_griddatarow "+this.RowAdditionalClassNames+"'></"+this.RowTagName+">");i%2==0&&a.addClass("alt"),a.attr("id",s),a.attr("rowindex",i);var o=e[i],n=this.PopulateGroupByRow(i,o,a);null!==n&&(t=n),this.PopulateSelectionCell(o,a,s),this.PopulateViewColumns(o,a,s,i),null===t?$(this.ContentDivSelector+" "+this.TBodyTagName).append(a):t.after(a),null!==this.OnGridRowPopulated&&this.OnGridRowPopulated(s,o),this.PopulateDetailRow(s)}$(this.ContentDivSelector+" .loadingrow").hide(),0===e.length&&($(this.ContentDivSelector+" .emptydatarow "+this.CellTagName).html(this.EmptyDataHtml),$(this.ContentDivSelector+" .emptydatarow").show()),this.PopulateAggregateRows(),this.GenerateGroupByPanePane(),this.GenerateActionPane(),this.GenerateFilterPane(),this.DataService.PopulateNavigationInformation(),this.ApplyResponsiveElementsVisibility(),null!==this.OnGridPopulated&&this.OnGridPopulated(),this.SetActionPaneButtonsVisibility(),!0===this.NavigationActionInProgress&&(this.NavigationActionInProgress=!1,this.FocusToFirstItem())},t}();$.fn.sobywebgrid=function(){var e,t=this.attr("id");for(e in soby_WebGrids)if(soby_WebGrids[e].ContentDivSelector==="#"+t)return soby_WebGrids[e];return null};var soby_DataRepeater=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ItemDataBound=null,e.MaxCellCount=1,e.ShouldContainRowElement=!0,e}return __extends(e,t),e.prototype.GetSelectedDataItems=function(){for(var e=$(this.ContentDivSelector+" .soby_griddatarow .soby_gridcell.selected"),t=[],i=0;i<e.length;i++){var s=$(e[i]).attr("cellindex");t[t.length]=this.Items[s]}return t},e.prototype.SelectCell=function(e,t){for(var i=-1,s=$(this.ContentDivSelector+" .soby_gridcell[cellindex='"+t+"']").attr("id"),a=this.GetSelectedCellIds(),o=0;o<a.length;o++)if(a[o]===s){i=o;break}-1<i?$("#"+a[i]).removeClass("selected"):(!0===this.AllowMultipleSelections&&!0===soby_IsCtrlOnHold||$(this.ContentDivSelector+" .soby_griddatarow").removeClass("selected"),$("#"+s).addClass("selected")),this.GenerateActionPane(),this.SelectDetailGridTab(s,0),null!==this.OnRowSelected&&this.OnRowSelected(this,s),null!==this.OnCellSelected&&this.OnCellSelected(this,e,t),this.SetActionPaneButtonsVisibility()},e.prototype.SelectRowByIndex=function(e){e=$(this.ContentDivSelector+" .soby_griddatarow:eq("+e+")").attr("id");this.SelectRow(e)},e.prototype.PopulateGridData=function(e){this.Items=e,this.InitializeActionPaneButtons(),!0===this.ShowHeader&&this.PopulateHeaderCells();$(this.ContentDivSelector+" .soby_grid");$(this.ContentDivSelector+" .soby_griddatarow").remove(),$(this.ContentDivSelector+" .soby_griddetailrow").remove(),$(this.ContentDivSelector+" .soby_gridgroupbyrow").remove(),$(this.ContentDivSelector+" .soby_gridaggregatesrow").remove();var t=null,i=null,s=null,a=-1;!0===this.ShouldContainRowElement&&(i=$(this.ContentDivSelector+" "+this.TBodyTagName));for(var o=-1,n=0;n<e.length;n++){o++,!0===this.ShouldContainRowElement&&o%this.MaxCellCount==0&&(a++,s="soby_griddatarow_"+soby_guid(),i=$("<"+this.RowTagName+" class='soby_griddatarow "+this.RowAdditionalClassNames+"'></"+this.RowTagName+">"),n%2==0&&i.addClass("alt"),i.attr("id",s),i.attr("rowindex",a));var r=e[n],l=this.PopulateGroupByRow(n,r,i);null!==l&&(t=l);var h="soby_gridcell_"+soby_guid(),l=$("<"+this.CellTagName+" class='soby_gridcell "+this.CellAdditionalClassNames+"' valign='top' style='padding:5px;'></"+this.CellTagName+">").html(this.ItemDataBound(h,r));l.attr("id",h),l.attr("cellindex",o),l.attr("columnindex",o%this.MaxCellCount),!0===this.IsSelectable&&l.attr("onclick","soby_WebGrids['"+this.GridID+"'].SelectCell('"+s+"', "+o+")"),i.append(l),null===t?$(this.ContentDivSelector+" "+this.TBodyTagName).append(i):t.after(i),null!==this.OnGridRowPopulated&&this.OnGridRowPopulated(s,r),this.PopulateDetailRow(s)}$(this.ContentDivSelector+" .loadingrow").hide(),0===e.length&&($(this.ContentDivSelector+" .emptydatarow td").html(this.EmptyDataHtml),$(this.ContentDivSelector+" .emptydatarow").show()),this.PopulateAggregateRows(),this.GenerateGroupByPanePane(),this.GenerateActionPane(),this.GenerateFilterPane(),this.DataService.PopulateNavigationInformation(),null!==this.OnGridPopulated&&this.OnGridPopulated(),this.SetActionPaneButtonsVisibility()},e}(soby_WebGrid),soby_Carousels=[],soby_Carousel=function(){function e(e,t,i,s,a,o,n,r){this.OnGridPopulated=null,this.OnRowSelected=null,this.OnCellSelected=null,this.CarouselID="soby_carousel_"+soby_guid(),this.MaxWidth=null,this.Items=null,this.ItemDataBound=null,this.SVGImages=new soby_SVGImages,this.ContentDivSelector=e,this.Title=t,this.DataService=i,this.EmptyDataHtml=s,this.ImageFieldName=a,this.CaptionFieldName=o,this.ContentFieldName=n,this.IsContentFieldUrl=r,this.EnsureCarouselExistency()}return e.prototype.EnsureCarouselExistency=function(){for(var e in soby_Carousels)if(e===this.CarouselID)return;soby_Carousels[this.CarouselID]=this},e.prototype.GoToItem=function(e){$(this.ContentDivSelector+" .carouselindicator").removeClass("active"),$(this.ContentDivSelector+" .item").removeClass("active"),$(this.ContentDivSelector+" .item[index='"+e+"']").addClass("active"),$(this.ContentDivSelector+" .carouselindicator[index='"+e+"']").addClass("active")},e.prototype.NextItem=function(){var e=parseInt($(this.ContentDivSelector+" .item.active").attr("index"));$(this.ContentDivSelector+" .item").removeClass("active"),$(this.ContentDivSelector+" .carouselindicator").removeClass("active");e+=1;e>=this.Items.length&&(e=0),$(this.ContentDivSelector+" .item[index='"+e+"']").addClass("active"),$(this.ContentDivSelector+" .carouselindicator[index='"+e+"']").addClass("active")},e.prototype.PreviousItem=function(){var e=parseInt($(this.ContentDivSelector+" .item.active").attr("index"));$(this.ContentDivSelector+" .item").removeClass("active"),$(this.ContentDivSelector+" .carouselindicator").removeClass("active");e-=1;e<0&&(e=this.Items.length-1),$(this.ContentDivSelector+" .item[index='"+e+"']").addClass("active"),$(this.ContentDivSelector+" .carouselindicator[index='"+e+"']").addClass("active")},e.prototype.PopulateIndicators=function(e,t){for(var i=$("<ol class='carousel-indicators'></ol>"),s=0;s<t.length;s++)i.append("<li class='carouselindicator' index='"+s+"' onclick=\"soby_Carousels['"+this.CarouselID+"'].GoToItem("+s+')"></li>');$("#"+e).append(i)},e.prototype.PopulateItems=function(e,t){for(var i=$("<div class='carousel-inner'></div>"),s=0;s<t.length;s++){var a=$("<div class='item'></div>");a.attr("index",s),a.html(this.ItemDataBound(s,t[s])),i.append(a)}$("#"+e).append(i)},e.prototype.PopulateNavigator=function(e){$("#"+e).append("<a class='prev' href='#"+e+"' role='button' data-slide='prev' onclick=\"soby_Carousels['"+this.CarouselID+"'].PreviousItem()\"></a> \t\t\t  <a class='next' href='#"+e+"' role='button' data-slide='next' onclick=\"soby_Carousels['"+this.CarouselID+"'].NextItem()\"></a>")},e.prototype.PopulateGridData=function(e){$("#"+this.CarouselID).html(""),this.Items=e,this.PopulateIndicators(this.CarouselID,this.Items),this.PopulateItems(this.CarouselID,this.Items),this.PopulateNavigator(this.CarouselID),this.GoToItem(0)},e.prototype.Initialize=function(e){var t=this.CarouselID,i=$("<div class='soby_carousel slide' data-ride='carousel' id='"+t+"'></div>");null!==this.MaxWidth&&0<this.MaxWidth&&i.css("max-width",this.MaxWidth),$(this.ContentDivSelector).html(""),$(this.ContentDivSelector).append(i);var s=this;this.DataService.ItemPopulated=function(e){s.PopulateGridData(e)},this.DataService.ItemBeingPopulated=function(){$("#"+t).html(s.SVGImages.GetLoading()+" Loading...")},!0===e&&this.DataService.PopulateItems()},e}(),soby_MetroTileGrids=[],soby_MetroTilesGrid=function(){function e(e,t,i,s,a,o,n,r,l,h,d,c){this.MetroTileGridID="soby_metrotilegrid_"+soby_guid(),this.MaxWidth=null,this.TileWidth=150,this.TileHeight=120,this.Width="600px",this.Items=null,this.SVGImages=new soby_SVGImages,this.ContentDivSelector=e,this.Title=t,this.DataService=i,this.EmptyDataHtml=s,this.ImageFieldName=a,this.CaptionFieldName=o,this.URLFieldName=n,this.OpenInNewWindowFieldName=r,this.StartColorFieldName=l,this.EndColorFieldName=h,this.RowSpanFieldName=c,this.ColSpanFieldName=d,this.EnsureMetroTilesExistency()}return e.prototype.EnsureMetroTilesExistency=function(){for(var e in soby_MetroTileGrids)if(e===this.MetroTileGridID)return;soby_MetroTileGrids[this.MetroTileGridID]=this},e.prototype.PopulateItems=function(e){for(var t=$("<div class='metro-tiles' style='width:"+this.Width+"'></div>"),i=0;i<e.length;i++){var s=e[i][this.ImageFieldName];-1<s.indexOf(",")&&(s=s.split(",")[0]);var a=e[i][this.CaptionFieldName],o=e[i][this.URLFieldName];-1<o.indexOf(",")&&(o=o.split(",")[0]);var n=e[i][this.OpenInNewWindowFieldName],r=e[i][this.StartColorFieldName],l=e[i][this.EndColorFieldName],h=parseInt(e[i][this.RowSpanFieldName]);!0===isNaN(h)&&(h=1);var d=parseInt(e[i][this.ColSpanFieldName]);!0===isNaN(d)&&(d=1);var c=this.TileWidth*d+10*(d-1),d=this.TileHeight*h+10*(h-1),h=$("<div class='metro-tile'></div>");h.css("background","linear-gradient(to right, "+r+","+l+")"),h.attr("index",i),h.css("width",c+"px"),h.css("height",d+"px");c=$("<a></a>");c.attr("href",o),"1"===n&&c.attr("target","_blank");d=$("<img alt='...' class='metro-tileimage'>");d.attr("src",s),c.append(d),h.append(c);d=$("<div class='metro-tilecaption'></div>"),c=$("<a></a>");c.attr("href",o),c.text(a),"1"===n&&c.attr("target","_blank"),d.append(c),h.append(d),t.append(h)}$("#"+this.MetroTileGridID).append(t)},e.prototype.Initialize=function(e){var t=$("<div class='soby_metrotilegrid' id='"+this.MetroTileGridID+"'></div>");null!==this.MaxWidth&&""!==this.MaxWidth&&t.css("max-width",this.MaxWidth),$(this.ContentDivSelector).html(""),$(this.ContentDivSelector).append(t);var i=this;this.DataService.ItemPopulated=function(e){i.ItemPopulated(e),i.PopulateItems(e)},this.DataService.ItemBeingPopulated=function(){$("#"+this.MetroTileGridID).html(this.SVGImages.GetLoading()+" Loading...")},!0===e&&this.DataService.PopulateItems()},e.prototype.ItemPopulated=function(e){},e}(),soby_Wizards=[],soby_Wizard=function(e){this.AutoPopulateStepNumbersOnHeaders=!0,this.WizardID="",this.ContentDivSelector="",this.CurrentStepIndex=-1,this.TempStepIndex=-1,this.MaxWidth=null,this.TileWidth="150",this.TileHeight="120",this.Width="600",this.Items=null,this.EnsureWizardsExistency=function(){for(var e in soby_Wizards)if(e===this.WizardID)return;soby_Wizards[this.WizardID]=this},this.GetItemById=function(e){for(var t=0;t<this.Items.length;t++)if(this.Items[t].LinkId===e)return this.Items[t];return null},this.ActivateWizardStep=function(e){var t=this.GetItemById(e);$(this.ContentDivSelector+" a.sobywizardsteplink").removeClass("active"),$(this.ContentDivSelector+" > ul > li a[linkid='"+e+"']").addClass("active"),$(".sobywizardstepcontent[wizardid='"+this.WizardID+"']").hide(),$(t.ContainerId).show()},this.GoToNextStep=function(){this.CurrentStepIndex<this.Items.length&&this.GoToStep(this.CurrentStepIndex+1)},this.GoToPreviousStep=function(){0<this.CurrentStepIndex&&this.GoToStep(this.CurrentStepIndex-1)},this.EventBeforeStepChange=null,this.EventAfterStepChange=null,this.GoToStep=function(e){this.CurrentStepIndex!==e&&(this.TempStepIndex=e,null!==this.EventBeforeStepChange?this.EventBeforeStepChange(e):this.CommitToStep())},this.CommitToStep=function(){var e=this.CurrentStepIndex;this.CurrentStepIndex=this.TempStepIndex,$(this.ContentDivSelector+" .sobywizardnavigationbar button").removeAttr("disabled"),0===this.CurrentStepIndex?$(this.ContentDivSelector+" .sobywizardnavigationbar .previous").hide():$(this.ContentDivSelector+" .sobywizardnavigationbar .previous").show(),this.CurrentStepIndex<this.Items.length?$(this.ContentDivSelector+" .sobywizardnavigationbar .next").show():$(this.ContentDivSelector+" .sobywizardnavigationbar .next").hide();var t=this.Items[this.CurrentStepIndex];$(this.ContentDivSelector+" a.sobywizardsteplink").removeClass("active"),$(this.ContentDivSelector+" > ul > li a[linkid='"+t.LinkId+"']").addClass("active");var i=$(".sobywizardstepcontent[wizardid='"+this.WizardID+"']:visible");1===i.length?i.toggle("slide","left",function(){$(t.ContainerId).toggle("slide","right")}):(i.hide(),$(t.ContainerId).toggle("slide","right")),null!==this.EventAfterStepChange&&this.EventAfterStepChange(e,this.CurrentStepIndex)},this.Initialize=function(){$(".sobywizardstepcontent[wizardid='"+this.WizardID+"']:visible").hide(),$(this.ContentDivSelector).addClass("sobywizard");var e=$(this.ContentDivSelector+" > ul > li a");e.addClass("sobywizardsteplink"),this.Items=[];for(var t=0;t<e.length;t++){var i="soby_wizardlink_"+t,s=$(e[t]).attr("href"),a=$(e[t]).text();$(s).addClass("sobywizardstepcontent"),$(s).attr("wizardid",this.WizardID),$(e[t]).attr("wizardid",this.WizardID),$(e[t]).attr("linkid",i),$(e[t]).attr("onclick","soby_Wizards['"+this.WizardID+"'].GoToStep("+t+")"),this.Items[this.Items.length]={Title:a,ContainerId:s,LinkId:i},!0===this.AutoPopulateStepNumbersOnHeaders&&$(e[t]).text(t+1+". "+a)}for(t=0;t<this.Items.length;t++)$(this.Items[t].ContainerId).hide();$(this.ContentDivSelector+" .sobywizardnavigationbar button").attr("wizardid",this.WizardID),$(this.ContentDivSelector+" .sobywizardnavigationbar .previous").click(function(){try{var e=$(this).attr("wizardid");soby_Wizards[e].GoToPreviousStep()}catch(e){}return!1}),$(this.ContentDivSelector+" .sobywizardnavigationbar .next").click(function(){try{var e=$(this).attr("wizardid");soby_Wizards[e].GoToNextStep()}catch(e){}return!1}),this.GoToStep(0)},this.HideNavigationBar=function(){$(this.ContentDivSelector+" .sobywizardnavigationbar").hide()},this.ShowNavigationBar=function(){$(this.ContentDivSelector+" .sobywizardnavigationbar").show()},this.HideStepPanels=function(){$(this.ContentDivSelector+" .sobywizardstepcontent").hide()},this.ShowStepPanels=function(){$(this.ContentDivSelector+" .sobywizardstepcontent").show()},this.WizardID="soby_wizardgrid_"+soby_guid(),this.ContentDivSelector=e,this.EnsureWizardsExistency()},soby_Tabs=[],soby_Tab=function(e){this.AutoPopulateTabNumbersOnHeaders=!1,this.TabID="",this.ContentDivSelector="",this.CurrentTabIndex=-1,this.TempTabIndex=-1,this.MaxWidth=null,this.TileWidth="150",this.TileHeight="120",this.Width="600",this.Items=null,this.EnsureTabsExistency=function(){for(var e in soby_Tabs)if(e===this.TabID)return;soby_Tabs[this.TabID]=this},this.GetItemById=function(e){for(var t=0;t<this.Items.length;t++)if(this.Items[t].LinkId===e)return this.Items[t];return null},this.ActivateTab=function(e){var t=this.GetItemById(e);$(this.ContentDivSelector+" a.sobytablink").removeClass("active"),$(this.ContentDivSelector+" > ul > li a[linkid='"+e+"']").addClass("active"),$(".sobytabcontent[tabid='"+this.TabID+"']").hide(),$(t.ContainerId).show()},this.GoToNextTab=function(){this.CurrentTabIndex<this.Items.length&&this.GoToTab(this.CurrentTabIndex+1)},this.GoToPreviousTab=function(){0<this.CurrentTabIndex&&this.GoToTab(this.CurrentTabIndex-1)},this.EventBeforeTabChange=null,this.EventAfterTabChange=null,this.GoToTab=function(e){this.CurrentTabIndex!==e&&(this.TempTabIndex=e,null!==this.EventBeforeTabChange?this.EventBeforeTabChange(e):this.CommitToTab())},this.CommitToTab=function(){var e=this.CurrentTabIndex;this.CurrentTabIndex=this.TempTabIndex,$(this.ContentDivSelector+" .sobytabnavigationbar button").removeAttr("disabled"),0===this.CurrentTabIndex?$(this.ContentDivSelector+" .sobytabnavigationbar .previous").hide():$(this.ContentDivSelector+" .sobytabnavigationbar .previous").show(),this.CurrentTabIndex<this.Items.length?$(this.ContentDivSelector+" .sobytabnavigationbar .next").show():$(this.ContentDivSelector+" .sobytabnavigationbar .next").hide();var t=this.Items[this.CurrentTabIndex];$(this.ContentDivSelector+" a.sobytablink").removeClass("active"),$(this.ContentDivSelector+" > ul > li a[linkid='"+t.LinkId+"']").addClass("active"),$(".sobytabcontent[tabid='"+this.TabID+"']:visible").hide(),$(t.ContainerId).show(),null!==this.EventAfterTabChange&&this.EventAfterTabChange(e,this.CurrentTabIndex)},this.Initialize=function(){var t=this;$(".sobytabcontent[tabid='"+this.TabID+"']:visible").hide(),$(this.ContentDivSelector).addClass("sobytab");var e=$(this.ContentDivSelector+" > ul > li a");e.addClass("sobytablink"),this.Items=[];for(var i=0;i<e.length;i++){var s="soby_tablink_"+i,a=$(e[i]).attr("href"),o=$(e[i]).text();$(a).addClass("sobytabcontent"),$(a).attr("tabid",this.TabID),$(e[i]).attr("tabid",this.TabID),$(e[i]).attr("linkid",s),$(e[i]).attr("index",i),$(e[i]).click(function(e){e.preventDefault();e=parseInt($(this).attr("index"));t.GoToTab(e)}),this.Items[this.Items.length]={Title:o,ContainerId:a,LinkId:s},!0===this.AutoPopulateTabNumbersOnHeaders&&$(e[i]).text(i+1+". "+o)}for(i=0;i<this.Items.length;i++)$(this.Items[i].ContainerId).hide();$(this.ContentDivSelector+" .sobytabnavigationbar button").attr("tabid",this.TabID),$(this.ContentDivSelector+" .sobytabnavigationbar .previous").click(function(){try{var e=$(this).attr("tabid");soby_Tabs[e].GoToPreviousTab()}catch(e){}return!1}),$(this.ContentDivSelector+" .sobytabnavigationbar .next").click(function(){try{var e=$(this).attr("tabid");soby_Tabs[e].GoToNextTab()}catch(e){}return!1}),this.GoToTab(0)},this.HideNavigationBar=function(){$(this.ContentDivSelector+" .sobytabnavigationbar").hide()},this.ShowNavigationBar=function(){$(this.ContentDivSelector+" .sobytabnavigationbar").show()},this.HideTabPanels=function(){$(this.ContentDivSelector+" .sobytabcontent").hide()},this.ShowTabPanels=function(){$(this.ContentDivSelector+" .sobytabcontent").show()},this.TabID="soby_tabgrid_"+soby_guid(),this.ContentDivSelector=e,this.EnsureTabsExistency()},SobyMenuItemTypes,SobyMenuViewTypes;!function(e){e[e.Toggler=0]="Toggler",e[e.Standard=1]="Standard",e[e.HtmlContent=3]="HtmlContent",e[e.Divider=2]="Divider"}(SobyMenuItemTypes=SobyMenuItemTypes||{}),function(e){e[e.LeftSideBar=0]="LeftSideBar",e[e.TopBar=1]="TopBar"}(SobyMenuViewTypes=SobyMenuViewTypes||{});var SobyMenus=[],SobyMenuItem=function(e,t,i,s,a){this.MenuItemID="",this.Type=SobyMenuItemTypes.Standard,this.IconSrc="",this.Title="",this.Tooltip="",this.Link="",this.ParentMenuItem=null,this.Items=null,this.OnMenuItemClicked=null,this.MenuItemID="soby_menuitem_"+soby_guid(),this.ParentMenuItem=e,this.Title=t,this.Link=i,this.IconSrc=s,this.Tooltip=null!==a?a:t,this.Items=new Array},SobyMenu=function(){function e(e,t){this.MenuID="",this.ViewType=null,this.ContentDivSelector="",this.MaxWidth=null,this.TileWidth="150",this.TileHeight="120",this.Width="600",this.Items=null,this.SVGImages=new soby_SVGImages,this.AutoSelectCurrentPageLink=!0,this.EnsureMenusExistency=function(){for(var e in SobyMenus)if(e===this.MenuID)return;SobyMenus[this.MenuID]=this},this.GetItemById=function(e,t){for(var i=(null===t?this:t).Items,s=0;s<i.length;s++){if(i[s].MenuItemID===e)return i[s];var a=this.GetItemById(e,i[s]);if(null!==a)return a}return null},this.GetItemByLink=function(e,t){for(var i=(null===t?this:t).Items,s=0;s<i.length;s++){var a=unescape(window.location.origin.toLowerCase()+i[s].Link.toLowerCase());if(unescape(e.toLowerCase())===a)return i[s];a=this.GetItemByLink(e,i[s]);if(null!==a)return a}return null},this.PopulateItems=function(e,t){for(var i=null===e?this.ContentDivSelector:"#"+e.MenuItemID,s=(null===e?this:e).Items,a=null,o=0;o<s.length;o++){var n,r,l,h,d,c=s[o];!0===t?c.Type===SobyMenuItemTypes.Standard?(null===a&&(a=$("<ul class='menu"+(null===e?"":" expand")+"'></ul>"),$(i).append(a)),(r=$("<li class='menuitem'></li>")).attr("id",c.MenuItemID),0<c.Items.length?((n=$("<a class='menutoggler' onclick=\"SobyMenus['"+this.MenuID+"'].ExpandCollapseSubMenuItems('"+c.MenuItemID+"', '"+c.Title+"')\"></a>")).append(this.SVGImages.GetExpand()),n.append(c.Title),r.append(n),a.append(r),this.PopulateItems(c)):(l=$("<a></a>"),null!==c.Link&&void 0!==c.Link&&l.attr("href",c.Link),null!==c.IconSrc&&void 0!==c.IconSrc&&(-1<c.IconSrc.indexOf(">")?l.append(c.IconSrc):((h=$("<img></img>")).attr("src",c.IconSrc),l.append(h)),l.append("&nbsp;")),l.append(c.Title),l.attr("title",c.Tooltip),r.append(l),a.append(r))):c.Type===SobyMenuItemTypes.Divider?((r=$("<li class='divider'></li>")).attr("id",c.MenuItemID),a.append(r)):c.Type===SobyMenuItemTypes.Toggler&&((d=$("<div class='toggler'></div>")).attr("id",c.MenuItemID),l=$("<a></a>"),null!==c.Link&&void 0!==c.Link&&l.attr("href",c.Link),null!==c.IconSrc&&void 0!==c.IconSrc&&((h=$("<img></img>")).attr("src",c.IconSrc),l.append(h),l.append("&nbsp;")),l.append(c.Title),l.attr("title",c.Tooltip),d.append(l),$(i).append(d)):c.Type===SobyMenuItemTypes.Standard?(0<(d=$("#"+c.MenuItemID+" > a.menutoggler")).length&&(d.attr("href","javascript:void(0)"),d.attr("onclick","SobyMenus['"+this.MenuID+"'].ExpandCollapseSubMenuItems('"+c.MenuItemID+"', '"+c.Title+"')"),d.html(this.SVGImages.GetExpand()),d.append(c.Title)),this.PopulateItems(c,!1)):c.Type===SobyMenuItemTypes.Toggler&&((c=$("#"+c.MenuItemID+" > a")).attr("href","javascript:void(0)"),c.attr("onclick","SobyMenus['"+this.MenuID+"'].ExpandCollapseMenu()"))}},this.Initialize=function(e){this.PopulateItems(null,e=null==e?!0:e),$(this.ContentDivSelector).addClass("sobymenu"),this.ViewType===SobyMenuViewTypes.LeftSideBar?$(this.ContentDivSelector).addClass("leftsidebar"):this.ViewType===SobyMenuViewTypes.TopBar&&$(this.ContentDivSelector).addClass("topbar"),!0===this.AutoSelectCurrentPageLink&&this.SelectCurrentPageLink()},this.MenuID="soby_menu_"+soby_guid(),this.ContentDivSelector=e,this.ViewType=t,this.Items=new Array,this.EnsureMenusExistency()}return e.prototype.SelectCurrentPageLink=function(){var e=this.GetItemByLink(window.location.href,null);if(null!==e){$("#"+e.MenuItemID).addClass("active");for(var t=e.ParentMenuItem;null!==t;)this.ExpandCollapseSubMenuItems(t.MenuItemID,t.Title),t=t.ParentMenuItem}},e.prototype.Add=function(e,t,i,s,a){var o=(null===e?this:e).Items,a=new SobyMenuItem(e,t,i,s,a);return o.push(a),a},e.prototype.AddToggler=function(e,t,i,s){var a=(null===e?this:e).Items,s=new SobyMenuItem(e,t,"",i,s);return s.Type=SobyMenuItemTypes.Toggler,a.push(s),s},e.prototype.AddDivider=function(e){var t=(null==e?this:e).Items,e=new SobyMenuItem(e,"","","","");return e.Type=SobyMenuItemTypes.Divider,t.push(e),e},e.prototype.ExpandCollapseMenu=function(){$("#soby_MenuDiv").height()<40?$("#soby_MenuDiv").css("height","unset"):$("#soby_MenuDiv").css("height","30px")},e.prototype.ExpandCollapseSubMenuItems=function(e,t){var i=$("#"+e+" > ul.menu"),s=i.hasClass("collapse");i.removeClass("expand"),i.removeClass("collapse"),$("#"+e+" > .menutoggler").html(""),!0===s?(i.addClass("expand"),$("#"+e+" > .menutoggler").append(this.SVGImages.GetExpand())):(i.addClass("collapse"),$("#"+e+" > .menutoggler").append(this.SVGImages.GetCollapse())),$("#"+e+" > .menutoggler").append(t)},e}();function sobyGenerateMenuFromHtmlElement(e){var t=$("#"+e),i=SobyMenuViewTypes.LeftSideBar;!0===t.hasClass("topbar")&&(i=SobyMenuViewTypes.TopBar);i=new SobyMenu("#"+e,i);return sobyParseMenuItemsFromHtmlElement(i,t.find("> ul.menu"),null),i.Initialize(!1),i}function sobyParseMenuItemsFromHtmlElement(e,t,i){void 0===i&&(i=null);for(var s=t.find("> li"),a=0;a<s.length;a++){var o,n,r,l=$(s[a]),h=null;!0===l.hasClass("divider")?h=e.AddDivider(i):!0===l.hasClass("menuitem")?(r=o="",0<(n=l.find("> a.menutoggler")).length?o=n.text():(o=l.text(),r=l.find("> a").attr("href")),h=e.Add(i,o,r,"",""),0<(r=l.find("> ul.menu")).length&&sobyParseMenuItemsFromHtmlElement(e,r,h)):!0===l.hasClass("toggler")&&(r=l.text(),h=e.AddToggler(i,r,"","")),null!==h&&l.attr("id",h.MenuItemID)}}var soby_ItemSelections=[],SobyItemSelectorTypeObject=function(){this.GridView=0,this.TreeView=1,this.CardView=2},SobyItemSelectorTypes=new SobyItemSelectorTypeObject,SobyRangeSelectionViewTypes;function soby_GetItemSelectionByContentDivSelector(e){for(var t in soby_ItemSelections)if(soby_ItemSelections[t].ContentDivSelector===e)return soby_ItemSelections[t];return null}function soby_GetAllItemSelections(){var e,t=[];for(e in soby_ItemSelections)t.push(soby_ItemSelections[e]);return t}!function(e){e[e.NumericRange=0]="NumericRange",e[e.DateRange=1]="DateRange"}(SobyRangeSelectionViewTypes=SobyRangeSelectionViewTypes||{});var soby_RangeSelections=[],soby_RangeSelection=function(){function soby_RangeSelection(e,t,i,s,a,o,n,r,l,h){this.RangeSelectionID=null,this.RangeSelectionTooltipID="",this.ViewType=null,this.Title=null,this.ContentDivSelector=null,this.Width=null,this.Height=null,this.PaddingLeft=20,this.PaddingRight=20,this.PaddingBottom=20,this.PaddingTop=20,this.LabelHeight=20,this.RangeBarHeight=20,this.SelectedRangeBarHeight=40,this.AdditionalLabelSectionHeight=0,this.StartNumericValue=null,this.EndNumericValue=null,this.MinorRangeInterval=null,this.MinorRangeCountInAMajorRange=null,this.MinimumValue=null,this.MaximumValue=null,this.PageItemCount=null,this.SelectedRange=null,this.DragDirection="",this.IsBeingDragged=!1,this.MonthNames=["January","February","March","April","May","June","July","August","September","October","November","December"],this.RangeSelectionID="soby_rangeselection_"+soby_guid(),this.RangeSelectionTooltipID=this.RangeSelectionID+"_tip",this.ContentDivSelector=e,this.Title=t,this.ViewType=i,this.Width=s,this.Height=a,this.SelectedRange=h,this.ViewType===SobyRangeSelectionViewTypes.NumericRange?(this.StartNumericValue=parseFloat(o),this.EndNumericValue=parseFloat(n),this.MinorRangeInterval=parseFloat(r),this.MinorRangeCountInAMajorRange=parseFloat(l)):(this.StartNumericValue=soby_TicksFromDate(o),this.EndNumericValue=soby_TicksFromDate(n),this.MinorRangeInterval=864e9,this.MinorRangeCountInAMajorRange=7,this.SelectedRange=[soby_TicksFromDate(h[0]),soby_TicksFromDate(h[1])],this.AdditionalLabelSectionHeight=20),this.EnsureRangeSelectionsExistency()}return soby_RangeSelection.prototype.EnsureRangeSelectionsExistency=function(){for(var e in soby_RangeSelections)if(e===this.RangeSelectionID)return;soby_RangeSelections[this.RangeSelectionID]=this},soby_RangeSelection.prototype.RePaint=function(){this.Clear(),this.DrawPane(),this.DrawSelectedRange()},soby_RangeSelection.prototype.Clear=function(){this.GetContext().clearRect(0,0,this.Width,this.Height)},soby_RangeSelection.prototype.Initialize=function(){var e=$("<canvas id='"+this.RangeSelectionID+"' width='"+this.Width+"' height='"+this.Height+"' style='border: 1px solid;'></canvas>"),t=$("<canvas id='"+this.RangeSelectionTooltipID+"' width='120' height='40' style='position: absolute;'></canvas>");$(this.ContentDivSelector).html(""),$(this.ContentDivSelector).append(e),$(this.ContentDivSelector).append(t),$("#"+this.RangeSelectionID).attr("draggable","true"),document.getElementById(this.RangeSelectionID).addEventListener("mousemove",this.HandleMouseMove),document.getElementById(this.RangeSelectionID).addEventListener("mousedown",this.HandleMouseDown),document.getElementById(this.RangeSelectionID).addEventListener("mouseup",this.HandleMouseUp),this.DrawPane(),this.DrawSelectedRange()},soby_RangeSelection.prototype.HandleMouseDown=function(e){e.preventDefault();var rangeSelection=soby_RangeSelections[eval("e.target.id")],canvasOffset=$("#"+rangeSelection.RangeSelectionID).offset(),canvasOffsetX=canvasOffset.left-$(window).scrollLeft(),canvasOffsetY=canvasOffset.top-$(window).scrollTop(),mouseX=e.clientX-canvasOffsetX,mouseY=e.clientY-canvasOffsetY;!0===rangeSelection.CheckMouseHitSelectedRangeLeftResize(mouseX,mouseY)?(rangeSelection.GetCanvas().style.cursor="e-resize",rangeSelection.IsBeingDragged=!0,rangeSelection.DragDirection="leftresize",rangeSelection.RangeBeingChanged()):!0===rangeSelection.CheckMouseHitSelectedRangeRightResize(mouseX,mouseY)?(rangeSelection.GetCanvas().style.cursor="e-resize",rangeSelection.IsBeingDragged=!0,rangeSelection.DragDirection="rightresize",rangeSelection.RangeBeingChanged()):!0===rangeSelection.CheckMouseHitSelectedRange(mouseX,mouseY)&&(rangeSelection.GetCanvas().style.cursor="pointer",rangeSelection.IsBeingDragged=!0,rangeSelection.DragDirection="moveposition",rangeSelection.RangeBeingChanged())},soby_RangeSelection.prototype.HandleMouseUp=function(e){e.preventDefault();var rangeSelection=soby_RangeSelections[eval("e.target.id")];rangeSelection.RePaintOnMouseMove(e.offsetX,!0),rangeSelection.RangeChanged()},soby_RangeSelection.prototype.HandleMouseMove=function(e){e.preventDefault();var rangeSelection=soby_RangeSelections[eval("e.target.id")],canvasOffset,tooltipOffsetX,tooltipOffsetY,mouseX,mouseY;!0!==rangeSelection.IsBeingDragged?(canvasOffset=$("#"+rangeSelection.RangeSelectionID).offset(),tooltipOffsetX=canvasOffset.left-$(window).scrollLeft(),tooltipOffsetY=canvasOffset.top-$(window).scrollTop(),mouseX=e.clientX-tooltipOffsetX,mouseY=e.clientY-tooltipOffsetY,!0===rangeSelection.CheckMouseHitSelectedRangeLeftResize(mouseX,mouseY)?(rangeSelection.GetCanvas().style.cursor="e-resize",rangeSelection.DragDirection="leftresize"):!0===rangeSelection.CheckMouseHitSelectedRangeRightResize(mouseX,mouseY)?(rangeSelection.GetCanvas().style.cursor="e-resize",rangeSelection.DragDirection="rightresize"):!0===rangeSelection.CheckMouseHitSelectedRange(mouseX,mouseY)?(rangeSelection.GetCanvas().style.cursor="pointer",rangeSelection.DragDirection="moveposition"):rangeSelection.GetCanvas().style.cursor="default"):"moveposition"===rangeSelection.DragDirection?(rangeSelection.GetCanvas().style.cursor="move",rangeSelection.RePaintOnMouseMove(e.offsetX,!1)):"rightresize"!==rangeSelection.DragDirection&&"leftresize"!==rangeSelection.DragDirection||(rangeSelection.GetCanvas().style.cursor="e-resize",rangeSelection.RePaintOnMouseMove(e.offsetX,!1))},soby_RangeSelection.prototype.CheckMouseHitSelectedRangeLeftResize=function(e,t){var i=this.GetSelectedRangeLeft()-2,s=this.Height-this.LabelHeight-this.AdditionalLabelSectionHeight-this.PaddingBottom,a=s-this.SelectedRangeBarHeight;return i<e&&e<4+i&&t<s&&a<t},soby_RangeSelection.prototype.CheckMouseHitSelectedRangeRightResize=function(e,t){var i=this.GetSelectedRangeRight()+2,s=this.Height-this.LabelHeight-this.AdditionalLabelSectionHeight-this.PaddingBottom,a=s-this.SelectedRangeBarHeight;return i-4<e&&e<i&&t<s&&a<t},soby_RangeSelection.prototype.CheckMouseHitSelectedRange=function(e,t){var i=this.GetSelectedRangeLeft(),s=this.GetSelectedRangeRight(),a=this.Height-this.LabelHeight-this.AdditionalLabelSectionHeight-this.PaddingBottom,o=a-this.SelectedRangeBarHeight;return i<e&&e<s&&t<a&&o<t},soby_RangeSelection.prototype.RePaintOnMouseMove=function(e,t){if(!0===this.IsBeingDragged){var i=this.DragDirection,s=this.GetValueFromOffsetX(e),a=this.SelectedRange[0],e=this.SelectedRange[1];if("leftresize"===i)a=s;else if("rightresize"===i)e=s;else if("moveposition"===i){i=this.SelectedRange[1]-this.SelectedRange[0];if(0===i)return;if(i<-1&&(i*=-1),(a=s)<this.StartNumericValue)return;if((e=a+i)>this.EndNumericValue)return}a===this.SelectedRange[0]&&e===this.SelectedRange[1]||(this.SelectedRange=[a,e],this.RePaint()),!0===t&&(this.GetCanvas().style.cursor="default",t=this.RangeSelectionID+"_DragingImageObject",0<$("#"+t).length&&$("#"+t).remove(),this.IsBeingDragged=!1)}},soby_RangeSelection.prototype.DrawPane=function(){var e=this.GetRangeItemCount(),t=this.GetRangeValueWidth(),i=this.GetContext();i.fillStyle="gray",i.strokeStyle="gray",i.lineWidth=1,i.beginPath(),i.moveTo(this.PaddingLeft,this.Height-this.LabelHeight-this.AdditionalLabelSectionHeight-this.PaddingBottom-this.RangeBarHeight/2),i.lineTo(this.Width-this.PaddingRight,this.Height-this.LabelHeight-this.AdditionalLabelSectionHeight-this.PaddingBottom-this.RangeBarHeight/2),i.stroke();for(var s=0;s<e;s+=this.MinorRangeCountInAMajorRange){var a=this.PaddingLeft+s*t;i.lineWidth=1,i.beginPath(),i.moveTo(a,this.Height-this.LabelHeight-this.AdditionalLabelSectionHeight-this.PaddingBottom),i.lineTo(a,this.Height-this.LabelHeight-this.AdditionalLabelSectionHeight-this.PaddingBottom-this.RangeBarHeight),i.stroke();var o=s*this.MinorRangeInterval,o=this.StartNumericValue+o;i.fillText(this.GetValueLabel(o),a-6,this.Height-this.AdditionalLabelSectionHeight-this.PaddingBottom)}var n=this.Width-this.PaddingRight;if(i.lineWidth=1,i.beginPath(),i.moveTo(n,this.Height-this.LabelHeight-this.AdditionalLabelSectionHeight-this.PaddingBottom),i.lineTo(n,this.Height-this.LabelHeight-this.AdditionalLabelSectionHeight-this.PaddingBottom-this.RangeBarHeight),i.stroke(),i.fillText(this.GetValueLabel(this.EndNumericValue),n-6,this.Height-this.AdditionalLabelSectionHeight-this.PaddingBottom),this.ViewType===SobyRangeSelectionViewTypes.DateRange)for(var r,l,h=soby_DateFromTicks(this.StartNumericValue),d=soby_DateFromTicks(this.StartNumericValue),c=soby_DateFromTicks(this.EndNumericValue);d<c;)1===d.getDate()&&(l=this.GetOffsetXFromValue(soby_TicksFromDate(d)),i.lineWidth=1,i.beginPath(),i.moveTo(l,this.Height-this.PaddingBottom-this.AdditionalLabelSectionHeight+4),i.lineTo(l,this.Height-this.PaddingBottom),i.stroke(),i.fillText(this.MonthNames[d.getMonth()]+(0===d.getMonth()?" "+d.getFullYear():""),l+6,this.Height-this.PaddingBottom-4),h.getDate()<25&&((r=new Date(d.getTime())).setDate(r.getDate()-1),r.getMonth()===h.getMonth()&&r.getFullYear()===h.getFullYear()&&(l=this.GetOffsetXFromValue(this.StartNumericValue),i.fillText(this.MonthNames[r.getMonth()]+" "+r.getFullYear(),l+4,this.Height-this.PaddingBottom-4)))),d.setDate(d.getDate()+1)},soby_RangeSelection.prototype.GetSelectedDateRanges=function(){return[soby_DateFromTicks(this.SelectedRange[0]),soby_DateFromTicks(this.SelectedRange[1])]},soby_RangeSelection.prototype.GetValueLabel=function(e){return(this.ViewType===SobyRangeSelectionViewTypes.DateRange?soby_DateFromTicks(e).getDate():e).toString()},soby_RangeSelection.prototype.GetContext=function(){return eval("document.getElementById('"+this.RangeSelectionID+"').getContext('2d');")},soby_RangeSelection.prototype.GetCanvas=function(){return eval("document.getElementById('"+this.RangeSelectionID+"');")},soby_RangeSelection.prototype.GetTooltipContext=function(){return eval("document.getElementById('"+this.RangeSelectionTooltipID+"').getContext('2d');")},soby_RangeSelection.prototype.GetTooltipCanvas=function(){return eval("document.getElementById('"+this.RangeSelectionTooltipID+"');")},soby_RangeSelection.prototype.DrawSelectedRange=function(){var e=this.GetSelectedRangeLeft(),t=this.GetSelectedRangeRight(),i=t-e,s=this.GetContext();s.fillStyle="#606060",s.strokeStyle="#606060",s.fillRect(e,this.Height-this.LabelHeight-this.AdditionalLabelSectionHeight-this.PaddingBottom-.75*this.RangeBarHeight,i,10),s.lineWidth=2,s.beginPath(),s.moveTo(e-1,this.Height-this.LabelHeight-this.AdditionalLabelSectionHeight-this.PaddingBottom-.75*this.SelectedRangeBarHeight),s.lineTo(e-1,this.Height-this.LabelHeight-this.AdditionalLabelSectionHeight-this.PaddingBottom+.25*this.SelectedRangeBarHeight),s.stroke(),s.lineWidth=2,s.beginPath(),s.moveTo(t+1,this.Height-this.LabelHeight-this.AdditionalLabelSectionHeight-this.PaddingBottom-.75*this.SelectedRangeBarHeight),s.lineTo(t+1,this.Height-this.LabelHeight-this.AdditionalLabelSectionHeight-this.PaddingBottom+.25*this.SelectedRangeBarHeight),s.stroke();var a=e-72;a-this.PaddingLeft<0&&(a=this.PaddingLeft);var o=t;o+72+this.PaddingRight>this.Width&&(o=this.Width-this.PaddingRight-72),s.fillRect(a-2,this.Height-this.LabelHeight-this.AdditionalLabelSectionHeight-this.PaddingBottom-.75*this.SelectedRangeBarHeight-18,74,18),s.fillRect(o,this.Height-this.LabelHeight-this.AdditionalLabelSectionHeight-this.PaddingBottom-.75*this.SelectedRangeBarHeight-18,74,18),s.fillStyle="#FFFFFF",s.strokeStyle="#FFFFFF";var n=this.SelectedRange[0].toString(),i=this.SelectedRange[1].toString();this.ViewType===SobyRangeSelectionViewTypes.DateRange&&(e=soby_DateFromTicks(this.SelectedRange[0]),t=soby_DateFromTicks(this.SelectedRange[1]),n=this.MonthNames[e.getMonth()]+" "+e.getDate().toString(),i=this.MonthNames[t.getMonth()]+" "+t.getDate().toString()),s.fillText(n,a+5,this.Height-this.LabelHeight-this.AdditionalLabelSectionHeight-this.PaddingBottom-.75*this.SelectedRangeBarHeight-5),s.fillText(i,o+5,this.Height-this.LabelHeight-this.AdditionalLabelSectionHeight-this.PaddingBottom-.75*this.SelectedRangeBarHeight-5)},soby_RangeSelection.prototype.GetRangeItemCount=function(){return(this.EndNumericValue-this.StartNumericValue)/this.MinorRangeInterval},soby_RangeSelection.prototype.GetRangeValueWidth=function(){return(this.Width-(this.PaddingLeft+this.PaddingRight))/this.GetRangeItemCount()},soby_RangeSelection.prototype.GetValueFromOffsetX=function(e){return this.StartNumericValue+(e-this.PaddingLeft)/this.GetRangeValueWidth()*this.MinorRangeInterval},soby_RangeSelection.prototype.GetOffsetXFromValue=function(e){return this.PaddingLeft+(e-this.StartNumericValue)/this.MinorRangeInterval*this.GetRangeValueWidth()},soby_RangeSelection.prototype.GetSelectedRangeLeft=function(){return this.GetOffsetXFromValue(this.SelectedRange[0])},soby_RangeSelection.prototype.GetSelectedRangeRight=function(){return this.GetOffsetXFromValue(this.SelectedRange[1])},soby_RangeSelection.prototype.RangeBeingChanged=function(){},soby_RangeSelection.prototype.RangeChanged=function(){},soby_RangeSelection}(),soby_ItemSelection=function(){function e(e,t,i,s,a,o,n,r,l,h,d,c){this.ItemSelectorType=null,this.AdvancedSearchAsGrid=null,this.ItemSelectionID="",this.ContentDivSelector="",this.Title="",this.AutoCompleteDataService=null,this.AdvancedSearchDataService=null,this.AdvancedSearchChildrenDataService=null,this.AllowMultipleSelections=!0,this.EmptyDataHtml="",this.WaterMark="",this.DialogID="",this.SelectorUrl="",this.ParentFieldName="",this.ValueFieldName="",this.TextFieldName="",this.SVGImages=new soby_SVGImages,this.OnSelectionChanged=null,this.EventBeforeAutoCompleteQuery=null,this.ItemSelectionID="soby_itemselection_"+soby_guid(),this.ContentDivSelector=e,this.Title=t,this.ItemSelectorType=i,this.AutoCompleteDataService=s,this.AdvancedSearchDataService=a,this.AdvancedSearchChildrenDataService=o,this.EmptyDataHtml=n,this.DialogID=r,this.SelectorUrl=l,this.ValueFieldName=h,this.TextFieldName=d,this.ParentFieldName=c,this.EnsureItemSelectionExistency(),this.InitializeAdvancedSearchControl()}return e.prototype.InitializeAdvancedSearchControl=function(){if(this.ItemSelectorType===SobyItemSelectorTypes.GridView){var e=new soby_WebGrid("#"+this.DialogID+" .itemselectionadvancedsearchgridview",this.Title,this.AdvancedSearchDataService,this.EmptyDataHtml);e.IsEditable=!1;for(var t=0;t<this.AdvancedSearchDataService.DataSourceBuilder.SchemaFields.length;t++){var i=this.AdvancedSearchDataService.DataSourceBuilder.SchemaFields[t];e.AddColumn(i.FieldName,i.FieldName,SobyShowFieldsOn.All,null,null,!0,!0,!0,null,null,null)}this.AdvancedSearchAsGrid=e}else{var s;this.ItemSelectorType===SobyItemSelectorTypes.TreeView&&((s=new soby_TreeView("#"+this.DialogID+" .itemselectionadvancedsearchgridview",this.Title,this.AdvancedSearchDataService,this.AdvancedSearchChildrenDataService,this.EmptyDataHtml,this.ParentFieldName,this.ValueFieldName,this.TextFieldName)).Initialize(),this.AdvancedSearchAsGrid=s)}},e.prototype.Initialize=function(){var e=$("<input type='hidden' class='selecteditemvalues'>"),t=$("<input type='text' class='itemname' style='width:100px;padding:3px 0px 3px 0px'>");t.val(this.WaterMark),t.attr("title",this.WaterMark);var i=$("<a id='"+this.ItemSelectionID+"_advancedbutton' href='javascript:void(0)'>"+this.SVGImages.GetPicker()+"</a>"),s=$("<div class='selecteditemmaintenancepanel'></div>");$(this.ContentDivSelector).append(e),$(this.ContentDivSelector).append(t),$(this.ContentDivSelector).append(i),$(this.ContentDivSelector).append(s),i.unbind("click"),i.bind("click",{MainControlID:this.ItemSelectionID,DialogID:this.DialogID,DialogTitle:this.Title,SelectorUrl:this.SelectorUrl},this.OpenItemPicker);var a=this,d=this;this.AutoCompleteDataService.ItemPopulated=function(e){for(var t=d.AutoCompleteDataService.Args[0],i=[],s=0;s<e.length;s++){for(var a=d.TextFieldName.split(";"),o=d.ValueFieldName.split(";"),n="",r="",l=0;l<a.length;l++)null!==(h=e[s][a[l]])&&(n+=h);for(var h,l=0;l<o.length;l++)null!==(h=e[s][o[l]])&&(r+=h);i.push({Text:r,value:n,Value:n})}t(i)},$(this.ContentDivSelector+" .itemname").click(function(){$(this).val()===d.WaterMark&&$(this).val("")}),$(this.ContentDivSelector+" .itemname").focusout(function(){""===$(this).val()&&$(this).val(d.WaterMark)}),$(this.ContentDivSelector+" .itemname").autocomplete({source:function(e,t){d.AutoCompleteDataService.DataSourceBuilder.Filters=new SobyFilters(!0);for(var i=d.TextFieldName.split(";"),s=0;s<i.length;s++)d.AutoCompleteDataService.DataSourceBuilder.Filters.AddFilter(i[s],e.term,SobyFieldTypes.Text,SobyFilterTypes.Contains,!1,!0);null!==d.EventBeforeAutoCompleteQuery&&d.EventBeforeAutoCompleteQuery(),d.AutoCompleteDataService.PopulateItems([t])},select:function(e,t){a.AddItem(t.item.Value,t.item.Text)},minLength:2}),this.GenerateItemTable()},e.prototype.OpenItemPicker=function(e){var s=e.data.MainControlID,t=e.data.DialogTitle;ShowCommonHtmlDialog(t=null===t?"":t,e.data.DialogID,function(e){if(null!==e)for(var t=e.split(soby_FilterValueSeperator),i=0;i<t.length;i+=2)soby_ItemSelections[s].AddItem(t[i+1],t[i])}).html("<div class='itemselectionadvancedsearchgridview'></div><p align='right'><input type='button' value='Ekle' onclick=\"soby_ItemSelections['"+s+"'].SelectItemsFromAdvancedSearchDialog()\"></p>"),soby_ItemSelections[s].AdvancedSearchAsGrid.Initialize(!0)},e.prototype.SelectItemsFromAdvancedSearchDialog=function(){for(var e=this.AdvancedSearchAsGrid.GetSelectedDataItems(),t="",i=0;i<e.length;i++){""!==t&&(t+=soby_FilterValueSeperator);for(var s=this.TextFieldName.split(";"),a=this.ValueFieldName.split(";"),o="",n="",r=0;r<s.length;r++)null!==(l=e[i][s[r]])&&(o+=l);for(var l,r=0;r<a.length;r++)null!==(l=e[i][a[r]])&&(n+=l);t+=n+soby_FilterValueSeperator+o}CommonCloseDialog(this.DialogID,t)},e.prototype.GetItemArray=function(){var e=$(this.ContentDivSelector+" .selecteditemvalues").val().toString();return null===e||""===e?[]:JSON.parse(e)},e.prototype.AddItem=function(e,t){var i=[],s=!1;!0===this.AllowMultipleSelections&&(i=this.GetItemArray());for(var a,o=0;o<i.length;o++)i[o].Value===t&&(s=!0);!1===s&&((a=new Object).Text=e,a.Value=t,i[i.length]=a),this.SetItemArray(i),this.GenerateItemTable()},e.prototype.RemoveItem=function(e){for(var t=this.GetItemArray(),i=[],s=t.length-1;-1<s;s--)t[s].Value!==e&&(i[i.length]={Text:t[s].Text,Value:t[s].Value});this.SetItemArray(i),this.GenerateItemTable()},e.prototype.SetItemArray=function(e){for(var t="[",i=0;i<e.length;i++)0<i&&(t+=","),t+='{ "Text" : "'+e[i].Text+'", "Value" : "'+e[i].Value+'" }';t+="]",$(this.ContentDivSelector+" .selecteditemvalues").val(t),null!==this.OnSelectionChanged&&this.OnSelectionChanged()},e.prototype.GenerateItemTable=function(){var e,t="<table class='ms-formtable' cellspacing='0' cellpadding='0' border='0' width='100%' style='margin-top: 8px;'>",i=this.GetItemArray();for(e in i)t+="<tr class='mtdataitemrow'><td width='20'><a href='javascript:void(0)' onclick=\"soby_ItemSelections['"+this.ItemSelectionID+"'].RemoveItem('"+i[e].Value+"')\" class='itemSelectorDeleteLink'>"+this.SVGImages.GetXCircle()+"</a></td><td>"+i[e].Text+"</td></tr>";0===i.length&&(t+="<tr class='mtdataitemrow'><td>"+this.EmptyDataHtml+"</td></tr>"),t+="</table>",$(this.ContentDivSelector+" .selecteditemmaintenancepanel").html(t)},e.prototype.EnsureItemSelectionExistency=function(){for(var e in soby_ItemSelections)if(e===this.ItemSelectionID)return;soby_ItemSelections[this.ItemSelectionID]=this},e}(),soby_TreeViews=[],soby_TreeViewItems=[],soby_TreeView=function(){function e(e,t,i,s,a,o,n,r){this.TreeViewID="",this.ContentDivSelector="",this.Title="",this.RootNodesDataService=null,this.ChildNodesDataService=null,this.AllowMultipleSelections=!0,this.AllowCheckBoxes=!0,this.EmptyDataHtml="",this.ParentFieldName="",this.ValueFieldName="",this.TextFieldName="",this.SVGImages=new soby_SVGImages,this.OnSelectionChanged=null,this.OnClick=null,this.TreeViewID="soby_itemselection_"+soby_guid(),this.ContentDivSelector=e,this.Title=t,this.RootNodesDataService=i,this.ChildNodesDataService=s,this.EmptyDataHtml=a,this.ParentFieldName=o,this.ValueFieldName=n,this.TextFieldName=r,this.EnsureItemSelectionExistency();var l=this;this.RootNodesDataService.ItemPopulated=function(e){soby_TreeViewItems=[],e=l.RootDataBeingParsed(e),l.PopulateNodes(l.ContentDivSelector,e)}}return e.prototype.RootDataBeingParsed=function(e){return e},e.prototype.ChildDataBeingParsed=function(e){return e},e.prototype.RootNodesDataServiceBeingQueried=function(){},e.prototype.ChildNodesDataServiceBeingQueried=function(e){},e.prototype.Initialize=function(){$(this.ContentDivSelector).addClass("soby_treeview"),this.RootNodesDataServiceBeingQueried(),this.RootNodesDataService.PopulateItems(null)},e.prototype.GetItemData=function(e){for(var t=0;t<soby_TreeViewItems.length;t++)if(soby_TreeViewItems[t].SobyTreeViewItemId===e)return soby_TreeViewItems[t];return null},e.prototype.GetRootNodeId=function(e){for(var t=e,i=e;null!=i;)null!=(i=this.GetParentNodeId(i))&&(t=i);return t},e.prototype.GetParentNodeId=function(e){e=$("#"+e).parent().parent();if(!0===e.hasClass("soby_treeviewnode"))return e.attr("id")},e.prototype.GetRootNodeItemData=function(e){e=this.GetRootNodeId(e);return this.GetItemData(e)},e.prototype.GetParentNodeItemData=function(e){e=this.GetParentNodeId(e);if(null!=e)return this.GetItemData(e)},e.prototype.ExpandNode=function(t){var i,e=$("#"+t).attr("isexpanded"),s=$("#"+t).attr("isloaded");"0"===e?($("#"+t+" > ul").show(),$("#"+t).attr("isexpanded","1"),$("#"+t+" > a > span > img").attr("isexpanded","1").removeClass("soby-list-expand").addClass("soby-list-collapse"),$("#"+t+" > a.toggler").html(this.SVGImages.GetCollapse())):($("#"+t+" > ul").hide(),$("#"+t).attr("isexpanded","0"),$("#"+t+" > a > span > img").attr("isexpanded","1").removeClass("soby-list-collapse").addClass("soby-list-expand"),$("#"+t+" > a.toggler").html(this.SVGImages.GetExpand())),"0"===s&&($("#"+t).attr("isloaded","1"),s=(e=this.GetItemData(t))[(i=this).ValueFieldName],this.ChildNodesDataService.DataSourceBuilder.Filters.Clear(),this.ChildNodesDataService.DataSourceBuilder.Filters.AddFilter(this.ParentFieldName,s,SobyFieldTypes.Number,SobyFilterTypes.Equal,!1,!1),this.ChildNodesDataService.ItemPopulated=function(e){e=i.ChildDataBeingParsed(e),i.PopulateNodes("#"+t,e),$("#"+t+" > ul").show(),$("#"+t).attr("isexpanded","1")},this.ChildNodesDataServiceBeingQueried(e),this.ChildNodesDataService.PopulateItems([t,s]))},e.prototype.PopulateNodes=function(e,t){for(var i=$("<ul></ul>"),s=0;s<t.length;s++){var a=soby_guid();t[s].SobyTreeViewItemId=a,soby_TreeViewItems.push(t[s]);t[s][this.ValueFieldName];var o=t[s][this.TextFieldName],n=$("<li class='soby_treeviewnode'></li>");n.attr("id",a),n.attr("isloaded","0"),n.attr("isexpanded","0");var r=$("<input type='checkbox' onclick=\"soby_TreeViews['"+this.TreeViewID+"'].CheckNode('"+a+"')\">");r.val(a),r.attr("name","checkbox_"+this.TreeViewID);var l=$("<a href='javascript:void(0)' onclick=\"soby_TreeViews['"+this.TreeViewID+"'].ExpandNode('"+a+"')\" class='toggler'>"+this.SVGImages.GetExpand()+"</a>"),a=$("<a href='javascript:void(0)' onclick=\"soby_TreeViews['"+this.TreeViewID+"'].ClickNode('"+a+"')\"></a>");a.text(o),n.append(l),!0===this.AllowCheckBoxes&&n.append(r),n.append(a),i.append(n)}$(e).append(i)},e.prototype.GetSelectedDataItems=function(){var e=[],t=$("input[name='checkbox_"+this.TreeViewID+"']:checked");!1===this.AllowCheckBoxes&&(t=$("input[name='checkbox_"+this.TreeViewID+"']:checked"));for(var i=0;i<t.length;i++)e[e.length]=this.GetItemData($(t[i]).val());return e},e.prototype.ClickNode=function(e){null!=this.OnClick&&this.OnClick(this.TreeViewID,e)},e.prototype.CheckNode=function(e){null!=this.OnSelectionChanged&&this.OnSelectionChanged(this.TreeViewID)},e.prototype.EnsureItemSelectionExistency=function(){for(var e in soby_TreeViews)if(e===this.TreeViewID)return;soby_TreeViews[this.TreeViewID]=this},e}();function ShowCommonDialog(e,t,i,s){(0,window.parent.ShowDialog)(e,t,i,s)}function ShowDialog(e,t,i,s){var a=$("#"+i);0===a.length&&(a=$('<div id="'+i+'"></div>'));var o=800,n=700,r=$(window).height()-100,i=$(window).width()-100;r<n&&(n=r),i<o&&(o=i);t=a.html('<iframe src="'+e+'" width="100%" height="100%"></iframe>').dialog({autoOpen:!1,modal:!0,height:n,width:o,title:t}).data("argument",null);t.unbind("dialogclose"),t.bind("dialogclose",function(e){var t;null!==s&&(t=$(this).data("argument"),s(t))}),a.dialog("open")}function ShowCommonHtmlDialog(e,t,i){window.parent.ShowDialog;return ShowHtmlDialog(e,t,i)}function ShowHtmlDialog(e,t,i){var s=$("#"+t);0<s.length&&s.remove();var a=800,o=700,n=$(window).height()-100,r=$(window).width()-100;n<o&&(o=n),r<a&&(a=r);e=(s=$('<div id="'+t+'"></div>')).dialog({autoOpen:!1,modal:!0,height:o,width:a,title:e}).data("argument",null);return e.unbind("dialogclose"),e.bind("dialogclose",function(e){var t;null!==i&&(t=$(this).data("argument"),i(t))}),s.dialog("open"),s}function CloseDialog(e,t){$("#"+e).dialog("close")}function CommonCloseDialog(e,t){null!==SetCommonDialogArgument&&null!==CloseDialog&&(SetCommonDialogArgument(e,t),CloseDialog(e,t));var i=window.parent.SetCommonDialogArgument,s=window.parent.CloseDialog;i(e,t),s(e,t)}function SetDialogArgument(e,t){$("#"+e).dialog().data("argument",t)}function SetCommonDialogArgument(e,t){$("#"+e).dialog().data("argument",t)}var soby_SVGImages=function(){function e(){this.Width=20,this.Height=20}return e.prototype.GetArrowDown=function(){return"<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='currentColor' class='bi bi-arrow-down' viewBox='0 0 16 16' style='padding-bottom: 3px;'><path fill-rule='evenodd' d = 'M8 1a.5.5 0 0 1 .5.5v11.793l3.146-3.147a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0l-4-4a.5.5 0 0 1 .708-.708L7.5 13.293V1.5A.5.5 0 0 1 8 1z' /></svg>"},e.prototype.GetArrowUp=function(){return"<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='currentColor' class='bi bi-arrow-up' viewBox='0 0 16 16' style='padding-bottom: 3px;'><path fill-rule='evenodd' d = 'M8 15a.5.5 0 0 0 .5-.5V2.707l3.146 3.147a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 1 0 .708.708L7.5 2.707V14.5a.5.5 0 0 0 .5.5z' /></svg>"},e.prototype.GetSortAZDown=function(){return"<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='currentColor' class='bi bi-sort-alpha-down' viewBox='0 0 16 16'><path fill-rule='evenodd' d = 'M10.082 5.629 9.664 7H8.598l1.789-5.332h1.234L13.402 7h-1.12l-.419-1.371h-1.781zm1.57-.785L11 2.687h-.047l-.652 2.157h1.351z' /><path d='M12.96 14H9.028v-.691l2.579-3.72v-.054H9.098v-.867h3.785v.691l-2.567 3.72v.054h2.645V14zM4.5 2.5a.5.5 0 0 0-1 0v9.793l-1.146-1.147a.5.5 0 0 0-.708.708l2 1.999.007.007a.497.497 0 0 0 .7-.006l2-2a.5.5 0 0 0-.707-.708L4.5 12.293V2.5z' /></svg>"},e.prototype.GetSortAZUp=function(){return"<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='currentColor' class='bi bi-sort-alpha-up' viewBox='0 0 16 16'><path fill-rule='evenodd' d = 'M10.082 5.629 9.664 7H8.598l1.789-5.332h1.234L13.402 7h-1.12l-.419-1.371h-1.781zm1.57-.785L11 2.687h-.047l-.652 2.157h1.351z' /><path d='M12.96 14H9.028v-.691l2.579-3.72v-.054H9.098v-.867h3.785v.691l-2.567 3.72v.054h2.645V14zm-8.46-.5a.5.5 0 0 1-1 0V3.707L2.354 4.854a.5.5 0 1 1-.708-.708l2-1.999.007-.007a.498.498 0 0 1 .7.006l2 2a.5.5 0 1 1-.707.708L4.5 3.707V13.5z' /></svg>"},e.prototype.GetXCircle=function(){return"<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='currentColor' class='bi bi-x-circle-fill' viewBox='0 0 16 16'><path d='M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293 5.354 4.646z' /></svg>"},e.prototype.GetFilterCircle=function(){return"<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='currentColor' class='bi bi-filter-circle-fill' viewBox='0 0 16 16'><path d='M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zM3.5 5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1 0-1zM5 8.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5zm2 3a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 0 1h-1a.5.5 0 0 1-.5-.5z' /></svg>"},e.prototype.GetCheck=function(){return"<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16'  fill='white' class='bi bi-check' viewBox='0 0 16 16'><path d='M10.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425a.267.267 0 0 1 .02-.022z' /></svg>"},e.prototype.GetCardView=function(){return"<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='currentColor' class='bi bi-card-list' viewBox='0 0 16 16'><path d='M14.5 3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-13a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h13zm-13-1A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h13a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 14.5 2h-13z' /><path d='M5 8a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7A.5.5 0 0 1 5 8zm0-2.5a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5zm0 5a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5zm-1-5a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0zM4 8a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0zm0 2.5a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0z' /></svg>"},e.prototype.GetLeftCircle=function(){return"<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='currentColor' class='bi bi-arrow-left-circle-fill' viewBox='0 0 16 16'><path d='M8 0a8 8 0 1 0 0 16A8 8 0 0 0 8 0zm3.5 7.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H11.5z' /></svg>"},e.prototype.GetRightCircle=function(){return"<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='currentColor' class='bi bi-arrow-right-circle-fill' viewBox='0 0 16 16'><path d='M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0zM4.5 7.5a.5.5 0 0 0 0 1h5.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L10.293 7.5H4.5z' /></svg>"},e.prototype.GetCollapse=function(){return"<svg xmlns='http://www.w3.org/2000/svg' fill='currentColor' width = '16' height = '16' viewBox='0 0 24 24' > <path d='M12 17.414 3.293 8.707l1.414-1.414L12 14.586l7.293-7.293 1.414 1.414L12 17.414z' /> </svg>"},e.prototype.GetExpand=function(){return"<svg xmlns='http://www.w3.org/2000/svg' fill='currentColor' width='16' height='16' viewBox='0 0 24 24'><path d='M7.293 4.707 14.586 12l-7.293 7.293 1.414 1.414L17.414 12 8.707 3.293 7.293 4.707z'/></svg>"},e.prototype.GetPicker=function(){return"<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='currentColor' class='bi bi-journal-plus' viewBox='0 0 16 16'><path fill-rule='evenodd' d = 'M8 5.5a.5.5 0 0 1 .5.5v1.5H10a.5.5 0 0 1 0 1H8.5V10a.5.5 0 0 1-1 0V8.5H6a.5.5 0 0 1 0-1h1.5V6a.5.5 0 0 1 .5-.5z' /><path d='M3 0h10a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-1h1v1a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v1H1V2a2 2 0 0 1 2-2z' /><path d='M1 5v-.5a.5.5 0 0 1 1 0V5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0V8h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0v.5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1z' /></svg>"},e.prototype.GetExcel=function(){return"<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='currentColor' class='bi bi-file-earmark-excel-fill' viewBox='0 0 16 16'><path d='M9.293 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V4.707A1 1 0 0 0 13.707 4L10 .293A1 1 0 0 0 9.293 0zM9.5 3.5v-2l3 3h-2a1 1 0 0 1-1-1zM5.884 6.68 8 9.219l2.116-2.54a.5.5 0 1 1 .768.641L8.651 10l2.233 2.68a.5.5 0 0 1-.768.64L8 10.781l-2.116 2.54a.5.5 0 0 1-.768-.641L7.349 10 5.116 7.32a.5.5 0 1 1 .768-.64z' /></svg>"},e.prototype.GetCSV=function(){return"<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='currentColor' class='bi bi-file-earmark-font-fill' viewBox='0 0 16 16'><path d='M9.293 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V4.707A1 1 0 0 0 13.707 4L10 .293A1 1 0 0 0 9.293 0zM9.5 3.5v-2l3 3h-2a1 1 0 0 1-1-1zM5.057 6h5.886L11 8h-.5c-.18-1.096-.356-1.192-1.694-1.235l-.298-.01v5.09c0 .47.1.582.903.655v.5H6.59v-.5c.799-.073.898-.184.898-.654V6.755l-.293.01C5.856 6.808 5.68 6.905 5.5 8H5l.057-2z' /></svg>"},e.prototype.GetPrint=function(){return"<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='currentColor' class='bi bi-printer-fill' viewBox='0 0 16 16'><path d='M5 1a2 2 0 0 0-2 2v1h10V3a2 2 0 0 0-2-2H5zm6 8H5a1 1 0 0 0-1 1v3a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1z' /><path d='M0 7a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2h-1v-2a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v2H2a2 2 0 0 1-2-2V7zm2.5 1a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1z' /></svg>"},e.prototype.GetClipboard=function(){return"<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='currentColor' class='bi bi-clipboard' viewBox='0 0 16 16'><path d='M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z' /><path d='M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z' /></svg>"},e.prototype.GetLoading=function(){return"<svg xmlns='http://www.w3.org/2000/svg' fill='currentColor' xmlns:xlink='http://www.w3.org/1999/xlink' style='margin:auto;background:#fff;display:block;' width='16px' height='16px' viewBox='0 0 100 100' preserveAspectRatio='xMidYMid'><g transform='translate(80,50)'><g transform='rotate(0)'><circle cx='0' cy='0' r='6' fill='#ff727d' fill-opacity='1'><animateTransform attributeName='transform' type='scale' begin='-0.875s' values='1.5 1.5;1 1' keyTimes='0;1' dur='1s' repeatCount='indefinite'></animateTransform>  <animate attributeName='fill-opacity' keyTimes='0;1' dur='1s' repeatCount='indefinite' values='1;0' begin='-0.875s'></animate></circle></g></g><g transform='translate(71.21320343559643,71.21320343559643)'><g transform='rotate(45)'><circle cx='0' cy='0' r='6' fill='#ff727d' fill-opacity='0.875'>  <animateTransform attributeName='transform' type='scale' begin='-0.75s' values='1.5 1.5;1 1' keyTimes='0;1' dur='1s' repeatCount='indefinite'></animateTransform>  <animate attributeName='fill-opacity' keyTimes='0;1' dur='1s' repeatCount='indefinite' values='1;0' begin='-0.75s'></animate></circle></g></g><g transform='translate(50,80)'><g transform='rotate(90)'><circle cx='0' cy='0' r='6' fill='#ff727d' fill-opacity='0.75'>  <animateTransform attributeName='transform' type='scale' begin='-0.625s' values='1.5 1.5;1 1' keyTimes='0;1' dur='1s' repeatCount='indefinite'></animateTransform>  <animate attributeName='fill-opacity' keyTimes='0;1' dur='1s' repeatCount='indefinite' values='1;0' begin='-0.625s'></animate></circle></g></g><g transform='translate(28.786796564403577,71.21320343559643)'><g transform='rotate(135)'><circle cx='0' cy='0' r='6' fill='#ff727d' fill-opacity='0.625'>  <animateTransform attributeName='transform' type='scale' begin='-0.5s' values='1.5 1.5;1 1' keyTimes='0;1' dur='1s' repeatCount='indefinite'></animateTransform>  <animate attributeName='fill-opacity' keyTimes='0;1' dur='1s' repeatCount='indefinite' values='1;0' begin='-0.5s'></animate></circle></g></g><g transform='translate(20,50.00000000000001)'><g transform='rotate(180)'><circle cx='0' cy='0' r='6' fill='#ff727d' fill-opacity='0.5'>  <animateTransform attributeName='transform' type='scale' begin='-0.375s' values='1.5 1.5;1 1' keyTimes='0;1' dur='1s' repeatCount='indefinite'></animateTransform>  <animate attributeName='fill-opacity' keyTimes='0;1' dur='1s' repeatCount='indefinite' values='1;0' begin='-0.375s'></animate></circle></g></g><g transform='translate(28.78679656440357,28.786796564403577)'><g transform='rotate(225)'><circle cx='0' cy='0' r='6' fill='#ff727d' fill-opacity='0.375'>  <animateTransform attributeName='transform' type='scale' begin='-0.25s' values='1.5 1.5;1 1' keyTimes='0;1' dur='1s' repeatCount='indefinite'></animateTransform>  <animate attributeName='fill-opacity' keyTimes='0;1' dur='1s' repeatCount='indefinite' values='1;0' begin='-0.25s'></animate></circle></g></g><g transform='translate(49.99999999999999,20)'><g transform='rotate(270)'><circle cx='0' cy='0' r='6' fill='#ff727d' fill-opacity='0.25'>  <animateTransform attributeName='transform' type='scale' begin='-0.125s' values='1.5 1.5;1 1' keyTimes='0;1' dur='1s' repeatCount='indefinite'></animateTransform>  <animate attributeName='fill-opacity' keyTimes='0;1' dur='1s' repeatCount='indefinite' values='1;0' begin='-0.125s'></animate></circle></g></g><g transform='translate(71.21320343559643,28.78679656440357)'><g transform='rotate(315)'><circle cx='0' cy='0' r='6' fill='#ff727d' fill-opacity='0.125'>  <animateTransform attributeName='transform' type='scale' begin='0s' values='1.5 1.5;1 1' keyTimes='0;1' dur='1s' repeatCount='indefinite'></animateTransform>  <animate attributeName='fill-opacity' keyTimes='0;1' dur='1s' repeatCount='indefinite' values='1;0' begin='0s'></animate></circle></g></g></svg>"},e}(),__extends=this&&this.__extends||function(){var s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)};return function(e,t){function i(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),soby_CalendarViews=new Array,SobyCalendarViewTypesObject=function(){this.Daily=1,this.Weekly=2,this.Monthly=3,this.Yearly=4,this.TaskList=5},SobyCalendarViewTypes=new SobyCalendarViewTypesObject,soby_CalendarView=function(){function s(e,t,i,s,a,o,n,r,l,h,d,c,u,p,y,g){this.CalendarViewID="",this.ContentDivSelector="",this.Items=new soby_CalendarViewItems,this.MonthNames=["Jan","Feb","Mar","Apr","May","Jun","July","Aug","Sep","Oct","Nov","Dec"],this.DayNames=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],this.Title="",this.DataService=null,this.AllowMultipleSelections=!0,this.AllowCheckBoxes=!0,this.ViewType=3,this.EmptyDataHtml="",this.IdFieldName="",this.TitleFieldName="",this.DescriptionFieldName="",this.StartDateFieldName="",this.EndDateFieldName="",this.LinkFieldName="",this.ImageFieldName="",this.SVGImages=new soby_SVGImages,this.ShowNavigation=!0,this.OnSelectionChanged=null,this.OnClick=null,this.CalendarViewID="soby_itemselection_"+soby_guid(),this.ContentDivSelector=e,this.Title=t,this.DataService=i,this.EmptyDataHtml=n,this.IdFieldName=r,this.TitleFieldName=l,this.DescriptionFieldName=h,this.StartDateFieldName=d,this.EndDateFieldName=c,this.LinkFieldName=u,this.ImageFieldName=p,this.EnsureItemSelectionExistency(),this.Year=s,this.Month=a-1,this.Day=o,this.Width=y,this.Height=g;var m=this;null!=this.DataService&&(this.DataService.ItemPopulated=function(e){for(var t=new soby_CalendarViewItems,i=0;i<e.length;i++){var s=e[i][m.IdFieldName],a=e[i][m.TitleFieldName],o=e[i][m.TitleFieldName],n=e[i][m.StartDateFieldName],r=null;null!=m.EndDateFieldName&&""!=m.EndDateFieldName&&(r=e[i][m.EndDateFieldName]);r=new soby_CalendarViewItem(s,a,o,n,r);t.push(r)}m.Items=t,m.GenerateCalendar()})}return s.prototype.Initialize=function(){$(this.ContentDivSelector).addClass("soby_calendarview"),$(this.ContentDivSelector).html("<div class='viewtypepanel'></div><div class='calendarviewpanel'></div>"),1==this.ShowNavigation&&(this.GenerateViewTypePanel(),this.SetViewTypeHeaderAsSelected(this.ViewType)),this.DataService.PopulateItems(null)},s.prototype.AddItem=function(e,t,i,s,a){a=new soby_CalendarViewItem(e,t,i,s,a);this.Items.push(a)},s.prototype.GetItemData=function(e){for(var t=0;t<soby_CalendarViewItems.length;t++)if(soby_CalendarViewItems[t].SobyCalendarViewItemId==e)return soby_CalendarViewItems[t];return null},s.prototype.GetItems=function(e,t){for(var i=new soby_CalendarViewItems,s=0;s<this.Items.length;s++){var a=this.Items[s];null==a.EndDate?a.StartDate>=e&&a.StartDate<=t&&i.push(a):(a.StartDate>=e&&a.StartDate<=t||a.EndDate>=e&&a.EndDate<=t)&&i.push(a)}return i},s.prototype.GetDateTasks=function(e,t){var i=e.getDay();0==i&&(i=7);var s=new Date;s.getDate()==e.getDate()&&s.getMonth()==e.getMonth()&&(s.getFullYear(),e.getFullYear());for(var a=$("<ul class='tasklist'></ul>"),o=this.GetItems(e,t),n=0;n<o.length;n++){var r=o[n],l=$("<li></li>");l.append("<a href='javascript:void(0)' title='"+r.Title+"'>"+r.Title+"</a>"),a.append(l)}return a},s.prototype.GenerateViewTypePanel=function(){var e="<table class='viewtypetabs'><td class='viewtypeheader daily'><a href='javascript:void(0)' onclick=\"soby_CalendarViews['"+this.CalendarViewID+"'].ChangeView(SobyCalendarViewTypes.Daily)\">&nbsp;&nbsp;&nbsp;Daily&nbsp;&nbsp;&nbsp;</a></td><td class='viewtypeheader weekly'><a href='javascript:void(0)' onclick=\"soby_CalendarViews['"+this.CalendarViewID+"'].ChangeView(SobyCalendarViewTypes.Weekly)\">&nbsp;&nbsp;&nbsp;Weekly&nbsp;&nbsp;&nbsp;</a></td><td class='viewtypeheader monthly'><a href='javascript:void(0)' onclick=\"soby_CalendarViews['"+this.CalendarViewID+"'].ChangeView(SobyCalendarViewTypes.Monthly)\">&nbsp;&nbsp;&nbsp;Monthly&nbsp;&nbsp;&nbsp;</a></td><td class='viewtypeheader yearly'><a href='javascript:void(0)' onclick=\"soby_CalendarViews['"+this.CalendarViewID+"'].ChangeView(SobyCalendarViewTypes.Yearly)\">&nbsp;&nbsp;&nbsp;Yearly&nbsp;&nbsp;&nbsp;</a></td><td class='viewtypeheader tasklist'><a href='javascript:void(0)' onclick=\"soby_CalendarViews['"+this.CalendarViewID+"'].ChangeView(SobyCalendarViewTypes.TaskList)\">&nbsp;&nbsp;&nbsp;Show All Events&nbsp;&nbsp;&nbsp;</a></td></table>";$(this.ContentDivSelector+" .viewtypepanel").html(e)},s.prototype.ShowPopupViewSelection=function(){var e="<table bgcolor=#D4D0C8 bordercolor=black border=1 cellspacing=0 cellpadding=0><tr><td bgcolor=#D4D0C8 style='font-size:13;font-face:tahoma;cursor:default' onmouseover=\"this.style.backgroundColor='MidnightBlue'\" onmouseout=\"this.style.backgroundColor='#D4D0C8';this.style.color='black'\"><a onmouseover=\"this.style.color='white'\" onmouseout=\"this.style.color='black'\" href='javascript:void(0)' onclick=\"objToolx.fnSetVisibility('idPopup',false);soby_CalendarViews['"+this.CalendarViewID+"'].Month="+this.Month+";soby_CalendarViews['"+this.CalendarViewID+"'].Day="+this.Day+";soby_CalendarViews['"+this.CalendarViewID+"'].ViewType=1;soby_CalendarViews['"+this.CalendarViewID+"'].GenerateCalendar()\">&nbsp;&nbsp;&nbsp;Show This Day&nbsp;&nbsp;&nbsp;</a></td></tr><tr><td bgcolor=#D4D0C8 style='font-size:13;font-face:tahoma;cursor:default' onmouseover=\"this.style.backgroundColor='MidnightBlue'\" onmouseout=\"this.style.backgroundColor='#D4D0C8';this.style.color='black'\"><a onmouseover=\"this.style.color='white'\" onmouseout=\"this.style.color='black'\" href='javascript:void(0)' onclick=\"objToolx.fnSetVisibility('idPopup',false);soby_CalendarViews['"+this.CalendarViewID+"'].Month="+this.Month+";soby_CalendarViews['"+this.CalendarViewID+"'].Day="+this.Day+";soby_CalendarViews['"+this.CalendarViewID+"'].ViewType=2;soby_CalendarViews['"+this.CalendarViewID+"'].GenerateCalendar()\">&nbsp;&nbsp;&nbsp;Show This Week&nbsp;&nbsp;&nbsp;</a></td></tr><tr><td bgcolor=#D4D0C8 style='font-size:13;font-face:tahoma' onmouseover=\"this.style.backgroundColor='MidnightBlue'\" onmouseout=\"this.style.backgroundColor='#D4D0C8';this.style.color='black'\"><a onmouseover=\"this.style.color='white'\" onmouseout=\"this.style.color='black'\" href='javascript:void(0)' onclick=\"javascript:objToolx.fnSetVisibility('idPopup',false);soby_CalendarViews['"+this.CalendarViewID+"'].Month="+this.Month+";soby_CalendarViews['"+this.CalendarViewID+"'].ViewType=3;soby_CalendarViews['"+this.CalendarViewID+"'].GenerateCalendar()\">&nbsp;&nbsp;&nbsp;Show This Month&nbsp;&nbsp;&nbsp;</a></td></tr><tr><td bgcolor=#D4D0C8 style='font-size:13;font-face:tahoma' onmouseover=\"this.style.backgroundColor='MidnightBlue'\" onmouseout=\"this.style.backgroundColor='#D4D0C8';this.style.color='black'\"><a onmouseover=\"this.style.color='white'\" onmouseout=\"this.style.color='black'\" href='javascript:void(0)' onclick=\"javascript:objToolx.fnSetVisibility('idPopup',false);soby_CalendarViews['"+this.CalendarViewID+"'].ViewType=4;soby_CalendarViews['"+this.CalendarViewID+"'].GenerateCalendar()\">&nbsp;&nbsp;&nbsp;Show This Year&nbsp;&nbsp;&nbsp;</a></td></tr><tr><td bgcolor=#D4D0C8 style='font-size:13;font-face:tahoma' onmouseover=\"this.style.backgroundColor='MidnightBlue'\" onmouseout=\"this.style.backgroundColor='#D4D0C8';this.style.color='black'\"><a onmouseover=\"this.style.color='white'\" onmouseout=\"this.style.color='black'\" href='javascript:void(0)' onclick=\"javascript:objToolx.fnSetVisibility('idPopup',false);soby_CalendarViews['"+this.CalendarViewID+"'].ViewType=5;soby_CalendarViews['"+this.CalendarViewID+"'].GenerateCalendar()\">&nbsp;&nbsp;&nbsp;Show All Event In This Year&nbsp;&nbsp;&nbsp;</a></td></tr></table>";$(this.ContentDivSelector+" .viewtypepanel").html(e)},s.prototype.SetViewTypeHeaderAsSelected=function(e){switch($(".viewtypeheader").removeClass("selected"),e){case SobyCalendarViewTypes.Daily:$(".viewtypeheader.daily").addClass("selected");break;case SobyCalendarViewTypes.Weekly:$(".viewtypeheader.weekly").addClass("selected");break;case SobyCalendarViewTypes.Monthly:$(".viewtypeheader.monthly").addClass("selected");break;case SobyCalendarViewTypes.Yearly:$(".viewtypeheader.yearly").addClass("selected");break;case SobyCalendarViewTypes.TaskList:$(".viewtypeheader.tasklist").addClass("selected")}},s.prototype.ChangeView=function(e){this.ViewType=e,this.SetViewTypeHeaderAsSelected(e),this.GenerateCalendar()},s.prototype.GenerateCalendar=function(){switch(this.ViewType){case 4:this.ShowYearlyView();break;case 3:this.ShowMonthlyView();break;case 1:this.ShowDailyView();break;case 2:this.ShowWeeklyView();break;case 5:this.ShowTasklistView()}},s.prototype.ShowTasklistView=function(){var e=new soby_WebGrid(this.ContentDivSelector+" .calendarviewpanel","",this.DataService,"There is no record found.");e.IsEditable=!1,e.IsSelectable=!1,e.AddColumn(this.TitleFieldName,"Title",SobyShowFieldsOn.All,null,null,!0,!0,!0,null,null,null),e.AddColumn(this.DescriptionFieldName,"Description",SobyShowFieldsOn.All,null,null,!0,!0,!0,null,null,null),e.AddColumn(this.StartDateFieldName,"Start Date",SobyShowFieldsOn.All,null,null,!0,!0,!0,null,null,null),e.AddColumn(this.EndDateFieldName,"End Date",SobyShowFieldsOn.All,null,null,!0,!0,!0,null,null,null),e.Initialize(!0)},s.prototype.ShowYearlyView=function(){var e="<table border=2 width='100%' cellspacing=0 cellpadding=3 bordercolor='#9999CC'><tr>";e+="<tr><td class='currentdaterange' colspan='3'><a href='javascript:void(0)' onclick=\"javascript:soby_CalendarViews['"+this.CalendarViewID+"'].JumpYear(-1)\">"+this.SVGImages.GetLeftCircle()+"</a> <a href='javascript:void(0)' onclick=\"javascript:soby_CalendarViews['"+this.CalendarViewID+"'].JumpYear(1)\">"+this.SVGImages.GetRightCircle()+"</a><font size=2>&nbsp;"+this.Year+"</font></td></tr>",e+="</tr></table>",e+="<table border=2 width='100%' height='100%' cellspacing=0 cellpadding=3 bordercolor='#9999CC'><tr>",e+="<td id='idCalendar1'></td>",e+="<td id='idCalendar2'></td>",e+="<td id='idCalendar3'></td>",e+="<td id='idCalendar4'></td>",e+="</tr><tr>",e+="<td id='idCalendar5'></td>",e+="<td id='idCalendar6'></td>",e+="<td id='idCalendar7'></td>",e+="<td id='idCalendar8'></td>",e+="</tr><tr>",e+="<td id='idCalendar9'></td>",e+="<td id='idCalendar10'></td>",e+="<td id='idCalendar11'></td>",e+="<td id='idCalendar12'></td>",e+="</tr>",e+="</table>",$(this.ContentDivSelector+" .calendarviewpanel").html("<div width="+this.Width+" height="+this.Height+" class='soby_maintable'>"+e+"</div>");new Array;for(var t=1;t<13;t++){var i=new soby_WSBuilder;i.Filters=new SobyFilters(!1),i.AddSchemaField("Id",SobyFieldTypes.Number,null),i.AddSchemaField("Title",SobyFieldTypes.Text,null),i.Filters.AddFilter("ParentId","0",SobyFieldTypes.Number,SobyFilterTypes.Equal,!1,!1);i=new soby_WebServiceService(i);i.Transport.Read=this.DataService.Transport.Read;i=new s("#idCalendar"+t,"Premises",i,this.Year,t,this.Day,"No record",this.IdFieldName,this.TitleFieldName,this.DescriptionFieldName,this.StartDateFieldName,this.EndDateFieldName,this.LinkFieldName,this.ImageFieldName,"100%","100%");i.ShowNavigation=!1,i.Initialize()}},s.prototype.GetMonthlyViewDayCell=function(e){var t=new Date(e.getFullYear(),e.getMonth(),e.getDate()+1,0,0,0,-1),i=1==(i=e.getDate().toString()).toString().length?"0"+i.toString():i.toString(),i=$("<td valign='top' width='14%' class='"+this.GetDayHeaderClass(e)+"' height='20%'><div align=right><a href=\"javascript:void(0)\" onclick=\"soby_CalendarViews['"+this.CalendarViewID+"'].NavigateToDate("+e.getFullYear()+","+e.getMonth()+","+e.getDate()+',1)">'+i+"</a></div>"),t=this.GetDateTasks(e,t);return i.append(t),i},s.prototype.ShowMonthlyView=function(){var e=$("<table width="+this.Width+" height="+this.Height+" class='soby_maintable'></table>");$(this.ContentDivSelector+" .calendarviewpanel").html(""),$(this.ContentDivSelector+" .calendarviewpanel").append(e);var t=new Date(this.Year,this.Month,1,0,0,0,0),i=new Date(this.Year,this.Month+1,0),s=i.getDate(),a="<a style='display:none' href=\"#\" onclick=\"javascript:soby_CalendarViews['"+this.CalendarViewID+"'].ViewType=4;soby_CalendarViews['"+this.CalendarViewID+"'].GenerateCalendar()\">^</a>";this.ShowNavigation?e.append("<tr><td class='currentdaterange'><a href='javascript:void(0)' onclick=\"javascript:soby_CalendarViews['"+this.CalendarViewID+"'].JumpMonth(-1)\">"+this.SVGImages.GetLeftCircle()+"</a> <a href='javascript:void(0)' onclick=\"javascript:soby_CalendarViews['"+this.CalendarViewID+"'].JumpMonth(1)\">"+this.SVGImages.GetRightCircle()+"</a>"+a+"<font size=2>&nbsp;"+this.MonthNames[t.getMonth()]+" "+t.getFullYear()+"</font></td></tr>"):e.append("<tr><td colspan=7 nowrap class='currentdaterange'><font size=2>"+this.MonthNames[t.getMonth()]+" "+t.getFullYear()+"</font></td></tr>"),e.append("<tr><td class='weekdayheader' align='center'>"+this.DayNames[0]+"</td><td class='weekdayheader' align='center'>"+this.DayNames[1]+"</td><td class='weekdayheader' align='center'>"+this.DayNames[2]+"</td><td class='weekdayheader' align='center'>"+this.DayNames[3]+"</td><td class='weekdayheader' align='center'>"+this.DayNames[4]+"</td><td class='saturdayheader' align='center'>"+this.DayNames[5]+"</td><td class='sundayheader' align='center'>"+this.DayNames[6]+"</td></tr>");var o=t.getDay();0==o&&(o=7);for(var n=$("<tr>"),r=0;r<o-1;r++)n.append("<td class='prevmonthday'>&nbsp;</td>");for(r=0;r<7-(o-1);r++){var l=this.GetMonthlyViewDayCell(t);n.append(l),t=new Date(t.getFullYear(),t.getMonth(),t.getDate()+1,0,0,0,0)}e.append(n);for(var h=0;h<6&&!(i<t);h++){if(n=$("<tr>"),6<s-t.getDate())for(r=0;r<7;r++){l=this.GetMonthlyViewDayCell(t);n.append(l),t=new Date(t.getFullYear(),t.getMonth(),t.getDate()+1,0,0,0,0)}else{for(var d=s-t.getDate()+1,c=7-d,r=0;r<d;r++){l=this.GetMonthlyViewDayCell(t);n.append(l),t=new Date(t.getFullYear(),t.getMonth(),t.getDate()+1,0,0,0,0)}for(r=0;r<c;r++)n.append("<td class='nextmonthday'>&nbsp;</td>")}e.append(n)}},s.prototype.GetDayOfTheWeek=function(e,t){var i=e.getDay(),t=e.getDate()-i+(i==t?-6:1);return new Date(e.setDate(t))},s.prototype.GetDayHeaderClass=function(e){var t=e.getDay();0==t&&(t=7);var i="weekday",s=new Date;return s.getDate()==e.getDate()&&s.getMonth()==e.getMonth()&&s.getFullYear()==e.getFullYear()?i="today":6==t?i="saturday":7==t&&(i="sunday"),i},s.prototype.ConvertDateToShortDateString=function(){},s.prototype.ShowWeeklyView=function(){var e=new Date(this.Year,this.Month,this.Day,0,0,0,0),t=this.GetDayOfTheWeek(e,0),i=new Date(t.getFullYear(),t.getMonth(),t.getDate()+6,0,0,0,0),s=this.GetDayOfTheWeek(e,0),a=$("<table width= "+this.Width+" height= "+this.Height+" class='soby_maintable' ></table>");$(this.ContentDivSelector+" .calendarviewpanel").html(""),$(this.ContentDivSelector+" .calendarviewpanel").append(a),a.append("<tr><td class='currentdaterange' colspan='6'><a href='javascript:void(0)' onclick=\"javascript:soby_CalendarViews['"+this.CalendarViewID+"'].JumpWeek(-1)\">"+this.SVGImages.GetLeftCircle()+"</a> <a href='javascript:void(0)' onclick=\"javascript:soby_CalendarViews['"+this.CalendarViewID+"'].JumpWeek(1)\">"+this.SVGImages.GetRightCircle()+"</a><font size=2>&nbsp;"+soby_GetFormatedDateString(t)+" - "+soby_GetFormatedDateString(i)+"</font></td></tr>"),(r=$("<tr></tr>")).append("<td>&nbsp;</td>");for(var o=0;o<7;o++){var n=this.GetDayHeaderClass(s);(d=$("<td class='weeklyviewdaynameheader' width='14%'><a href=\"javascript:void(0)\" onclick=\"soby_CalendarViews['"+this.CalendarViewID+"'].NavigateToDate("+s.getFullYear()+","+s.getMonth()+","+s.getDate()+',1)">'+s.getDate()+" "+this.DayNames[o]+"</a></td>")).addClass(n),r.append(d),s=new Date(s.getFullYear(),s.getMonth(),s.getDate()+1)}a.append(r);for(s=this.GetDayOfTheWeek(e,0),o=0;o<24;o++){var r=$("<tr></tr>"),l="0"+o;9<o&&(l=o.toString()),s=this.GetDayOfTheWeek(e,0),r.append("<td class='hourlabel'>"+l+"</td>");for(var h=0;h<7;h++){var d,c=new Date(s.getFullYear(),s.getMonth(),s.getDate(),o,0,0,0),u=new Date(s.getFullYear(),s.getMonth(),s.getDate(),o+1,0,0,-1),n=this.GetDayHeaderClass(s);(d=$("<td class='hourdata' valign='top'>&nbsp;</td>")).addClass(n);u=this.GetDateTasks(c,u);d.append(u),r.append(d),s=new Date(s.getFullYear(),s.getMonth(),s.getDate()+1)}a.append(r)}},s.prototype.ShowDailyView=function(){var e=new Date(this.Year,this.Month,this.Day),t=$("<table width= "+this.Width+" height= "+this.Height+" class='soby_maintable' ></table>");t.append("<tr><td class='currentdaterange' colspan='3'><a href='javascript:void(0)' onclick=\"javascript:soby_CalendarViews['"+this.CalendarViewID+"'].JumpDay(-1)\">"+this.SVGImages.GetLeftCircle()+"</a> <a href='javascript:void(0)' onclick=\"javascript:soby_CalendarViews['"+this.CalendarViewID+"'].JumpDay(1)\">"+this.SVGImages.GetRightCircle()+"</a><font size=2>&nbsp;"+soby_GetFormatedDateString(e)+"</font></td></tr>");for(var i=0;i<24;i++){var s=new Date(e.getFullYear(),e.getMonth(),e.getDate(),i,0,0,0),a=new Date(e.getFullYear(),e.getMonth(),e.getDate(),i+1,0,0,-1),o=$("<tr></tr>"),n=$("<td class='hourlabel' width='10%'></td>"),r=$("<td class='hourdata' width='90%' valign='top' colspan='4'></td>"),l="0"+i;9<i&&(l=i.toString()),n.text(l);a=this.GetDateTasks(s,a);r.append(a),o.append(n),o.append(r),t.append(o)}$(this.ContentDivSelector+" .calendarviewpanel").html(""),$(this.ContentDivSelector+" .calendarviewpanel").append(t)},s.prototype.JumpYear=function(e){e=new Date(this.Year+e,this.Month,this.Day);this.Year=e.getFullYear(),this.Month=e.getMonth(),this.GenerateCalendar()},s.prototype.JumpMonth=function(e){e=new Date(this.Year,this.Month+e,this.Day);this.Year=e.getFullYear(),this.Month=e.getMonth(),this.GenerateCalendar()},s.prototype.JumpWeek=function(e){e=new Date(this.Year,this.Month,this.Day+7*e);this.Year=e.getFullYear(),this.Month=e.getMonth(),this.Day=e.getDate(),this.GenerateCalendar()},s.prototype.JumpDay=function(e){e=new Date(this.Year,this.Month,this.Day+e);this.Year=e.getFullYear(),this.Month=e.getMonth(),this.Day=e.getDate(),this.GenerateCalendar()},s.prototype.NavigateToDate=function(e,t,i,s){this.Year=e,this.Month=t,this.Day=i,this.ViewType=s,this.GenerateCalendar()},s.prototype.GetSelectedItems=function(){var e=new Array,t=$("input[name='checkbox_"+this.CalendarViewID+"']:checked");0==this.AllowCheckBoxes&&(t=$("input[name='checkbox_"+this.CalendarViewID+"']:checked"));for(var i=0;i<t.length;i++)e[e.length]=this.GetItemData($(t[i]).val());return e},s.prototype.ClickNode=function(e){null!=this.OnClick&&this.OnClick(this.CalendarViewID,e)},s.prototype.CheckNode=function(e){null!=this.OnSelectionChanged&&this.OnSelectionChanged(this.CalendarViewID)},s.prototype.EnsureItemSelectionExistency=function(){for(var e in soby_CalendarViews)if(e==this.CalendarViewID)return;soby_CalendarViews[this.CalendarViewID]=this},s}(),soby_CalendarViewItems=function(i){function s(e){var t=i.call(this)||this;return e&&t.push.apply(t,e),Object.setPrototypeOf(t,Object.create(s.prototype)),t}return __extends(s,i),s}(Array),soby_CalendarViewItem=function(e,t,i,s,a){this.Id="",this.StartDate=null,this.EndDate=null,this.Title="",this.Description="",this.Id=e,this.Title=t,this.Description=i,this.StartDate=s,this.EndDate=a},__extends=this&&this.__extends||function(){var s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)};return function(e,t){function i(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),sobyCharts=new Array,SobyChartCalculatedValues=function(){function e(e){this.Chart=null,this.ValueLabelCount=10,this.VerticalAxisLabelHeight=0,this.VerticalAxisTitleWidth=30,this.HorizontalAxisLabelWidth=0,this.HorizontalAxisLabelHeight=30,this.HorizontalAxisTitleHeight=30,this.VerticalAxisLabelWidth=50,this.VerticalAxisLabelPieceValue=0,this.HorizontalAxisLabelPieceValue=0,this.Padding=20,this.PlotAreaWidth=0,this.PlotAreaHeight=0,this.LegendPanelWidth=0,this.LegendPanelHeight=0,this.MaxValue=null,this.MinValue=null,this.TotalValue=null,this.VerticalAxisLabelXStartPoint=10,this.VerticalAxisLabelYStartPoint=30,this.HorizontalAxisLabelXStartPoint=this.VerticalAxisLabelXStartPoint+50,this.HorizontalAxisLabelYStartPoint=10,this.VerticalAxisTitleXStartPoint=0,this.VerticalAxisTitleYStartPoint=0,this.HorizontalAxisTitleXStartPoint=0,this.HorizontalAxisTitleYStartPoint=0,this.xPlotAreaStartPixel=30,this.yPlotAreaStartPixel=30,this.Chart=e}return e.prototype.Calculate=function(){this.VerticalAxisLabelXStartPoint=10,this.VerticalAxisLabelYStartPoint=30,this.HorizontalAxisLabelXStartPoint=this.VerticalAxisLabelXStartPoint+50,this.HorizontalAxisLabelYStartPoint=10,this.xPlotAreaStartPixel=30,this.yPlotAreaStartPixel=30,this.Chart.Legend.Position!==SobyChartElementPosition.Top&&this.Chart.Legend.Position!==SobyChartElementPosition.Bottom||(this.LegendPanelWidth=this.Chart.Width,this.LegendPanelHeight=30),this.Chart.Legend.Position!==SobyChartElementPosition.Left&&this.Chart.Legend.Position!==SobyChartElementPosition.Right||(this.LegendPanelWidth=70,this.LegendPanelHeight=this.Chart.Height),this.MinValue=null,this.MaxValue=0;for(var e=this.TotalValue=0;e<this.Chart.Datasets.length;e++)for(var t=0;t<this.Chart.Datasets[e].Data.length;t++){var i=this.Chart.Datasets[e].Data[t];this.TotalValue+=i,i>this.MaxValue&&(this.MaxValue=i),(null===this.MinValue||i<this.MinValue)&&(this.MinValue=i)}this.yPlotAreaStartPixel=this.Chart.Height-this.Padding-this.HorizontalAxisLabelHeight,this.xPlotAreaStartPixel=this.Padding+this.VerticalAxisLabelWidth,this.HorizontalAxisLabelYStartPoint=this.Chart.Height-20,this.Chart.Legend.Position===SobyChartElementPosition.Bottom?(this.yPlotAreaStartPixel-=this.LegendPanelHeight,this.HorizontalAxisLabelYStartPoint-=this.LegendPanelHeight):this.Chart.Legend.Position===SobyChartElementPosition.Left&&(this.xPlotAreaStartPixel+=this.LegendPanelWidth,this.VerticalAxisLabelXStartPoint+=this.LegendPanelWidth),null!==this.Chart.HorizontalAxisSettings.Title&&""!==this.Chart.HorizontalAxisSettings.Title&&(this.yPlotAreaStartPixel-=this.HorizontalAxisTitleHeight,this.HorizontalAxisLabelYStartPoint-=this.HorizontalAxisTitleHeight),null!==this.Chart.VerticalAxisSettings.Title&&""!==this.Chart.VerticalAxisSettings.Title&&(this.xPlotAreaStartPixel+=this.VerticalAxisTitleWidth,this.VerticalAxisLabelXStartPoint+=this.VerticalAxisTitleWidth),this.PlotAreaWidth=this.Chart.Width-this.Padding-this.xPlotAreaStartPixel,this.PlotAreaHeight=this.yPlotAreaStartPixel-this.Padding,this.Chart.Legend.Position===SobyChartElementPosition.Bottom||this.Chart.Legend.Position===SobyChartElementPosition.Top?this.PlotAreaHeight-=this.LegendPanelHeight:this.Chart.Legend.Position!==SobyChartElementPosition.Left&&this.Chart.Legend.Position!==SobyChartElementPosition.Right||(this.PlotAreaWidth-=this.LegendPanelWidth),this.Chart.Label.LabelPosition===SobyChartElementPosition.Bottom?(this.VerticalAxisLabelHeight=this.PlotAreaHeight/(this.ValueLabelCount+1),this.HorizontalAxisLabelWidth=this.PlotAreaWidth/this.Chart.Label.Labels.length,this.VerticalAxisLabelPieceValue=this.MaxValue/this.ValueLabelCount,this.HorizontalAxisLabelPieceValue=1):(this.VerticalAxisLabelHeight=this.PlotAreaHeight/this.Chart.Label.Labels.length,this.HorizontalAxisLabelWidth=this.PlotAreaHeight/(this.ValueLabelCount+1),this.VerticalAxisLabelPieceValue=1,this.HorizontalAxisLabelPieceValue=this.MaxValue/this.ValueLabelCount)},e}(),SobyAxisSettings=function(){this.Title=null,this.TitleFont="10px Arial",this.TitleColour="#000000",this.LabelFont="10px Arial",this.LabelColour="#000000"},SobyPlotAreaSettings=function(){this.Colour="#000000",this.LineWidth=.2},SobyTitleSettings=function(){this.Title="",this.Font="10px Arial",this.Colour="#000000"},SobyLabelSettings=function(){this.LabelPosition=SobyChartElementPosition.Bottom,this.Colours=["#4472c4","#ed7d31","#ffce3a","#a5a5a5","#5b9bd5","#70ad47"],this.Font="10px Arial",this.DialogTextColour="#000000",this.Format="$label"},SobyChart=function(){function SobyChart(e,t,i,s,a){this.ChartID="",this.ChartTooltipID="",this.ChartClassName="",this.ContentDivSelector="",this.Title=null,this.Height=100,this.Width=200,this.Datasets=null,this.EmptyDataHtml="",this.Type=null,this.Legend=null,this.Label=new SobyLabelSettings,this.PlotAreaSettings=new SobyPlotAreaSettings,this.VerticalAxisSettings=new SobyAxisSettings,this.HorizontalAxisSettings=new SobyAxisSettings,this.ChartParts=new Array,this.CalculatedValues=new SobyChartCalculatedValues(this),this.MouseOverDotIndex=null,this.OnSelectionChanged=null,this.OnClick=null,this.ChartID="soby_chart_"+soby_guid(),this.ChartTooltipID=this.ChartID+"_tip",this.Type=i[0].Type,this.ContentDivSelector=e,this.Title=t,this.Label.Labels=a,this.Datasets=i,this.EmptyDataHtml=s,this.EnsureItemSelectionExistency(),this.VerticalAxisSettings.TitleFont="bold 12px Arial",this.Legend=new SobyLegendPanel(this,a,this.Label.Colours),this.Type===SobyChartTypes.LineChart?this.ChartClassName="soby_linechart":this.Type===SobyChartTypes.BarChart?this.ChartClassName="soby_barchart":this.Type===SobyChartTypes.ColumnChart?this.ChartClassName="soby_columnchart":this.Type===SobyChartTypes.PieChart?this.ChartClassName="soby_piechart":this.Type===SobyChartTypes.RadarChart?this.ChartClassName="soby_radarchart":this.Type===SobyChartTypes.PolarAreaChart?this.ChartClassName="soby_polarareachart":this.Type===SobyChartTypes.DoughnutChart&&(this.ChartClassName="soby_doughnutchart");for(var o=0;o<this.Datasets.length;o++)this.ChartParts.push(sobyChartPartFactory.GetChartPart(this,this.Datasets[o])),this.Datasets[o].Colour=this.Label.Colours[o],this.Datasets[o].Index=o}return SobyChart.prototype.GetContext=function(){return eval("document.getElementById('"+this.ChartID+"').getContext('2d');")},SobyChart.prototype.GetCanvas=function(){return eval("document.getElementById('"+this.ChartID+"');")},SobyChart.prototype.GetTooltipContainer=function(){return eval("document.getElementById('"+this.ChartTooltipID+"');")},SobyChart.prototype.EnsureItemSelectionExistency=function(){for(var e in sobyCharts)if(e===this.ChartID)return;sobyCharts[this.ChartID]=this},SobyChart.prototype.RenderTooltip=function(e,t,i,s){e.style.border="5px solid black",e.style.borderRadius="10px",e.style.width="125px";var a=$("<div></div>"),o=$('<div style=\'color:white;background-color: black;padding:5px;font-size:12px;font-family: "Segoe UI", "Segoe UI Web(West European)", "Segoe UI", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif;\'></div>');o.append(t.Label),o.append("<br>"),o.append("<div style='background-color: "+t.Colour+";width: 25px;float: left;'>&nbsp;</div>&nbsp;"),o.append(t.DatasetTitle+": "+t.Value),a.append(o),e.innerHTML=a.html()},SobyChart.prototype.TransformLightenDarkenColor=function(e,t){var i=!1;"#"===e[0]&&(e=e.slice(1),i=!0);var s=parseInt(e,16),a=(s>>16)+t;255<a?a=255:a<0&&(a=0);e=(s>>8&255)+t;255<e?e=255:e<0&&(e=0);t=(255&s)+t;return 255<t?t=255:t<0&&(t=0),(i?"#":"")+(t|e<<8|a<<16).toString(16)},SobyChart.prototype.RestoreDotColours=function(){for(var e=0;e<this.ChartParts.length;e++)this.ChartParts[e].RestoreDotColours()},SobyChart.prototype.HandleMouseMove=function(e){for(var chart=sobyCharts[eval("e.target.id")],tooltipContainer=chart.GetTooltipContainer(),canvasOffset=$("#"+chart.ChartID).offset(),tooltipOffsetX=canvasOffset.left-$(window).scrollLeft(),tooltipOffsetY=canvasOffset.top-$(window).scrollTop(),mouseX=e.clientX-tooltipOffsetX,mouseY=e.clientY-tooltipOffsetY,i=0;i<chart.ChartParts.length;i++)if(!0===chart.ChartParts[i].HandleMouseMove(mouseX,mouseY))return;tooltipContainer.style.display="none"},SobyChart.prototype.RoundedRect=function(e,t,i,s,a,o){var n=this.GetTooltipContainer();n.strokeStyle=a,n.fillStyle=a,n.lineJoin="round",n.lineWidth=o,n.strokeRect(e+.5*o,t+.5*o,i-o,s-o),n.fillRect(e+.5*o,t+.5*o,i-o,s-o),n.stroke(),n.fill()},SobyChart.prototype.Initialize=function(){$(this.ContentDivSelector).addClass("soby_chart"),$(this.ContentDivSelector).addClass(this.ChartClassName),this.PopulateItems(),this.DrawPane();for(var e=0;e<this.ChartParts.length;e++)this.ChartParts[e].PopulateItems()},SobyChart.prototype.PopulateItems=function(){var e=$("<canvas id='"+this.ChartID+"' width='"+this.Width+"' height='"+this.Height+"' style='border: 1px solid;'></canvas>"),t=$("<div id='"+this.ChartTooltipID+"' width='120' height='40' style='position: absolute;'></div>");$(this.ContentDivSelector).html(""),$(this.ContentDivSelector).append(e),$(this.ContentDivSelector).append(t),document.getElementById(this.ChartID).addEventListener("mousemove",this.HandleMouseMove)},SobyChart.prototype.ClickNode=function(e){null!==this.OnClick&&this.OnClick(this.ChartID,e)},SobyChart.prototype.CalculateValues=function(){this.CalculatedValues.Calculate()},SobyChart.prototype.DrawPane=function(){this.CalculateValues();var e=this.GetContext();if(e.fillStyle=this.Label.Colours[0],this.Type!==SobyChartTypes.PieChart&&this.Type!==SobyChartTypes.PolarAreaChart&&this.Type!==SobyChartTypes.DoughnutChart)if(this.Label.LabelPosition===SobyChartElementPosition.Bottom){for(var t=0;t<this.Label.Labels.length;t++){var i=t*this.CalculatedValues.HorizontalAxisLabelWidth+this.CalculatedValues.xPlotAreaStartPixel;e.font=this.HorizontalAxisSettings.LabelFont,e.strokeStyle=this.HorizontalAxisSettings.LabelColour,e.lineWidth=1,e.strokeText(this.Label.Labels[t],i,this.CalculatedValues.HorizontalAxisLabelYStartPoint),e.beginPath(),e.strokeStyle=this.PlotAreaSettings.Colour,e.lineWidth=this.PlotAreaSettings.LineWidth,e.moveTo(i,this.getYPixel(0)),e.lineTo(i,this.getYPixel(this.CalculatedValues.MaxValue)),e.stroke()}var s=this.Label.Labels.length*this.CalculatedValues.HorizontalAxisLabelWidth+this.CalculatedValues.xPlotAreaStartPixel;null!==this.HorizontalAxisSettings.Title&&""!==this.HorizontalAxisSettings.Title&&(e.font=this.HorizontalAxisSettings.TitleFont,e.strokeStyle=this.HorizontalAxisSettings.TitleColour,e.lineWidth=1,e.strokeText(this.HorizontalAxisSettings.Title,s,this.CalculatedValues.HorizontalAxisLabelYStartPoint)),e.beginPath(),e.strokeStyle=this.PlotAreaSettings.Colour,e.lineWidth=this.PlotAreaSettings.LineWidth,e.moveTo(s,this.getYPixel(0)),e.lineTo(s,this.getYPixel(this.CalculatedValues.MaxValue)),e.stroke();for(t=0;t<this.CalculatedValues.ValueLabelCount+1;t++){var a=this.getYPixel(t*this.CalculatedValues.VerticalAxisLabelPieceValue);e.font=this.VerticalAxisSettings.LabelFont,e.strokeStyle=this.VerticalAxisSettings.LabelColour,e.lineWidth=1,e.strokeText(t*this.CalculatedValues.VerticalAxisLabelPieceValue,this.CalculatedValues.VerticalAxisLabelXStartPoint,a),e.beginPath(),e.strokeStyle=this.PlotAreaSettings.Colour,e.lineWidth=this.PlotAreaSettings.LineWidth,e.moveTo(this.CalculatedValues.xPlotAreaStartPixel,a),e.lineTo(s,a),e.stroke()}}else{for(t=0;t<this.Label.Labels.length;t++){a=this.getYPixel(t),s=this.CalculatedValues.VerticalAxisLabelXStartPoint;e.font=this.VerticalAxisSettings.LabelFont,e.strokeStyle=this.VerticalAxisSettings.LabelColour,e.lineWidth=1,e.strokeText(this.Label.Labels[t],s,a),e.strokeStyle=this.PlotAreaSettings.Colour,e.lineWidth=this.PlotAreaSettings.LineWidth,e.beginPath(),e.moveTo(this.CalculatedValues.xPlotAreaStartPixel,a),e.lineTo(this.CalculatedValues.xPlotAreaStartPixel+this.CalculatedValues.PlotAreaWidth,a),e.stroke()}var o,n,r,l=this.getYPixel(this.Label.Labels.length);null!==this.HorizontalAxisSettings.Title&&""!==this.HorizontalAxisSettings.Title&&(e.font=this.HorizontalAxisSettings.TitleFont,e.strokeStyle=this.HorizontalAxisSettings.TitleColour,e.lineWidth=1,e.strokeText(this.HorizontalAxisSettings.Title,this.CalculatedValues.xPlotAreaStartPixel,this.CalculatedValues.yPlotAreaStartPixel+this.CalculatedValues.HorizontalAxisLabelHeight+this.CalculatedValues.HorizontalAxisTitleHeight)),null!==this.VerticalAxisSettings.Title&&""!==this.VerticalAxisSettings.Title&&(e.save(),c=e.measureText(this.VerticalAxisSettings.Title).width,o=Math.PI/2,n=this.CalculatedValues.VerticalAxisTitleXStartPoint+20,r=this.CalculatedValues.yPlotAreaStartPixel-100,e.translate(n,r),e.rotate(-o),e.textBaseline="middle",e.font=this.VerticalAxisSettings.TitleFont,e.strokeStyle=this.VerticalAxisSettings.TitleColour,e.fillStyle=this.VerticalAxisSettings.TitleColour,e.lineWidth=1,e.fillText(this.VerticalAxisSettings.Title,-c,0),e.restore()),e.strokeStyle=this.PlotAreaSettings.Colour,e.lineWidth=this.PlotAreaSettings.LineWidth,e.beginPath(),e.moveTo(this.CalculatedValues.xPlotAreaStartPixel,l),e.lineTo(this.CalculatedValues.xPlotAreaStartPixel+this.CalculatedValues.PlotAreaWidth,l),e.stroke();for(t=0;t<this.CalculatedValues.ValueLabelCount+1;t++){a=this.CalculatedValues.yPlotAreaStartPixel+this.CalculatedValues.VerticalAxisLabelHeight,s=this.getXPixel(t*this.CalculatedValues.HorizontalAxisLabelPieceValue);e.font=this.HorizontalAxisSettings.LabelFont,e.strokeStyle=this.HorizontalAxisSettings.LabelColour,e.lineWidth=1,e.strokeText(t*this.CalculatedValues.HorizontalAxisLabelPieceValue,s,a),e.strokeStyle=this.PlotAreaSettings.Colour,e.lineWidth=this.PlotAreaSettings.LineWidth,e.beginPath(),e.moveTo(s,this.CalculatedValues.yPlotAreaStartPixel),e.lineTo(s,this.CalculatedValues.yPlotAreaStartPixel-this.CalculatedValues.PlotAreaHeight),e.stroke()}}if(this.Legend.Position!==SobyChartElementPosition.Hidden){var h=new Array;if(this.Type===SobyChartTypes.PieChart||this.Type===SobyChartTypes.PolarAreaChart||this.Type===SobyChartTypes.DoughnutChart)for(var d=0;d<this.Label.Labels.length;d++)h.push(this.Label.Labels[d]);else for(d=0;d<this.Datasets.length;d++)h.push(this.Datasets[d].Title);SobyChartAligment.Horizontally;this.Legend.Position!==SobyChartElementPosition.Left&&this.Legend.Position!==SobyChartElementPosition.Right||SobyChartAligment.Vertically;var c=10,l=10;this.Legend.Position===SobyChartElementPosition.Bottom&&(l=this.Height-30),this.Legend.Position===SobyChartElementPosition.Right&&(c=this.Width-70),this.Legend.Height=this.CalculatedValues.LegendPanelHeight,this.Legend.Width=this.CalculatedValues.LegendPanelWidth,this.Legend.X=c,this.Legend.Y=l,this.Legend.Paint()}},SobyChart.prototype.getXPixel=function(e){var t=this.CalculatedValues.MaxValue;return this.Label.LabelPosition===SobyChartElementPosition.Bottom&&(t=this.Label.Labels.length+1),this.CalculatedValues.xPlotAreaStartPixel+this.CalculatedValues.PlotAreaWidth/t*e},SobyChart.prototype.getYPixel=function(e){var t=this.CalculatedValues.MaxValue;return this.Label.LabelPosition===SobyChartElementPosition.Left&&(t=this.Label.Labels.length),this.CalculatedValues.yPlotAreaStartPixel-this.CalculatedValues.PlotAreaHeight/t*e},SobyChart}(),SobyChartPartFactory=function(){function e(){}return e.prototype.GetChartPart=function(e,t){var i=null;return t.Type===SobyChartTypes.BarChart?i=new SobyBarChartPart(e,t):t.Type===SobyChartTypes.ColumnChart?i=new SobyColumnChartPart(e,t):t.Type===SobyChartTypes.DoughnutChart?i=new SobyDoughnutChartPart(e,t):t.Type===SobyChartTypes.LineChart?i=new SobyLineChartPart(e,t):t.Type===SobyChartTypes.PieChart?i=new SobyPieChartPart(e,t):t.Type===SobyChartTypes.PolarAreaChart?i=new SobyPolarAreaChartPart(e,t):t.Type===SobyChartTypes.RadarChart&&(i=new SobyRadarChartPart(e,t)),i},e}(),SobyChartPart=function(){function e(e,t){this.Type=null,this.Dots=null,this.Chart=e,this.Dataset=t,this.Dots=new Array}return e.prototype.GetContext=function(){return this.Chart.GetContext()},e.prototype.GetCalculatedValues=function(){return this.Chart.CalculatedValues},e.prototype.RestoreDotColours=function(){for(var e=0;e<this.Dots.length;e++){var t,i=this.Dots[e];i.CurrentColour!==i.Colour&&(i.CurrentColour=i.Colour,t=this.GetContext(),this.Chart.Type===SobyChartTypes.DoughnutChart?(t.lineWidth=2*i.r/5,t.strokeStyle=i.Colour,t.stroke(i.Path2D)):this.Chart.Type===SobyChartTypes.LineChart?(t.lineWidth=i.r,t.strokeStyle=i.Colour,t.stroke(i.Path2D)):(t.fillStyle=i.Colour,t.fill(i.Path2D)))}},e.prototype.SetMouseOverColour=function(e,t){this.Chart.MouseOverDotIndex=[e,t];e=this.Dots[t];e.CurrentColour=this.Chart.TransformLightenDarkenColor(e.Colour,30);t=this.GetContext();this.Chart.Type===SobyChartTypes.DoughnutChart?(t.lineWidth=2*e.r/5,t.strokeStyle=e.CurrentColour,t.stroke(e.Path2D)):this.Chart.Type===SobyChartTypes.LineChart?(t.lineWidth=e.r,t.strokeStyle=e.CurrentColour,t.stroke(e.Path2D)):(t.fillStyle=e.CurrentColour,t.fill(e.Path2D))},e.prototype.CheckMouseHit=function(e,t,i){var s=this.GetContext();return this.Type===SobyChartTypes.LineChart?s.isPointInStroke(i.Path2D,e,t):s.isPointInPath(i.Path2D,e,t)},e.prototype.HandleMouseMove=function(e,t){for(var i=this.Chart.GetTooltipContainer(),s=0;s<this.Dots.length;s++){var a=this.Dots[s];if(!0===this.CheckMouseHit(e,t,a))return null!==this.Chart.MouseOverDotIndex&&this.Dataset.Index===this.Chart.MouseOverDotIndex[0]&&this.Chart.MouseOverDotIndex[1]===s||(this.RestoreDotColours(),this.SetMouseOverColour(this.Dataset.Index,s),i.style.left=e+5+"px",i.style.top=t-60+"px",this.Chart.RenderTooltip(i,a,e,t),i.style.display="block"),!0}return!1},e.prototype.GenerateLabelFromFormat=function(e,t,i){return this.Chart.Label.Format.replace(/\$label/gi,e).replace(/\$value/gi,t.toString()).replace(/\$percentage/gi,i.toString())},e.prototype.PopulateItems=function(){},e}(),SobyLineChartPart=function(i){function e(e,t){t=i.call(this,e,t)||this;return t.Type=SobyChartTypes.LineChart,t}return __extends(e,i),e.prototype.PopulateItems=function(){var e=this.GetContext();e.lineWidth=3,e.lineCap="butt",this.Dots=new Array,e.fillStyle=this.Dataset.Colour,e.strokeStyle=this.Dataset.Colour;for(var t=0,i=0,s=0;s<this.Dataset.Data.length;s++){var a=new Path2D,o=this.Dataset.Data[s],n=this.GetCalculatedValues().xPlotAreaStartPixel+s*this.GetCalculatedValues().HorizontalAxisLabelWidth,r=this.Chart.getYPixel(o);0===s||(a.moveTo(t,i),a.lineTo(n,r)),e.stroke(a),this.Dots.push(new SobyChartDotValue(this.Chart.Label.Labels[s],o,this.Dataset.Title,this.Dataset.Colour,n,r,4,16,a)),t=n,i=r}for(s=0;s<this.Dots.length;s++)e.fillStyle=this.Dots[s].Colour,e.beginPath(),e.arc(this.Dots[s].X,this.Dots[s].Y,4,0,2*Math.PI,!0),e.fill()},e}(SobyChartPart),SobyColumnChartPart=function(i){function e(e,t){t=i.call(this,e,t)||this;return t.ColumnWidth=null,t.Type=SobyChartTypes.ColumnChart,t}return __extends(e,i),e.prototype.PopulateItems=function(){var e=this.GetContext();e.lineWidth=3,e.lineCap="butt",e.beginPath(),this.Dots=new Array,this.ColumnWidth=(this.GetCalculatedValues().HorizontalAxisLabelWidth-15)/this.Chart.Datasets.length;for(var t=0;t<this.Dataset.Data.length;t++){e.fillStyle=this.Dataset.Colour,e.strokeStyle=this.Dataset.Colour,null!==this.Chart.MouseOverDotIndex&&this.Dataset.Index===this.Chart.MouseOverDotIndex[0]&&t===this.Chart.MouseOverDotIndex[1]&&(e.fillStyle="purple",e.strokeStyle="purple");var i=new Path2D,s=this.Dataset.Data[t],a=this.GetCalculatedValues().xPlotAreaStartPixel+t*this.GetCalculatedValues().HorizontalAxisLabelWidth+this.Dataset.Index*this.ColumnWidth,o=this.Chart.getYPixel(0);i.rect(a,o,this.ColumnWidth,this.Chart.getYPixel(s)-o),e.fill(i),this.Dots.push(new SobyChartDotValue(this.Chart.Label.Labels[t],s,this.Dataset.Title,this.Dataset.Colour,a,o,4,16,i))}},e}(SobyChartPart),SobyBarChartPart=function(i){function e(e,t){t=i.call(this,e,t)||this;return t.BarHeight=null,t.Type=SobyChartTypes.BarChart,t.Chart.Label.LabelPosition=SobyChartElementPosition.Left,t}return __extends(e,i),e.prototype.PopulateItems=function(){var e=this.GetContext();e.fillStyle=this.Dataset.Colour,e.strokeStyle=this.Dataset.Colour,e.lineWidth=3,e.lineCap="butt",e.beginPath(),this.BarHeight=(this.GetCalculatedValues().VerticalAxisLabelHeight-15)/this.Chart.Datasets.length,this.Dots=new Array,e.fillStyle=this.Dataset.Colour,e.strokeStyle=this.Dataset.Colour;for(var t=0;t<this.Dataset.Data.length;t++){var i=new Path2D,s=this.Dataset.Data[t],a=this.Chart.getXPixel(0),o=this.GetCalculatedValues().yPlotAreaStartPixel-t*this.GetCalculatedValues().VerticalAxisLabelHeight-this.BarHeight*(this.Dataset.Index+1);i.rect(a,o,this.Chart.getXPixel(s)-a,this.BarHeight),e.fill(i),this.Dots.push(new SobyChartDotValue(this.Chart.Label.Labels[t],s,this.Dataset.Title,this.Dataset.Colour,a,o,4,16,i))}},e}(SobyChartPart),SobyRadarChartPart=function(i){function e(e,t){t=i.call(this,e,t)||this;return t.Type=SobyChartTypes.RadarChart,t}return __extends(e,i),e.prototype.PopulateItems=function(){var e=this.GetContext();e.lineWidth=3,e.lineCap="butt",e.beginPath(),this.Dots=new Array;for(var t=0;t<this.Dataset.Data.length;t++){var i=this.Dataset.Data[t],s=this.GetCalculatedValues().HorizontalAxisLabelXStartPoint+t*this.GetCalculatedValues().HorizontalAxisLabelWidth,a=this.Chart.Height-i-this.GetCalculatedValues().HorizontalAxisLabelYStartPoint-50;this.Dots.push(new SobyChartDotValue(this.Chart.Label.Labels[t],i,this.Dataset.Title,this.Dataset.Colour,s,a,4,16,null)),e.beginPath(),e.rect(s,30+a,20,i),e.stroke()}e.stroke()},e}(SobyChartPart),SobyPieChartPart=function(i){function e(e,t){t=i.call(this,e,t)||this;return t.Offset=0,t.Radius=0,t.Type=SobyChartTypes.PieChart,t.GetCalculatedValues().Padding=40,t}return __extends(e,i),e.prototype.PopulateItems=function(){this.Radius=(this.Chart.Height-2*this.GetCalculatedValues().Padding-this.GetCalculatedValues().HorizontalAxisLabelHeight)/2;var e=this.GetContext();e.lineWidth=3,e.lineCap="butt",e.beginPath();var t=2/this.GetCalculatedValues().TotalValue,i=this.Radius/this.GetCalculatedValues().MaxValue,s=(this.Chart.Width-this.Radius)/2+this.GetCalculatedValues().Padding,a=this.Chart.Height-this.Radius-this.GetCalculatedValues().Padding,o=0;this.Dots=new Array;for(var n=0;n<this.Dataset.Data.length;n++){var r=new Path2D,l=this.Dataset.Data[n],h=0===this.Offset?this.Radius:i*l,d=o,c=((o+=Math.PI*t*l)+d)/2,u=Math.round(1e4*l/this.GetCalculatedValues().TotalValue)/100,p=Math.cos(c)*this.Offset,y=Math.sin(c)*this.Offset;e.fillStyle=this.Chart.Label.Colours[n%this.Chart.Label.Colours.length],e.strokeStyle=this.Chart.Label.Colours[n%this.Chart.Label.Colours.length],this.Chart.Type===SobyChartTypes.PieChart||this.Chart.Type===SobyChartTypes.PolarAreaChart?(e.beginPath(),r.moveTo(s+p,a+y),r.arc(s+p,a+y,h,d,o),r.lineTo(s+p,a+y),e.stroke(),e.fill(r)):(e.lineWidth=2*h/5,r.arc(s+p,a+y,h-e.lineWidth/2,d,o),e.stroke(r));var g=(d+o)/2,m=0,b=0,S=Math.PI/2,f=m=s+Math.cos(g)*(this.Radius+10),c=b=a+Math.sin(g)*(this.Radius+10);g<S||(g<2*S?(f=(m-=30)-100,c=b-20):g<3*S&&(f=(m-=30)-100,c=b-15)),e.lineWidth=1,e.beginPath(),e.strokeStyle=this.Chart.Label.Colours[n%this.Chart.Label.Colours.length],e.moveTo(s,a),e.lineTo(f,c),e.stroke();m=50,b=this.GenerateLabelFromFormat(this.Chart.Label.Labels[n],l,u);5.4*b.length>m&&(m=5.4*b.length);u=new Path2D;u.rect(f,c,m,15),e.fillStyle=this.Chart.Label.Colours[n%this.Chart.Label.Colours.length],e.lineWidth=.3,e.font="normal 10px Arial",e.strokeStyle="#FFFFFF",e.fill(u),e.strokeText(b,f+5,c+12),this.Dots.push(new SobyChartDotValue(this.Chart.Label.Labels[n],l,this.Dataset.Title,this.Chart.Label.Colours[n%this.Chart.Label.Colours.length],s+p,a+y,h,16,r))}},e}(SobyChartPart),SobyPolarAreaChartPart=function(i){function e(e,t){t=i.call(this,e,t)||this;return t.Type=SobyChartTypes.PolarAreaChart,t.Offset=3,t}return __extends(e,i),e}(SobyPieChartPart),SobyDoughnutChartPart=function(i){function e(e,t){t=i.call(this,e,t)||this;return t.Type=SobyChartTypes.DoughnutChart,t.Offset=0,t}return __extends(e,i),e}(SobyPieChartPart),SobyLegendPanel=function(){function e(e,t,i){this.Chart=null,this.Height=null,this.Width=null,this.X=null,this.Y=null,this.Titles=null,this.Colours=null,this.Position=SobyChartElementPosition.Top,this.TitleAligment=SobyChartAligment.Horizontally,this.VerticalAligment=SobyChartVerticalAligment.Top,this.HorizontalAligment=SobyChartHorizontalAligment.Center,this.Chart=e,this.Titles=t,this.Colours=i}return e.prototype.Paint=function(){for(var e=this.Chart.GetContext(),t=0,i=0;i<this.Titles.length;i++)t+=this.Titles[i].length;var s=this.X-20,a=this.Y;this.TitleAligment===SobyChartAligment.Horizontally?this.HorizontalAligment===SobyChartHorizontalAligment.Left?s+=30:this.HorizontalAligment===SobyChartHorizontalAligment.Center?s+=(this.Width-6*t-15*this.Titles.length)/2:this.HorizontalAligment===SobyChartHorizontalAligment.Right&&(s+=this.Width-6*t-15*this.Titles.length):this.VerticalAligment===SobyChartVerticalAligment.Top?a+=40:this.VerticalAligment===SobyChartVerticalAligment.Middle?a+=(this.Height-15*this.Titles.length)/2:this.VerticalAligment===SobyChartVerticalAligment.Bottom&&(a+=this.Height-15*this.Titles.length);for(i=0;i<this.Titles.length;i++)e.strokeStyle="black",e.fillStyle="black",e.fillText(this.Titles[i],s+13,a+8),e.fillStyle=this.Colours[i],e.strokeStyle=this.Colours[i],e.fillRect(s,a,10,10),this.TitleAligment===SobyChartAligment.Horizontally?s+=15+6*this.Titles[i].length:a-=15},e}(),SobyChartDataset=function(){this.Title="",this.Type=SobyChartTypes.BarChart},SobyChartDotValue=function(e,t,i,s,a,o,n,r,l){this.Label="",this.Value=null,this.DatasetTitle="",this.Colour="black",this.CurrentColour="black",this.Label=e,this.Value=t,this.DatasetTitle=i,this.Colour=s,this.CurrentColour=s,this.X=a,this.Y=o,this.r=n,this.rXr=r,this.Path2D=l},SobyChartTypes,SobyChartElementPosition,SobyChartAligment,SobyChartVerticalAligment,SobyChartHorizontalAligment;function sobyGenerateChartFromHtmlElement(e){for(var t=$("#"+e),i=[],s=t.find(".dataset"),a="",o=0;o<s.length;o++){var n=$(s[o]),r=new SobyChartDataset;r.Title=n.data("title");for(var a=n.data("type"),l=new Array,h=n.data("data").split(";#"),d=0;d<h.length;d++){var c=0;null===h[d]&&void 0===h[d]&&""===h[d]||(c=parseFloat(h[d])),l.push(c)}r.Data=l,i.push(r)}e=t.find(".labels").data("labels").split(";#"),e=new SobyChart("#"+t.attr("id"),a,i,"There is no record found.",e);e.Width=t.data("width"),e.Height=t.data("height"),e.Initialize()}!function(e){e[e.LineChart=0]="LineChart",e[e.BarChart=1]="BarChart",e[e.RadarChart=2]="RadarChart",e[e.PieChart=3]="PieChart",e[e.PolarAreaChart=4]="PolarAreaChart",e[e.ColumnChart=5]="ColumnChart",e[e.DoughnutChart=6]="DoughnutChart"}(SobyChartTypes=SobyChartTypes||{}),function(e){e[e.Left=0]="Left",e[e.Bottom=1]="Bottom",e[e.Right=2]="Right",e[e.Top=3]="Top",e[e.Hidden=4]="Hidden"}(SobyChartElementPosition=SobyChartElementPosition||{}),function(e){e[e.Vertically=0]="Vertically",e[e.Horizontally=1]="Horizontally"}(SobyChartAligment=SobyChartAligment||{}),function(e){e[e.Top=0]="Top",e[e.Middle=1]="Middle",e[e.Bottom=2]="Bottom"}(SobyChartVerticalAligment=SobyChartVerticalAligment||{}),function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right"}(SobyChartHorizontalAligment=SobyChartHorizontalAligment||{});var sobyChartPartFactory=new SobyChartPartFactory,soby_CodeViews=new Array,SobyCodeViewTypes,SobyCodeViews;!function(e){e[e.SingleHtml=0]="SingleHtml",e[e.HtmlParts=1]="HtmlParts",e[e.Xml=2]="Xml"}(SobyCodeViewTypes=SobyCodeViewTypes||{}),function(e){e[e.SinglePage=0]="SinglePage",e[e.Html=1]="Html",e[e.Js=2]="Js",e[e.Css=3]="Css",e[e.Xml=4]="Xml"}(SobyCodeViews=SobyCodeViews||{});var soby_CodeView=function(){function soby_CodeView(e,t,i){this.CodeViewID="",this.ContentDivSelector="",this.Title="",this.CodeViewType=null,this.TemplateHtml="",this.ActiveView=SobyCodeViews.Js,this.AdditionalTabTitles=[],this.AdditionalTabClasses=[],this.OnTemplateRendered=null,this.CodeViewID="soby_codeview_"+soby_guid(),this.ContentDivSelector=e,this.Title=t,this.CodeViewType=i,this.EnsureItemSelectionExistency(),this.CodeViewType===SobyCodeViewTypes.SingleHtml?this.ActiveView=SobyCodeViews.SinglePage:this.CodeViewType===SobyCodeViewTypes.HtmlParts?this.ActiveView=SobyCodeViews.Js:this.CodeViewType===SobyCodeViewTypes.Xml&&(this.ActiveView=SobyCodeViews.Xml)}return soby_CodeView.prototype.Initialize=function(){this.TemplateHtml="<div style='border: 1px solid lightgray;padding: 5px;'><div id='"+this.CodeViewID+"_codeeditor' class='codeeditors'><ul>"+(this.CodeViewType===SobyCodeViewTypes.SingleHtml?"<li><a href='#"+this.CodeViewID+"_singlecodeeditor'>Single</a></li > ":"")+(this.CodeViewType===SobyCodeViewTypes.HtmlParts?"<li><a href='#"+this.CodeViewID+"_jscodeeditor'>JS</a></li>":"")+"<li><a href='#"+this.CodeViewID+"_htmlcodeeditor'>Html</a></li><li><a href='#"+this.CodeViewID+"_csscodeeditor'>CSS</a></li>";for(var i=0;i<this.AdditionalTabTitles.length;i++)this.TemplateHtml+="<li><a href='#"+this.CodeViewID+"_additionaltab"+i+"codeeditor'>"+this.AdditionalTabTitles[i]+"</a></li>";this.TemplateHtml+="</ul>"+(this.CodeViewType===SobyCodeViewTypes.SingleHtml?"<div id='"+this.CodeViewID+"_singlecodeeditor' class='singlecodeeditor'></div>":"")+(this.CodeViewType===SobyCodeViewTypes.HtmlParts?"<div id='"+this.CodeViewID+"_jscodeeditor' class='jscodeeditor'></div>":"")+"<div id='"+this.CodeViewID+"_htmlcodeeditor' class='htmlcodeeditor'></div><div id='"+this.CodeViewID+"_csscodeeditor' class='csscodeeditor'></div>";for(var i=0;i<this.AdditionalTabTitles.length;i++)this.TemplateHtml+="<div id='"+this.CodeViewID+"_additionaltab"+i+"codeeditor' class='additionaltab"+i+"codeeditor'></div>";this.TemplateHtml+="</div><div class='actionbuttons'></div><p class='codedescription'></p><div class='result'> </div><br><p class='resultdescription'></p></div>",$(this.ContentDivSelector).addClass("soby_codeview");for(var singleCodeContent=$(this.ContentDivSelector).find(".singlecode").html(),htmlCodeContent=$(this.ContentDivSelector).find(".htmlcode").html(),jsCodeContent=$(this.ContentDivSelector).find(".jscode").html(),cssCodeContent=$(this.ContentDivSelector).find(".csscode").html(),additionaltabCodeContents=[],i=0;i<this.AdditionalTabTitles.length;i++)additionaltabCodeContents.push($(this.ContentDivSelector).find("."+this.AdditionalTabClasses[i]).html());var codeDescription=$(this.ContentDivSelector).find(".codedescription").html(),resultDescription=$(this.ContentDivSelector).find(".resultdescription").html();$(this.ContentDivSelector).html(this.TemplateHtml),$(this.ContentDivSelector).prepend("<textarea class='copytoclipboardtextarea' style='height: 0px;width: 0px;overflow: hidden;border: 0px;resize: none;' > </textarea><textarea class='defaultsinglecodecontainer' style='height: 0px;width: 0px;overflow: hidden;border: 0px;resize: none;'></textarea><textarea class='defaultjscodecontainer' style='height: 0px;width: 0px;overflow: hidden;border: 0px;resize: none;'></textarea><textarea class='defaulthtmlcodecontainer' style='height: 0px;width: 0px;overflow: hidden;border: 0px;resize: none;'></textarea><textarea class='defaultcsscodecontainer' style='height: 0px;width: 0px;overflow: hidden;border: 0px;resize: none;'></textarea>");for(var i=0;i<this.AdditionalTabTitles.length;i++)$(this.ContentDivSelector).prepend("<textarea class='defaultadditionaltab"+i+"codecontainer' style='height: 0px;width: 0px;overflow: hidden;border: 0px;resize: none;'></textarea>");this.CodeViewType===SobyCodeViewTypes.SingleHtml?($(this.ContentDivSelector).find(".singlecodeeditor").html("<div id='"+this.CodeViewID+"__singlecodeeditor' class='singlecode codeeditor'></div>"),$(this.ContentDivSelector).find(".singlecode").html(singleCodeContent.replace(/<br \/ >/gi,"\n").replace(/<br>/gi,"\n"))):this.CodeViewType===SobyCodeViewTypes.HtmlParts&&($(this.ContentDivSelector).find(".jscodeeditor").html("<div id='"+this.CodeViewID+"__jscodeeditor' class='jscode codeeditor' ></div>"),$(this.ContentDivSelector).find(".htmlcodeeditor").html("<div id='"+this.CodeViewID+"__htmlcodeeditor' class='htmlcode codeeditor'></div>"),$(this.ContentDivSelector).find(".csscodeeditor").html("<div id='"+this.CodeViewID+"__csscodeeditor' class='csscode codeeditor'></div>"),$(this.ContentDivSelector).find(".htmlcode").html(htmlCodeContent.replace(/<br \/ >/gi,"\n").replace(/<br>/gi,"\n")),$(this.ContentDivSelector).find(".jscode").html(jsCodeContent.replace(/<br \/ >/gi,"\n").replace(/<br>/gi,"\n")),$(this.ContentDivSelector).find(".csscode").html(cssCodeContent.replace(/<br \/ >/gi,"\n").replace(/<br>/gi,"\n")));for(var i=0;i<this.AdditionalTabTitles.length;i++){var additionaltabCodeContent=additionaltabCodeContents[i];$(this.ContentDivSelector).find(".additionaltab"+i+"editor").html("<div id='"+this.CodeViewID+"__additionaltab"+i+"codeeditor' class='"+this.AdditionalTabClasses[i]+" codeeditor'></div>"),$(this.ContentDivSelector).find("."+this.AdditionalTabClasses[i]).html(additionaltabCodeContent.replace(/<br \/ >/gi,"\n").replace(/<br>/gi,"\n"))}$(this.ContentDivSelector).find(".defaultsinglecodecontainer").html(singleCodeContent),$(this.ContentDivSelector).find(".defaultjscodecontainer").html(jsCodeContent),$(this.ContentDivSelector).find(".defaultcsscodecontainer").html(cssCodeContent),$(this.ContentDivSelector).find(".defaulthtmlcodecontainer").html(htmlCodeContent),$(this.ContentDivSelector).find(".codedescription").html(codeDescription),$(this.ContentDivSelector).find(".resultdescription").html(resultDescription),$(this.ContentDivSelector).find(".result").html("<iframe class='resultiframe' style='width:100%;height:600px;' > </iframe>"),$(this.ContentDivSelector).find(".actionbuttons").html('<button type = "button" class= "btn btn-primary" onclick="soby_CodeViews[\''+this.CodeViewID+'\'].RunCode();"><svg xmlns ="http://www.w3.org/2000/svg" width = "16" height = "16" fill = "currentColor" class= "bi bi-play-circle" viewBox = "0 0 16 16" ><path d ="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" > </path><path d = "M6.271 5.055a.5.5 0 0 1 .52.038l3.5 2.5a.5.5 0 0 1 0 .814l-3.5 2.5A.5.5 0 0 1 6 10.5v-5a.5.5 0 0 1 .271-.445z" > </path></svg> Run</button> &nbsp;<button type="button" class="btn btn-primary" onclick="soby_CodeViews[\''+this.CodeViewID+'\'].CopyToClipboard();"><svg xmlns = "http://www.w3.org/2000/svg" width = "16" height = "16" fill = "currentColor" class= "bi bi-clipboard-check" viewBox = "0 0 16 16" ><path fill-rule="evenodd" d = "M10.854 7.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708 0z" > </path><path d = "M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z" > </path><path d = "M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z" > </path></svg>   Copy</button>&nbsp;<button type="button" class="btn btn-primary" onclick="soby_CodeViews[\''+this.CodeViewID+'\'].ResetExercise();"><svg xmlns = "http://www.w3.org/2000/svg" width = "16" height = "16" fill = "currentColor" class= "bi bi-bootstrap-reboot" viewBox = "0 0 16 16" ><path d ="M1.161 8a6.84 6.84 0 1 0 6.842-6.84.58.58 0 1 1 0-1.16 8 8 0 1 1-6.556 3.412l-.663-.577a.58.58 0 0 1 .227-.997l2.52-.69a.58.58 0 0 1 .728.633l-.332 2.592a.58.58 0 0 1-.956.364l-.643-.56A6.812 6.812 0 0 0 1.16 8z" > </path><path d = "M6.641 11.671V8.843h1.57l1.498 2.828h1.314L9.377 8.665c.897-.3 1.427-1.106 1.427-2.1 0-1.37-.943-2.246-2.456-2.246H5.5v7.352h1.141zm0-3.75V5.277h1.57c.881 0 1.416.499 1.416 1.32 0 .84-.504 1.324-1.386 1.324h-1.6z" > </path></svg>        Reset</button>&nbsp;'),eval("var editor = ace.edit('"+this.CodeViewID+"__jscodeeditor');"),eval("editor.setTheme('ace/theme/monokai');"),eval("editor.session.setMode('ace/mode/javascript');"),eval("var editor = ace.edit('"+this.CodeViewID+"__csscodeeditor');"),eval("editor.setTheme('ace/theme/monokai');"),eval("editor.session.setMode('ace/mode/css');"),eval("var editor = ace.edit('"+this.CodeViewID+"__htmlcodeeditor');"),eval("editor.setTheme('ace/theme/monokai');"),eval("editor.session.setMode('ace/mode/html');");for(var i=0;i<this.AdditionalTabTitles.length;i++){var additionaltabCodeContent=additionaltabCodeContents[i];$(this.ContentDivSelector).find(".additionaltab"+i+"codeeditor").html("<div id='"+this.CodeViewID+"__additionaltab"+i+"codeeditor' class='"+this.AdditionalTabClasses[i]+" codeeditor'></div>"),$(this.ContentDivSelector).find("."+this.AdditionalTabClasses[i]).html(additionaltabCodeContent.replace(/<br \/ >/gi,"\n").replace(/<br>/gi,"\n")),eval("var editor = ace.edit('"+this.CodeViewID+"__additionaltab"+i+"codeeditor');"),eval("editor.setTheme('ace/theme/monokai');"),eval("editor.session.setMode('ace/mode/html');")}$(".ace_editor").css("height","200px"),null!==this.OnTemplateRendered&&this.OnTemplateRendered();var codeview=this;$(function(){codeview.RunCode()});var tabs=new soby_Tab("#"+this.CodeViewID+"_codeeditor");tabs.Initialize()},soby_CodeView.prototype.RunCode=function(){$(this.ContentDivSelector).find(".result").html("<iframe class='resultiframe' style= 'width:100%;height:600px;' > </iframe>");var html="";if(this.CodeViewType===SobyCodeViewTypes.SingleHtml)html=eval("ace.edit('"+this.CodeViewID+"__singlecodeeditor').getValue()");else if(this.CodeViewType===SobyCodeViewTypes.HtmlParts){html=eval("ace.edit('"+this.CodeViewID+"__htmlcodeeditor').getValue()"),html+="<style type='text/css'>"+eval("ace.edit('"+this.CodeViewID+"__csscodeeditor').getValue()")+"</style>";for(var i=0;i<this.AdditionalTabTitles.length;i++)html+="<script language='javascript'>"+eval("ace.edit('"+this.CodeViewID+"__additionaltab"+i+"codeeditor').getValue()")+"<\/script>";html+="<script language='javascript'>"+eval("ace.edit('"+this.CodeViewID+"__jscodeeditor').getValue()")+"<\/script>"}var iframe=$(this.ContentDivSelector).find(".resultiframe")[0];iframe.contentWindow.document.write(html),iframe.contentWindow.document.close()},soby_CodeView.prototype.ResetExercise=function(){var e;this.CodeViewType===SobyCodeViewTypes.SingleHtml?(e=$(this.ContentDivSelector).find(".defaultsinglecodecontainer").val(),$(this.ContentDivSelector).find(".code").val(e)):this.CodeViewType===SobyCodeViewTypes.HtmlParts&&(e=$(this.ContentDivSelector).find(".defaulthtmlcodecontainer").val(),$(this.ContentDivSelector).find(".htmlcode").val(e),e=$(this.ContentDivSelector).find(".defaultjscodecontainer").val(),$(this.ContentDivSelector).find(".jscode").val(e),e=$(this.ContentDivSelector).find(".defaultcsscodecontainer").val(),$(this.ContentDivSelector).find(".csscode").val(e))},soby_CodeView.prototype.CopyToClipboard=function(){var html=$(this.ContentDivSelector).find(".code").val().toString(),copyToClipboardTextarea=$(this.ContentDivSelector).find(".copytoclipboardtextarea");copyToClipboardTextarea.text(html);var copyText=copyToClipboardTextarea[0];eval("copyText.select();"),document.execCommand("copy")},soby_CodeView.prototype.Populate=function(){},soby_CodeView.prototype.EnsureItemSelectionExistency=function(){for(var e in soby_CodeViews)if(e===this.CodeViewID)return;soby_CodeViews[this.CodeViewID]=this},soby_CodeView}(),__extends=this&&this.__extends||function(){var s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)};return function(e,t){function i(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),soby_Schedulers=new Array,SobySchedulerViewTypesObject=function(){this.Daily=1,this.Weekly=2,this.Monthly=3,this.Yearly=4,this.TaskList=5,this.CustomDates=6,this.AllData=6},SobySchedulerTypes=new SobySchedulerViewTypesObject,SobySchedulerDataItemStatusObject=function(){this.None=1,this.Added=2,this.Modified=3,this.Deleted=4},SobySchedulerDataItemStatuses=new SobySchedulerDataItemStatusObject;function soby_RemoveNoneExistenceScheduler(){var e,t=new Array;for(e in soby_Schedulers)0<$(soby_Schedulers[e].ContentDivSelector+"[schedulerid='"+soby_Schedulers[e].SchedulerID+"']").length&&(t[soby_Schedulers[e].SchedulerID]=soby_Schedulers[e]);soby_WebGrids=t}function soby_GetActiveScheduler(){soby_RemoveNoneExistenceScheduler();var e=$(".soby_scheduler.active").attr("schedulerid");return soby_Schedulers[e]}function soby_GetAllSchedulers(){return soby_RemoveNoneExistenceScheduler(),soby_Schedulers}var soby_Scheduler=function(){function e(e,t,i,s,a,o,n,r,l,h,d,c,u,p,y,g){this.SchedulerID="",this.ContentDivSelector="",this.MonthNames=["Jan","Feb","Mar","Apr","May","Jun","July","Aug","Sep","Oct","Nov","Dec"],this.DayNames=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],this.Title="",this.CategoriesTitle="",this.ScheduleItems=null,this.OriginalScheduleItems=null,this.ChangedScheduleItems=new soby_ScheduleItems,this.ScheduleCategories=null,this.AllowMultipleSelections=!0,this.AllowCheckBoxes=!0,this.ViewType=3,this.EmptyDataHtml="",this.IdFieldName="",this.TitleFieldName="",this.DescriptionFieldName="",this.StartDateFieldName="",this.EndDateFieldName="",this.SchedulerTableStartDate=null,this.SchedulerTableEndDate=null,this.SchedulerTableTotalDays=1,this.LinkFieldName="",this.ImageFieldName="",this.MinuteWidthWeight=1,this.CellHeight=32,this.SingleTimeHeadingDurationAsMinute=60,this.SingleScheduleItemDurationAsMinute=20,this.ShowNavigation=!0,this.IsDateChangeAllowed=!0,this.IsCategoryChangeAllowed=!0,this.IsInDragState=!1,this.OnSelectionChanged=null,this.OnClick=null,this.SchedulerID="soby_scheduler_"+soby_guid(),this.ContentDivSelector=e,this.Title=t,this.CategoriesTitle=i,this.ScheduleItems=new soby_ScheduleItems,this.ScheduleCategories=new soby_ScheduleCategories,this.EmptyDataHtml=n,this.IdFieldName=r,this.TitleFieldName=l,this.DescriptionFieldName=h,this.StartDateFieldName=d,this.EndDateFieldName=c,this.LinkFieldName=u,this.ImageFieldName=p,this.EnsureItemSelectionExistency(),this.Year=s,this.Month=a-1,this.Day=o,this.Width=y,this.Height=g,this.GenerateScheduler()}return e.prototype.Initialize=function(){this.OriginalScheduleItems=this.ScheduleItems.Clone(),$(this.ContentDivSelector).addClass("soby_scheduler"),$(this.ContentDivSelector).attr("onclick","soby_Schedulers['"+this.SchedulerID+"'].Activate()"),$(this.ContentDivSelector).attr("schedulerid",this.SchedulerID),$(this.ContentDivSelector).html("<div class='viewtypepanel'></div><div class='schedulermainpanel'></div>"),0==this.ShowNavigation||this.ViewType==SobySchedulerTypes.CustomDates||(this.GenerateViewTypePanel(),this.SetViewTypeHeaderAsSelected(this.ViewType)),this.ChangeView(this.ViewType)},e.prototype.Activate=function(){$(this.ContentDivSelector+".soby_scheduler").addClass("active")},e.prototype.GenerateCategoriesTable=function(){var e=$("<div></div>"),t=$("<div class='categoriesheader'></div>");t.text(this.CategoriesTitle),e.append(t);for(var i=$("<ul></ul>"),s=0;s<this.ScheduleCategories.length;s++){var a=this.ScheduleCategories[s],o=$("<li></li>"),n=$("<a href='javascript:void(0)' ></a>");n.text(a.Title),o.append(n);for(var r=$("<ul></ul>"),l=0;l<a.SubCategories.length;l++){var h=a.SubCategories[l],d=$("<li></li>"),c=$("<a href='javascript:void(0)' ></a>");c.text(h.Title),d.append(c),r.append(d)}o.append(r),i.append(o)}e.append(i),$(this.ContentDivSelector+" .schedulercategoriespanel").html(""),$(this.ContentDivSelector+" .schedulercategoriespanel").append(e)},e.prototype.AddItem=function(e,t,i,s,a,o){o=new soby_ScheduleItem(e,t,i,s,a,o);return this.ScheduleItems.push(o),o},e.prototype.AddCategory=function(e,t){t=new soby_ScheduleCategory(e,t);return this.ScheduleCategories.push(t),t},e.prototype.GetItemData=function(e){for(var t=0;t<this.ScheduleItems.length;t++)if(this.ScheduleItems[t].SobyCalendarViewItemId==e)return this.ScheduleItems[t];return null},e.prototype.GetItems=function(e,t){for(var i=new soby_ScheduleItems,s=0;s<this.ScheduleItems.length;s++){var a=this.ScheduleItems[s];null==a.EndDate?a.StartDate>=e&&a.StartDate<=t&&i.push(a):(a.StartDate>=e&&a.StartDate<=t||a.EndDate>=e&&a.EndDate<=t)&&i.push(a)}return i},e.prototype.GetDateTasks=function(e,t){var i=e.getDay();0==i&&(i=7);var s=new Date;s.getDate()==e.getDate()&&s.getMonth()==e.getMonth()&&(s.getFullYear(),e.getFullYear());for(var a=$("<ul class='tasklist'></ul>"),o=this.GetItems(e,t),n=0;n<o.length;n++){var r=o[n],l=$("<li></li>");l.append("<a href='javascript:void(0)' title='"+r.Title+"'>"+r.Title+"</a>"),a.append(l)}return a},e.prototype.GenerateViewTypePanel=function(){var e="<table class='viewtypetabs'><td class='viewtypeheader daily'><a href='javascript:void(0)' onclick=\"soby_Schedulers['"+this.SchedulerID+"'].ChangeView(SobySchedulerTypes.Daily)\">&nbsp;&nbsp;&nbsp;Daily&nbsp;&nbsp;&nbsp;</a></td><td class='viewtypeheader weekly'><a href='javascript:void(0)' onclick=\"soby_Schedulers['"+this.SchedulerID+"'].ChangeView(SobySchedulerTypes.Weekly)\">&nbsp;&nbsp;&nbsp;Weekly&nbsp;&nbsp;&nbsp;</a></td><td class='viewtypeheader monthly' style='display:none'><a href='javascript:void(0)' onclick=\"soby_Schedulers['"+this.SchedulerID+"'].ChangeView(SobySchedulerTypes.Monthly)\">&nbsp;&nbsp;&nbsp;Monthly&nbsp;&nbsp;&nbsp;</a></td><td class='viewtypeheader yearly' style='display:none'><a href='javascript:void(0)' onclick=\"soby_Schedulers['"+this.SchedulerID+"'].ChangeView(SobySchedulerTypes.Yearly)\">&nbsp;&nbsp;&nbsp;Yearly&nbsp;&nbsp;&nbsp;</a></td><td class='viewtypeheader tasklist' style='display:none'><a href='javascript:void(0)' onclick=\"soby_Schedulers['"+this.SchedulerID+"'].ChangeView(SobySchedulerTypes.TaskList)\">&nbsp;&nbsp;&nbsp;Show All Events&nbsp;&nbsp;&nbsp;</a></td></table>";$(this.ContentDivSelector+" .viewtypepanel").html(e)},e.prototype.ShowPopupViewSelection=function(){var e="<table bgcolor=#D4D0C8 bordercolor=black border=1 cellspacing=0 cellpadding=0><tr><td bgcolor=#D4D0C8 style='font-size:13;font-face:tahoma;cursor:default' onmouseover=\"this.style.backgroundColor='MidnightBlue'\" onmouseout=\"this.style.backgroundColor='#D4D0C8';this.style.color='black'\"><a onmouseover=\"this.style.color='white'\" onmouseout=\"this.style.color='black'\" href='javascript:void(0)' onclick=\"objToolx.fnSetVisibility('idPopup',false);soby_Schedulers['"+this.SchedulerID+"'].Month="+this.Month+";soby_Schedulers['"+this.SchedulerID+"'].Day="+this.Day+";soby_Schedulers['"+this.SchedulerID+"'].ViewType=1;soby_Schedulers['"+this.SchedulerID+"'].GenerateScheduler()\">&nbsp;&nbsp;&nbsp;Show This Day&nbsp;&nbsp;&nbsp;</a></td></tr><tr><td bgcolor=#D4D0C8 style='font-size:13;font-face:tahoma;cursor:default' onmouseover=\"this.style.backgroundColor='MidnightBlue'\" onmouseout=\"this.style.backgroundColor='#D4D0C8';this.style.color='black'\"><a onmouseover=\"this.style.color='white'\" onmouseout=\"this.style.color='black'\" href='javascript:void(0)' onclick=\"objToolx.fnSetVisibility('idPopup',false);soby_Schedulers['"+this.SchedulerID+"'].Month="+this.Month+";soby_Schedulers['"+this.SchedulerID+"'].Day="+this.Day+";soby_Schedulers['"+this.SchedulerID+"'].ViewType=2;soby_Schedulers['"+this.SchedulerID+"'].GenerateScheduler()\">&nbsp;&nbsp;&nbsp;Show This Week&nbsp;&nbsp;&nbsp;</a></td></tr><tr><td bgcolor=#D4D0C8 style='font-size:13;font-face:tahoma' onmouseover=\"this.style.backgroundColor='MidnightBlue'\" onmouseout=\"this.style.backgroundColor='#D4D0C8';this.style.color='black'\"><a onmouseover=\"this.style.color='white'\" onmouseout=\"this.style.color='black'\" href='javascript:void(0)' onclick=\"javascript:objToolx.fnSetVisibility('idPopup',false);soby_Schedulers['"+this.SchedulerID+"'].Month="+this.Month+";soby_Schedulers['"+this.SchedulerID+"'].ViewType=3;soby_Schedulers['"+this.SchedulerID+"'].GenerateScheduler()\">&nbsp;&nbsp;&nbsp;Show This Month&nbsp;&nbsp;&nbsp;</a></td></tr><tr><td bgcolor=#D4D0C8 style='font-size:13;font-face:tahoma' onmouseover=\"this.style.backgroundColor='MidnightBlue'\" onmouseout=\"this.style.backgroundColor='#D4D0C8';this.style.color='black'\"><a onmouseover=\"this.style.color='white'\" onmouseout=\"this.style.color='black'\" href='javascript:void(0)' onclick=\"javascript:objToolx.fnSetVisibility('idPopup',false);soby_Schedulers['"+this.SchedulerID+"'].ViewType=4;soby_Schedulers['"+this.SchedulerID+"'].GenerateScheduler()\">&nbsp;&nbsp;&nbsp;Show This Year&nbsp;&nbsp;&nbsp;</a></td></tr><tr><td bgcolor=#D4D0C8 style='font-size:13;font-face:tahoma' onmouseover=\"this.style.backgroundColor='MidnightBlue'\" onmouseout=\"this.style.backgroundColor='#D4D0C8';this.style.color='black'\"><a onmouseover=\"this.style.color='white'\" onmouseout=\"this.style.color='black'\" href='javascript:void(0)' onclick=\"javascript:objToolx.fnSetVisibility('idPopup',false);soby_Schedulers['"+this.SchedulerID+"'].ViewType=5;soby_Schedulers['"+this.SchedulerID+"'].GenerateScheduler()\">&nbsp;&nbsp;&nbsp;Show All Event In This Year&nbsp;&nbsp;&nbsp;</a></td></tr></table>";$(this.ContentDivSelector+" .viewtypepanel").html(e)},e.prototype.SetViewTypeHeaderAsSelected=function(e){switch($(".viewtypeheader").removeClass("selected"),e){case SobySchedulerTypes.Daily:$(".viewtypeheader.daily").addClass("selected");break;case SobySchedulerTypes.Weekly:$(".viewtypeheader.weekly").addClass("selected");break;case SobySchedulerTypes.Monthly:$(".viewtypeheader.monthly").addClass("selected");break;case SobySchedulerTypes.Yearly:$(".viewtypeheader.yearly").addClass("selected");break;case SobySchedulerTypes.TaskList:$(".viewtypeheader.tasklist").addClass("selected")}},e.prototype.ChangeView=function(e){this.ViewType=e,this.SetViewTypeHeaderAsSelected(e),this.GenerateCategoriesTable(),this.GenerateScheduler()},e.prototype.GenerateScheduler=function(){switch(this.ViewType){case SobySchedulerTypes.Yearly:case SobySchedulerTypes.Monthly:break;case SobySchedulerTypes.Daily:case SobySchedulerTypes.Weekly:this.ShowFifteenMinutesView();break;case SobySchedulerTypes.TaskList:this.ShowTasklistView();break;case SobySchedulerTypes.CustomDates:this.ShowFifteenMinutesView()}},e.prototype.ShowTasklistView=function(){},e.prototype.GetDayOfTheWeek=function(e,t){var i=e.getDay(),t=e.getDate()-i+(i==t?-6:1);return new Date(e.setDate(t))},e.prototype.GetDayHeaderClass=function(e){var t=e.getDay();0==t&&(t=7);var i="weekday",s=new Date;return s.getDate()==e.getDate()&&s.getMonth()==e.getMonth()&&s.getFullYear()==e.getFullYear()?i="today":6==t?i="saturday":7==t&&(i="sunday"),i},e.prototype.ShowFifteenMinutesView=function(){var e=new Date(this.Year,this.Month,this.Day);this.ViewType==SobySchedulerTypes.Daily?(this.SchedulerTableStartDate=new Date(this.Year,this.Month,this.Day,0,0,0,0),this.SchedulerTableEndDate=new Date(this.Year,this.Month,this.Day+1,0,0,0,0)):this.ViewType==SobySchedulerTypes.Weekly?(i=new Date(this.Year,this.Month,this.Day,0,0,0,0),this.SchedulerTableStartDate=this.GetDayOfTheWeek(i,0),this.SchedulerTableEndDate=new Date(this.SchedulerTableStartDate.getFullYear(),this.SchedulerTableStartDate.getMonth(),this.SchedulerTableStartDate.getDate()+6,0,0,0,0),this.SchedulerTableTotalDays=7):this.ViewType==SobySchedulerTypes.Monthly?(this.SchedulerTableStartDate=new Date(this.Year,this.Month,this.Day,0,0,0,0),this.SchedulerTableEndDate=new Date(this.Year,this.Month,this.Day+1,0,0,0,0)):this.ViewType==SobySchedulerTypes.CustomDates&&(s=Math.abs(this.SchedulerTableEndDate.getTime()-this.SchedulerTableStartDate.getTime()),this.SchedulerTableTotalDays=Math.ceil(s/864e5));var t=1440/this.SingleScheduleItemDurationAsMinute,i=(this.SchedulerTableTotalDays,$("<table width= "+this.Width+" class='soby_maintable' ></table>")),s=$("<tbody class='scheduler-body'></tbody>");1==this.ShowNavigation&&this.ViewType!=SobySchedulerTypes.CustomDates&&s.append("<tr class='navigationpanelrow'><td></td><td class='navigationpanel' colspan='"+t+"'><a href='javascript:void(0)' onclick=\"javascript:soby_Schedulers['"+this.SchedulerID+"'].JumpDay(-1)\">&lt;</a><span class='navigationheader'>"+soby_GetFormatedDateString(e)+"</class><a href='javascript:void(0)' onclick=\"javascript:soby_Schedulers['"+this.SchedulerID+"'].JumpDay(1)\">&gt;</a></td></tr>");t=$("<tr></tr>"),e=$("<td class='scheduler-category-area'></td>");t.append(e);e=$("<td class='scheduler-time-area'></td>");t.append(e),s.append(t),i.append(s);e=$("<table></table>"),s=$("<tbody></tbody>"),t=$("<colgroup></colgroup>");e.append(t),e.append(s),$(this.ContentDivSelector+" .schedulermainpanel").html(""),$(this.ContentDivSelector+" .schedulermainpanel").append(i),this.PopulateCategoryRows(),this.PopulateScheduleItemElements()},e.prototype.GetSchedulerItemTableWidth=function(){return 60*this.MinuteWidthWeight*24*this.SchedulerTableTotalDays},e.prototype.PopulateCategoryRows=function(){var e=$(this.ContentDivSelector+" .scheduler-body .scheduler-category-area"),t=$(this.ContentDivSelector+" .scheduler-body .scheduler-time-area"),i=$("<div class='scheduler-scroller-clip'></div>"),s=$("<div class='scheduler-scroller' style= 'margin: 0px;'></div>"),a=$("<div class='scheduler-scroller-canvas'></div>"),o=$("<div class='scheduler-content' ></div>"),n=$("<div class='scheduler-rows' ></div>"),r=$("<div class='scheduler-scroller-clip'></div>"),l=$("<div class='scheduler-scroller' style= 'overflow: auto; margin: 0px;width:"+(this.Width-100)+"px'></div>"),h=$("<div class='scheduler-scroller-canvas' style='min-width: 0px;'></div>");h.css("width",this.GetSchedulerItemTableWidth()+"px");var d=$("<div class='scheduler-content' ></div>"),c=$("<div class='scheduler-rows' ></div>"),u=$("<table style='width: 100%;margin-top: 11px;border: solid 1px;'></table>"),p=$("<tr></tr>");(_=$("<th class='categoriesheader' colspan='2' style='height:"+2*this.CellHeight+"px;' nowrap></td>")).text(this.CategoriesTitle),p.append(_),u.append(p);for(var y=$("<div class='scheduler-rows-drageffect' >&nbsp;</div>"),g=$("<table></table>"),m=$("<tr class='dayheaderrow'></tr>"),b=$("<tr class='timeheaderrow'></tr>"),S=null,f=null,C=1440/this.SingleTimeHeadingDurationAsMinute,v=0;v<this.SchedulerTableTotalDays*C;v++){var S=new Date(this.SchedulerTableStartDate.getFullYear(),this.SchedulerTableStartDate.getMonth(),this.SchedulerTableStartDate.getDate(),0,v*this.SingleTimeHeadingDurationAsMinute,0,0),f=new Date(this.SchedulerTableStartDate.getFullYear(),this.SchedulerTableStartDate.getMonth(),this.SchedulerTableStartDate.getDate(),0,(v+1)*this.SingleTimeHeadingDurationAsMinute,0,0),w=S.getHours(),D=S.getMinutes(),x=f.getHours(),I=f.getMinutes();0==D&&((F=$("<th colspan='"+C+"' class='dayheader'></th>")).text(soby_GetFormatedDateString(S)),m.append(F));var T=$("<th colspan='1' class='timeheader'></th>");T.attr("width",this.SingleTimeHeadingDurationAsMinute*this.MinuteWidthWeight+"px"),T.attr("height",this.CellHeight+"px");var F="",F=60==this.SingleTimeHeadingDurationAsMinute?9<w?w.toString():"0"+w:(9<w?w.toString():"0"+w)+":"+(9<D?D.toString():"0"+D)+" - "+(9<x?x.toString():"0"+x)+":"+(9<I?I.toString():"0"+I);T.text(F),b.append(T)}g.append(m),g.append(b);for(var P=1440/this.SingleScheduleItemDurationAsMinute,V=this.SchedulerTableTotalDays*P,A=0,v=0;v<this.ScheduleCategories.length;v++){A++;var _,N=this.ScheduleCategories[v],p=$("<tr></tr>");(_=$("<td class='categorieslabelcell' style='height:"+this.CellHeight+"px;' nowrap></td>")).text(N.Title),p.append(_),u.append(p);var G=$("<tr class='categorytimerow'><td class='categorytimecell' colspan='"+V+"'></td></tr>");G.attr("categoryid",N.Id),G.attr("categoryindex",A-1),g.append(G);for(var M=0;M<N.SubCategories.length;M++){A++;var L=N.SubCategories[M],B=$("<tr></tr>"),R=$("<td class='categorieslabelcell' style='padding-left:30px;height:"+this.CellHeight+"px;' nowrap>&nbsp;</td>");R.text(L.Title),B.append(R),u.append(B);B=$("<tr class='categorytimerow'><td class='categorytimecell' colspan='"+V+"'></td></tr>");B.attr("categoryid",L.Id),B.attr("categoryindex",A-1),g.append(B)}}var E=(A+2)*this.CellHeight,P=(A+1)*this.CellHeight;s.css("height",E+"px"),l.css("height",E+"px"),g.css("height",P+"px"),i.append(s),s.append(a),a.append(o),o.append(n),n.append(u),e.append(i),r.append(l),l.append(h),h.append(d),d.append(c),c.append(g),c.append(y),t.append(r)},e.prototype.PopulateScheduleItemElements=function(){for(var e=0;e<this.ScheduleItems.length;e++){var t=this.ScheduleItems[e];(t.StartDate>=this.SchedulerTableStartDate&&t.StartDate<=this.SchedulerTableEndDate||this.SchedulerTableStartDate>=t.StartDate&&this.SchedulerTableStartDate<=t.EndDate)&&this.DrawScheduleItemElement(e,t)}},e.prototype.DrawScheduleItemElement=function(e,t){var i=60*t.StartDate.getHours()+t.StartDate.getMinutes(),s=60*t.EndDate.getHours()+t.EndDate.getMinutes(),a=this.GetCategoryTimeRow(t.CategoryId),o=parseInt($(".categorytimerow[categoryid="+t.CategoryId+"]").attr("categoryindex")),n=this.CellHeight*(o+2)+1,o=i*this.MinuteWidthWeight+"px",s=(s-i)*this.MinuteWidthWeight+"px",i="soby_ScheduleItem_"+t.Id,e=$("<a id='"+i+"' class='schedulitemlink style"+e%10+"'></a>");e.text(t.Title),e.attr("title",t.Description),e.attr("scheduleitemid",t.Id),e.css("top",n),e.css("left",o),e.css("width",s),a.find("td").append(e);var d=this;$("#"+i).draggable({cursor:"move",cursorAt:{top:10,left:10},start:function(){$(".scheduler-rows-drageffect").show(),d.IsInDragState=!0},drag:function(e,t){var i=$(this),s=(i.attr("scheduleitemid"),parseInt(i.css("top").replace(/px/gi,""))),a=parseInt(i.css("left").replace(/px/gi,"")),i=Math.round(s/d.CellHeight)-2,s=($(".categorytimerow[categoryindex='"+i+"']").attr("categoryid"),a/d.MinuteWidthWeight);s-=s%d.SingleScheduleItemDurationAsMinute;a=d.CellHeight*(2+i)+1,i=s*d.MinuteWidthWeight+"px",s=d.SingleScheduleItemDurationAsMinute*d.MinuteWidthWeight+"px";$(".scheduler-rows-drageffect").css("top",a),$(".scheduler-rows-drageffect").css("left",i),$(".scheduler-rows-drageffect").css("width",s)},stop:function(){$(".scheduler-rows-drageffect").hide(),d.IsInDragState=!1;var e=$(this),t=e.attr("scheduleitemid"),i=parseInt(e.css("top").replace(/px/gi,"")),s=parseInt(e.css("left").replace(/px/gi,"")),a=Math.round(i/d.CellHeight)-2,o=$(".categorytimerow[categoryindex='"+a+"']").attr("categoryid"),e=s/d.MinuteWidthWeight;e-=e%d.SingleScheduleItemDurationAsMinute;i=d.ScheduleItems.GetItemById(t),a=(i.EndDate.getTime()-i.StartDate.getTime())/1e3;a/=60;var s=e+(a=Math.abs(Math.round(a))),a=new Date(i.StartDate.getFullYear(),i.StartDate.getMonth(),i.StartDate.getDate(),0,0,0,0),n=new Date(a.getTime()+6e4*e),r=new Date(a.getTime()+6e4*s);if(0==d.ScheduleCategories.GetCategoryById(o).CanContainScheduleItems)return alert("This category can not contain a schedule item"),void d.ChangeView(d.ViewType);if(0==d.IsCategoryChangeAllowed&&i.CategoryId!=o)return alert("Category change is not allowed."),void d.ChangeView(d.ViewType);if(0==d.IsDateChangeAllowed&&(i.StartDate.toISOString()!=n.toISOString()||i.EndDate.toISOString()!=r.toISOString()))return alert("Date change is not allowed."),void d.ChangeView(d.ViewType);for(var l=d.ScheduleItems.GetItemsByCategoryId(o),h=0;h<l.length;h++)if(l[h].Id!=t&&(l[h].StartDate>=n&&l[h].StartDate<=r||n>=l[h].StartDate&&n<=l[h].EndDate))return alert("Conflict exist, please select a different date"),void d.ChangeView(d.ViewType);i.StartDate=new Date(a.getTime()+6e4*e),i.EndDate=new Date(a.getTime()+6e4*s),i.CategoryId=o,d.ChangeScheduleDataItemStatus(i,SobySchedulerDataItemStatuses.Modified),d.ChangeView(d.ViewType)}})},e.prototype.ChangeScheduleDataItemStatus=function(e,t){var i;null==e.Id||""==e.Id?(e.Clone(),e.DataItemStatus=t,this.ChangedScheduleItems.push(e)):null==(i=this.ChangedScheduleItems.GetItemById(e.Id))?this.ChangedScheduleItems.push(e):i.DataItemStatus=t},e.prototype.GetCategoryTimeRow=function(e){return $(this.ContentDivSelector+" .categorytimerow[categoryid='"+e+"']")},e.prototype.JumpYear=function(e){e=new Date(this.Year+e,this.Month,this.Day);this.Year=e.getFullYear(),this.Month=e.getMonth(),this.GenerateScheduler()},e.prototype.JumpMonth=function(e){e=new Date(this.Year,this.Month+e,this.Day);this.Year=e.getFullYear(),this.Month=e.getMonth(),this.GenerateScheduler()},e.prototype.JumpWeek=function(e){e=new Date(this.Year,this.Month,this.Day+7*e);this.Year=e.getFullYear(),this.Month=e.getMonth(),this.Day=e.getDate(),this.GenerateScheduler()},e.prototype.JumpDay=function(e){e=new Date(this.Year,this.Month,this.Day+e);this.Year=e.getFullYear(),this.Month=e.getMonth(),this.Day=e.getDate(),this.GenerateScheduler()},e.prototype.NavigateToDate=function(e,t,i,s){this.Year=e,this.Month=t,this.Day=i,this.ViewType=s,this.GenerateScheduler()},e.prototype.GetSelectedItems=function(){var e=new Array,t=$("input[name='checkbox_"+this.SchedulerID+"']:checked");0==this.AllowCheckBoxes&&(t=$("input[name='checkbox_"+this.SchedulerID+"']:checked"));for(var i=0;i<t.length;i++)e[e.length]=this.GetItemData($(t[i]).val());return e},e.prototype.ClickNode=function(e){null!=this.OnClick&&this.OnClick(this.SchedulerID,e)},e.prototype.CheckNode=function(e){null!=this.OnSelectionChanged&&this.OnSelectionChanged(this.SchedulerID)},e.prototype.EnsureItemSelectionExistency=function(){for(var e in soby_Schedulers)if(e==this.SchedulerID)return;soby_Schedulers[this.SchedulerID]=this},e}(),soby_ScheduleCategories=function(i){function s(e){var t=i.call(this)||this;return e&&t.push.apply(t,e),Object.setPrototypeOf(t,Object.create(s.prototype)),t}return __extends(s,i),s.prototype.GetCategoryById=function(e){for(var t=0;t<this.length;t++){if(this[t].Id==e)return this[t];var i=this[t].SubCategories.GetCategoryById(e);if(null!=i)return i}return null},s}(Array),soby_ScheduleItems=function(i){function s(e){var t=i.call(this)||this;return e&&t.push.apply(t,e),Object.setPrototypeOf(t,Object.create(s.prototype)),t}return __extends(s,i),s.prototype.Clone=function(){for(var e=new s,t=0;t<this.length;t++)e.push(this[t].Clone());return e},s.prototype.GetItemById=function(e){for(var t=0;t<this.length;t++)if(this[t].Id==e)return this[t];return null},s.prototype.GetItemsByCategoryId=function(e){for(var t=new s,i=0;i<this.length;i++)this[i].CategoryId==e&&t.push(this[i]);return t},s}(Array),soby_ScheduleItem=function(){function e(e,t,i,s,a,o){this.Id="",this.Title="",this.Description="",this.CategoryId="",this.StartDate=null,this.EndDate=null,this.DataItemStatus=SobySchedulerDataItemStatuses.None,this.Id=e,this.Title=t,this.Description=i,this.CategoryId=s,this.StartDate=a,this.EndDate=o}return e.prototype.Clone=function(){return new e(this.Id,this.Title,this.Description,this.CategoryId,this.StartDate,this.EndDate)},e}(),soby_ScheduleCategory=function(){function i(e,t){this.Id="",this.Title="",this.CanContainScheduleItems=!0,this.SubCategories=null,this.Id=e,this.Title=t,this.SubCategories=new soby_ScheduleCategories}return i.prototype.AddCategory=function(e,t){t=new i(e,t);this.SubCategories.push(t)},i}(),__extends=this&&this.__extends||function(){var s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)};return function(e,t){function i(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),soby_Validate=function(){function e(){this.ErrorMessages={Url:{InvalidUrlFormat:"You can't enter an invalid url"},Email:{InvalidEmailFormat:"You can't enter an invalid email"},Pattern:{NotMatchingPattern:"You can't enter a value that is not matching the required pattern"},Numeric:{NotNumeric:"You can't enter non numeric value",GreaterThanMax:"You can't enter a value grater than maximum value",LessThanMin:"You can't enter a value less than minimum value"},Text:{GreaterThanMaxLength:"You can't enter a value grater than maximum length",LessThanMinLength:"You can't enter a value less than minimum length"},Date:{GreaterThanMaxValue:"You can't enter a value grater than maximum value",LessThanMinValue:"You can't enter a value less than minimum value",InvalidDate:"You can't enter an invalid date"},Presence:{Required:"You can't leave this blank."},Exclusion:{Required:"You can't leave this blank."},Inclusion:{Required:"You can't leave this blank."}},this.Validators=new Array,this.Validators.push(new soby_UrlValidator),this.Validators.push(new soby_EmailValidator),this.Validators.push(new soby_NumericValidator),this.Validators.push(new soby_TextValidator),this.Validators.push(new soby_PresenceValidator),this.Validators.push(new soby_DateValidator),this.Validators.push(new soby_ExclusionValidator)}return e.prototype.GetValidator=function(e){for(var t=0;t<this.Validators.length;t++)if(this.Validators[t].Type==e){var i=this.Validators[t].Clone();return i.SetDefaultErrorMessages(),i}return null},e.prototype.CheckIfEmpty=function(e){return null==e||""==e.trim()||e==[]||e=={}},e.prototype.ValidateForm=function(e){return new soby_FormValidator(e).Validate()},e}(),soby_PresenceValidator=function(){function t(){this.Required=!1,this.ErrorMessage="",this.ErrorMessages={Required:""},this.Name="PresenceValidator",this.Type=soby_ValidatorTypes.Presence}return t.prototype.SetDefaultErrorMessages=function(){this.ErrorMessages.Required=sobyValidate.ErrorMessages.Presence.Required},t.prototype.Validate=function(e){return this.ErrorMessage="",1!=this.Required||1!=sobyValidate.CheckIfEmpty(e)||(this.ErrorMessage=this.ErrorMessages.Required,!1)},t.prototype.Clone=function(){var e=new t;return e.Name=this.Name,e.Required=this.Required,e.Type=this.Type,e.ErrorMessage=this.ErrorMessage,e},t}(),soby_ExclusionValidator=function(){function t(){this.Required=!1,this.ErrorMessage="",this.ErrorMessages={Required:""},this.Name="ExclusionValidator",this.Type=soby_ValidatorTypes.Exclusion,this.ExcludedValues=new Array}return t.prototype.SetDefaultErrorMessages=function(){this.ErrorMessages.Required=sobyValidate.ErrorMessages.Exclusion.Required},t.prototype.Validate=function(e){if(this.ErrorMessage="",1==sobyValidate.CheckIfEmpty(e))return this.ErrorMessage=this.ErrorMessages.Required,!1;for(var t=0;t<this.ExcludedValues.length;t++)if(this.ExcludedValues[t]==e)return!1;return!0},t.prototype.Clone=function(){var e=new t;return e.Name=this.Name,e.Required=this.Required,e.Type=this.Type,e.ErrorMessage=this.ErrorMessage,e},t}(),soby_InclusionValidator=function(){function t(){this.Required=!1,this.ErrorMessage="",this.ErrorMessages={Required:""},this.Name="InclusionValidator",this.Type=soby_ValidatorTypes.Inclusion,this.IncludedValues=new Array}return t.prototype.SetDefaultErrorMessages=function(){this.ErrorMessages.Required=sobyValidate.ErrorMessages.Exclusion.Required},t.prototype.Validate=function(e){if(this.ErrorMessage="",1==sobyValidate.CheckIfEmpty(e))return this.ErrorMessage=this.ErrorMessages.Required,!1;for(var t=0;t<this.IncludedValues.length;t++)if(this.IncludedValues[t]==e)return!0;return!1},t.prototype.Clone=function(){var e=new t;return e.Name=this.Name,e.Required=this.Required,e.Type=this.Type,e.ErrorMessage=this.ErrorMessage,e},t}(),soby_NumericValidator=function(t){function i(){var e=t.call(this)||this;return e.MinValue=null,e.MaxValue=null,e.ErrorMessage="",e.ErrorMessages={NotNumeric:"",Required:"",GreaterThanMax:"",LessThanMin:""},e.Name="NumericValidator",e.Type=soby_ValidatorTypes.Numeric,e}return __extends(i,t),i.prototype.SetDefaultErrorMessages=function(){t.prototype.SetDefaultErrorMessages.call(this),this.ErrorMessages.NotNumeric=sobyValidate.ErrorMessages.Numeric.NotNumeric,this.ErrorMessages.GreaterThanMax=sobyValidate.ErrorMessages.Numeric.GreaterThanMax,this.ErrorMessages.LessThanMin=sobyValidate.ErrorMessages.Numeric.LessThanMin},i.prototype.Validate=function(e){return 0!=t.prototype.Validate.call(this,e)&&(1==isNaN(e)?this.ErrorMessage=this.ErrorMessages.NotNumeric:(null!=this.MinValue&&parseInt(e)<this.MinValue&&(this.ErrorMessage=this.ErrorMessages.LessThanMin),null!=this.MaxValue&&parseInt(e)>this.MaxValue&&(this.ErrorMessage=this.ErrorMessages.GreaterThanMax)),""==this.ErrorMessage)},i.prototype.Clone=function(){var e=new i;return e.Name=this.Name,e.Required=this.Required,e.Type=this.Type,e.ErrorMessage=this.ErrorMessage,e.MinValue=this.MinValue,e.MaxValue=this.MaxValue,e},i}(soby_PresenceValidator),soby_DateValidator=function(t){function i(){var e=t.call(this)||this;return e.DateOnly=!1,e.Min=null,e.Max=null,e.Format="YYYY-MM-DD",e.ErrorMessage="",e.ErrorMessages={Required:"",GreaterThanMaxValue:"",LessThanMinValue:"",InvalidDate:""},e.Name="DateValidator",e.Type=soby_ValidatorTypes.Date,e}return __extends(i,t),i.prototype.SetDefaultErrorMessages=function(){t.prototype.SetDefaultErrorMessages.call(this),this.ErrorMessages.GreaterThanMaxValue=sobyValidate.ErrorMessages.Date.GreaterThanMaxValue,this.ErrorMessages.LessThanMinValue=sobyValidate.ErrorMessages.Date.LessThanMinValue,this.ErrorMessages.InvalidDate=sobyValidate.ErrorMessages.Date.InvalidDate},i.prototype.Validate=function(e){0==t.prototype.Validate.call(this,e)&&(this.ErrorMessage=this.ErrorMessages.InvalidDate);e=soby_GetDateWithFormat(e,this.Format);return null==e?this.ErrorMessage=this.ErrorMessages.InvalidDate:(null!=this.Min&&e<this.Min&&(this.ErrorMessage=this.ErrorMessages.LessThanMinValue),null!=this.Max&&e>this.Max&&(this.ErrorMessage=this.ErrorMessages.GreaterThanMaxValue)),""==this.ErrorMessage},i.prototype.Clone=function(){var e=new i;return e.Name=this.Name,e.Required=this.Required,e.Type=this.Type,e.ErrorMessage=this.ErrorMessage,e.Min=this.Min,e.Max=this.Max,e},i}(soby_PresenceValidator),soby_TextValidator=function(t){function i(){var e=t.call(this)||this;return e.MinLength=null,e.MaxLength=null,e.ErrorMessage="",e.ErrorMessages={Required:"",GreaterThanMaxLength:"",LessThanMinLength:""},e.Name="TextValidator",e.Type=soby_ValidatorTypes.Text,e}return __extends(i,t),i.prototype.SetDefaultErrorMessages=function(){t.prototype.SetDefaultErrorMessages.call(this),this.ErrorMessages.GreaterThanMaxLength=sobyValidate.ErrorMessages.Text.GreaterThanMaxLength,this.ErrorMessages.LessThanMinLength=sobyValidate.ErrorMessages.Text.LessThanMinLength},i.prototype.Validate=function(e){return 0!=t.prototype.Validate.call(this,e)&&(null!=this.MinLength&&e.length<this.MinLength&&(this.ErrorMessage=this.ErrorMessages.LessThanMinLength),null!=this.MaxLength&&e.length>this.MaxLength&&(this.ErrorMessage=this.ErrorMessages.GreaterThanMaxLength),""==this.ErrorMessage)},i.prototype.Clone=function(){var e=new i;return e.Name=this.Name,e.Required=this.Required,e.Type=this.Type,e.ErrorMessage=this.ErrorMessage,e.MinLength=this.MinLength,e.MaxLength=this.MaxLength,e},i}(soby_PresenceValidator),soby_PatternValidator=function(t){function i(){var e=t.call(this)||this;return e.MinLength=null,e.MaxLength=null,e.Pattern=null,e.ErrorMessage="",e.ErrorMessages={Required:"",GreaterThanMaxLength:"",LessThanMinLength:"",NotMatchingPattern:""},e.Name="PatternValidator",e.Type=soby_ValidatorTypes.Pattern,e}return __extends(i,t),i.prototype.SetDefaultErrorMessages=function(){t.prototype.SetDefaultErrorMessages.call(this),this.ErrorMessages.GreaterThanMaxLength=sobyValidate.ErrorMessages.Text.GreaterThanMaxLength,this.ErrorMessages.LessThanMinLength=sobyValidate.ErrorMessages.Text.LessThanMinLength,this.ErrorMessages.NotMatchingPattern=sobyValidate.ErrorMessages.Pattern.NotMatchingPattern},i.prototype.Validate=function(e){return!1!==t.prototype.Validate.call(this,e)&&(!0!==this.Required&&""===e||(null!==this.MinLength&&e.length<this.MinLength&&(this.ErrorMessage=this.ErrorMessages.LessThanMinLength),null!==this.MaxLength&&e.length>this.MaxLength&&(this.ErrorMessage=this.ErrorMessages.GreaterThanMaxLength),!1===this.Pattern.test(e.toString())&&(this.ErrorMessage=this.ErrorMessages.NotMatchingPattern)),""===this.ErrorMessage)},i.prototype.Clone=function(){var e=new i;return e.Name=this.Name,e.Required=this.Required,e.Type=this.Type,e.ErrorMessage=this.ErrorMessage,e.Pattern=this.Pattern,e.MinLength=this.MinLength,e.MaxLength=this.MaxLength,e},i}(soby_PresenceValidator),soby_EmailValidator=function(t){function i(){var e=t.call(this)||this;return e.Name="EmailValidator ",e.Type=soby_ValidatorTypes.Email,e.Pattern=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,e}return __extends(i,t),i.prototype.SetDefaultErrorMessages=function(){t.prototype.SetDefaultErrorMessages.call(this),this.ErrorMessages.NotMatchingPattern=sobyValidate.ErrorMessages.Email.InvalidEmailFormat},i.prototype.Validate=function(e){return t.prototype.Validate.call(this,e)},i.prototype.Clone=function(){var e=new i;return e.Name=this.Name,e.Required=this.Required,e.Type=this.Type,e.ErrorMessage=this.ErrorMessage,e.Pattern=this.Pattern,e.MinLength=this.MinLength,e.MaxLength=this.MaxLength,e},i}(soby_PatternValidator),soby_UrlValidator=function(t){function i(){var e=t.call(this)||this;return e.ErrorMessage="",e.ErrorMessages={Required:"",InvalidURL:""},e.Name="UrlValidator ",e.Type=soby_ValidatorTypes.URL,e}return __extends(i,t),i.prototype.SetDefaultErrorMessages=function(){t.prototype.SetDefaultErrorMessages.call(this),this.ErrorMessages.Required=sobyValidate.ErrorMessages.Presence.Required,this.ErrorMessages.InvalidURL=sobyValidate.ErrorMessages.Url.InvalidUrlFormat},i.prototype.Validate=function(e){return!1!==t.prototype.Validate.call(this,e)&&(null===e.match(/(http(s)?:\/\/.)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/g)&&(this.ErrorMessage=this.ErrorMessages.InvalidURL),""===this.ErrorMessage)},i.prototype.Clone=function(){var e=new i;return e.Name=this.Name,e.Required=this.Required,e.Type=this.Type,e.ErrorMessage=this.ErrorMessage,e},i}(soby_PresenceValidator),soby_ValidatorTypes;!function(e){e[e.Date=1]="Date",e[e.DateTime=2]="DateTime",e[e.Email=3]="Email",e[e.Exclusion=4]="Exclusion",e[e.Presence=5]="Presence",e[e.Inclusion=6]="Inclusion",e[e.Length=7]="Length",e[e.Numeric=8]="Numeric",e[e.Pattern=9]="Pattern",e[e.Text=10]="Text",e[e.URL=11]="URL"}(soby_ValidatorTypes=soby_ValidatorTypes||{});var soby_FormValidator=function(){function e(e){this.ContentDivSelector="",this.ContentDivSelector=e}return e.prototype.Validate=function(){$(this.ContentDivSelector+" .sobyerrormessage").hide();var e=!0,t=!1,i=$(this.ContentDivSelector).find("textarea, input[type='text'], input[type='number'], input[type='email'], input[type='url']");i.removeClass("haserror");for(var s=0;s<i.length;s++){var a=$(i[s]),o=null;"textarea"==a.prop("tagName").toLowerCase()||"text"==a.attr("type")?o=sobyValidate.GetValidator(soby_ValidatorTypes.Text):"number"==a.attr("type")?o=sobyValidate.GetValidator(soby_ValidatorTypes.Numeric):"email"==a.attr("type")?o=sobyValidate.GetValidator(soby_ValidatorTypes.Email):"url"==a.attr("type")&&(o=sobyValidate.GetValidator(soby_ValidatorTypes.URL));var n=a.attr("id")+"_soby_errormessage";0==$("#"+n).length&&((r=$("<div class='sobyerrormessage'></div>")).attr("id",n),r.insertAfter(a));var r=a.val();1==a[0].hasAttribute("required")&&(o.Required=!0),null!=a.attr("minlength")&&null!=a.attr("minlength")&&0==isNaN(parseInt(a.attr("minlength")))&&(o.MinLength=parseInt(a.attr("minlength"))),null!=a.attr("maxlength")&&null!=a.attr("maxlength")&&0==isNaN(parseInt(a.attr("maxlength")))&&(o.MaxLength=parseInt(a.attr("maxlength"))),null!=a.attr("min")&&null!=a.attr("min")&&0==isNaN(parseInt(a.attr("min")))&&(o.MinValue=parseInt(a.attr("min"))),null!=a.attr("max")&&null!=a.attr("max")&&0==isNaN(parseInt(a.attr("max")))&&(o.MaxValue=parseInt(a.attr("max"))),0==o.Validate(r)&&(e=!1,a.addClass("haserror"),$("#"+n).text(o.ErrorMessage),$("#"+n).show(),0==t&&1==a.is(":visible")&&(a.focus(),a.select()),t=!0)}return e},e}(),sobyValidate=new soby_Validate;$(function(){$.fn.sobychart=function(){return sobyGenerateChartFromHtmlElement(this.attr("id"))},$.fn.sobymenu=function(){return sobyGenerateMenuFromHtmlElement(this.attr("id"))}});